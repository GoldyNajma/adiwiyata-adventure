function OS(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function LS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Z_={exports:{}},bf={},ex={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lu=Symbol.for("react.element"),MS=Symbol.for("react.portal"),bS=Symbol.for("react.fragment"),VS=Symbol.for("react.strict_mode"),BS=Symbol.for("react.profiler"),US=Symbol.for("react.provider"),jS=Symbol.for("react.context"),zS=Symbol.for("react.forward_ref"),$S=Symbol.for("react.suspense"),HS=Symbol.for("react.memo"),WS=Symbol.for("react.lazy"),Pg=Symbol.iterator;function GS(t){return t===null||typeof t!="object"?null:(t=Pg&&t[Pg]||t["@@iterator"],typeof t=="function"?t:null)}var tx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rx=Object.assign,nx={};function mo(t,e,r){this.props=t,this.context=e,this.refs=nx,this.updater=r||tx}mo.prototype.isReactComponent={};mo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};mo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ix(){}ix.prototype=mo.prototype;function tp(t,e,r){this.props=t,this.context=e,this.refs=nx,this.updater=r||tx}var rp=tp.prototype=new ix;rp.constructor=tp;rx(rp,mo.prototype);rp.isPureReactComponent=!0;var Ng=Array.isArray,sx=Object.prototype.hasOwnProperty,np={current:null},ax={key:!0,ref:!0,__self:!0,__source:!0};function ox(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)sx.call(e,n)&&!ax.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:lu,type:t,key:s,ref:a,props:i,_owner:np.current}}function KS(t,e){return{$$typeof:lu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ip(t){return typeof t=="object"&&t!==null&&t.$$typeof===lu}function qS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Fg=/\/+/g;function Bh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qS(""+t.key):e.toString(36)}function gc(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case lu:case MS:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Bh(a,0):n,Ng(i)?(r="",t!=null&&(r=t.replace(Fg,"$&/")+"/"),gc(i,e,r,"",function(u){return u})):i!=null&&(ip(i)&&(i=KS(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Fg,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Ng(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Bh(s,o);a+=gc(s,e,r,l,i)}else if(l=GS(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Bh(s,o++),a+=gc(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Uu(t,e,r){if(t==null)return t;var n=[],i=0;return gc(t,n,"","",function(s){return e.call(r,s,i++)}),n}function XS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Sr={current:null},vc={transition:null},QS={ReactCurrentDispatcher:Sr,ReactCurrentBatchConfig:vc,ReactCurrentOwner:np};function lx(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:Uu,forEach:function(t,e,r){Uu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Uu(t,function(){e++}),e},toArray:function(t){return Uu(t,function(e){return e})||[]},only:function(t){if(!ip(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=mo;Le.Fragment=bS;Le.Profiler=BS;Le.PureComponent=tp;Le.StrictMode=VS;Le.Suspense=$S;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QS;Le.act=lx;Le.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=rx({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=np.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)sx.call(e,l)&&!ax.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:lu,type:t.type,key:i,ref:s,props:n,_owner:a}};Le.createContext=function(t){return t={$$typeof:jS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:US,_context:t},t.Consumer=t};Le.createElement=ox;Le.createFactory=function(t){var e=ox.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:zS,render:t}};Le.isValidElement=ip;Le.lazy=function(t){return{$$typeof:WS,_payload:{_status:-1,_result:t},_init:XS}};Le.memo=function(t,e){return{$$typeof:HS,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=vc.transition;vc.transition={};try{t()}finally{vc.transition=e}};Le.unstable_act=lx;Le.useCallback=function(t,e){return Sr.current.useCallback(t,e)};Le.useContext=function(t){return Sr.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return Sr.current.useDeferredValue(t)};Le.useEffect=function(t,e){return Sr.current.useEffect(t,e)};Le.useId=function(){return Sr.current.useId()};Le.useImperativeHandle=function(t,e,r){return Sr.current.useImperativeHandle(t,e,r)};Le.useInsertionEffect=function(t,e){return Sr.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return Sr.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return Sr.current.useMemo(t,e)};Le.useReducer=function(t,e,r){return Sr.current.useReducer(t,e,r)};Le.useRef=function(t){return Sr.current.useRef(t)};Le.useState=function(t){return Sr.current.useState(t)};Le.useSyncExternalStore=function(t,e,r){return Sr.current.useSyncExternalStore(t,e,r)};Le.useTransition=function(){return Sr.current.useTransition()};Le.version="18.3.1";ex.exports=Le;var oe=ex.exports;const YS=LS(oe),JS=OS({__proto__:null,default:YS},[oe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZS=oe,eA=Symbol.for("react.element"),tA=Symbol.for("react.fragment"),rA=Object.prototype.hasOwnProperty,nA=ZS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iA={key:!0,ref:!0,__self:!0,__source:!0};function ux(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)rA.call(e,n)&&!iA.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:eA,type:t,key:s,ref:a,props:i,_owner:nA.current}}bf.Fragment=tA;bf.jsx=ux;bf.jsxs=ux;Z_.exports=bf;var M=Z_.exports,cx={exports:{}},Kr={},fx={exports:{}},hx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(fe,ye){var Se=fe.length;fe.push(ye);e:for(;0<Se;){var Oe=Se-1>>>1,B=fe[Oe];if(0<i(B,ye))fe[Oe]=ye,fe[Se]=B,Se=Oe;else break e}}function r(fe){return fe.length===0?null:fe[0]}function n(fe){if(fe.length===0)return null;var ye=fe[0],Se=fe.pop();if(Se!==ye){fe[0]=Se;e:for(var Oe=0,B=fe.length,Q=B>>>1;Oe<Q;){var z=2*(Oe+1)-1,j=fe[z],ee=z+1,ge=fe[ee];if(0>i(j,Se))ee<B&&0>i(ge,j)?(fe[Oe]=ge,fe[ee]=Se,Oe=ee):(fe[Oe]=j,fe[z]=Se,Oe=z);else if(ee<B&&0>i(ge,Se))fe[Oe]=ge,fe[ee]=Se,Oe=ee;else break e}}return ye}function i(fe,ye){var Se=fe.sortIndex-ye.sortIndex;return Se!==0?Se:fe.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],f=1,h=null,d=3,g=!1,_=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(fe){for(var ye=r(u);ye!==null;){if(ye.callback===null)n(u);else if(ye.startTime<=fe)n(u),ye.sortIndex=ye.expirationTime,e(l,ye);else break;ye=r(u)}}function O(fe){if(m=!1,T(fe),!_)if(r(l)!==null)_=!0,dt(U);else{var ye=r(u);ye!==null&&Ze(O,ye.startTime-fe)}}function U(fe,ye){_=!1,m&&(m=!1,w(S),S=-1),g=!0;var Se=d;try{for(T(ye),h=r(l);h!==null&&(!(h.expirationTime>ye)||fe&&!P());){var Oe=h.callback;if(typeof Oe=="function"){h.callback=null,d=h.priorityLevel;var B=Oe(h.expirationTime<=ye);ye=t.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),T(ye)}else n(l);h=r(l)}if(h!==null)var Q=!0;else{var z=r(u);z!==null&&Ze(O,z.startTime-ye),Q=!1}return Q}finally{h=null,d=Se,g=!1}}var W=!1,E=null,S=-1,A=5,I=-1;function P(){return!(t.unstable_now()-I<A)}function V(){if(E!==null){var fe=t.unstable_now();I=fe;var ye=!0;try{ye=E(!0,fe)}finally{ye?N():(W=!1,E=null)}}else W=!1}var N;if(typeof x=="function")N=function(){x(V)};else if(typeof MessageChannel<"u"){var Ce=new MessageChannel,ke=Ce.port2;Ce.port1.onmessage=V,N=function(){ke.postMessage(null)}}else N=function(){y(V,0)};function dt(fe){E=fe,W||(W=!0,N())}function Ze(fe,ye){S=y(function(){fe(t.unstable_now())},ye)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(fe){fe.callback=null},t.unstable_continueExecution=function(){_||g||(_=!0,dt(U))},t.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<fe?Math.floor(1e3/fe):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(fe){switch(d){case 1:case 2:case 3:var ye=3;break;default:ye=d}var Se=d;d=ye;try{return fe()}finally{d=Se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(fe,ye){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Se=d;d=fe;try{return ye()}finally{d=Se}},t.unstable_scheduleCallback=function(fe,ye,Se){var Oe=t.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Oe+Se:Oe):Se=Oe,fe){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Se+B,fe={id:f++,callback:ye,priorityLevel:fe,startTime:Se,expirationTime:B,sortIndex:-1},Se>Oe?(fe.sortIndex=Se,e(u,fe),r(l)===null&&fe===r(u)&&(m?(w(S),S=-1):m=!0,Ze(O,Se-Oe))):(fe.sortIndex=B,e(l,fe),_||g||(_=!0,dt(U))),fe},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(fe){var ye=d;return function(){var Se=d;d=ye;try{return fe.apply(this,arguments)}finally{d=Se}}}})(hx);fx.exports=hx;var sA=fx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aA=oe,Wr=sA;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dx=new Set,Cl={};function Ys(t,e){eo(t,e),eo(t+"Capture",e)}function eo(t,e){for(Cl[t]=e,t=0;t<e.length;t++)dx.add(e[t])}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),D0=Object.prototype.hasOwnProperty,oA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dg={},Og={};function lA(t){return D0.call(Og,t)?!0:D0.call(Dg,t)?!1:oA.test(t)?Og[t]=!0:(Dg[t]=!0,!1)}function uA(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cA(t,e,r,n){if(e===null||typeof e>"u"||uA(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ar(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sr[t]=new Ar(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sr[e]=new Ar(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sr[t]=new Ar(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sr[t]=new Ar(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sr[t]=new Ar(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sr[t]=new Ar(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sr[t]=new Ar(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sr[t]=new Ar(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sr[t]=new Ar(t,5,!1,t.toLowerCase(),null,!1,!1)});var sp=/[\-:]([a-z])/g;function ap(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sp,ap);sr[e]=new Ar(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sp,ap);sr[e]=new Ar(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sp,ap);sr[e]=new Ar(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sr[t]=new Ar(t,1,!1,t.toLowerCase(),null,!1,!1)});sr.xlinkHref=new Ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sr[t]=new Ar(t,1,!1,t.toLowerCase(),null,!0,!0)});function op(t,e,r,n){var i=sr.hasOwnProperty(e)?sr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cA(e,r,i,n)&&(r=null),n||i===null?lA(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var pi=aA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ju=Symbol.for("react.element"),Ca=Symbol.for("react.portal"),Ra=Symbol.for("react.fragment"),lp=Symbol.for("react.strict_mode"),O0=Symbol.for("react.profiler"),px=Symbol.for("react.provider"),mx=Symbol.for("react.context"),up=Symbol.for("react.forward_ref"),L0=Symbol.for("react.suspense"),M0=Symbol.for("react.suspense_list"),cp=Symbol.for("react.memo"),Ci=Symbol.for("react.lazy"),gx=Symbol.for("react.offscreen"),Lg=Symbol.iterator;function jo(t){return t===null||typeof t!="object"?null:(t=Lg&&t[Lg]||t["@@iterator"],typeof t=="function"?t:null)}var vt=Object.assign,Uh;function Jo(t){if(Uh===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Uh=e&&e[1]||""}return`
`+Uh+t}var jh=!1;function zh(t,e){if(!t||jh)return"";jh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{jh=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Jo(t):""}function fA(t){switch(t.tag){case 5:return Jo(t.type);case 16:return Jo("Lazy");case 13:return Jo("Suspense");case 19:return Jo("SuspenseList");case 0:case 2:case 15:return t=zh(t.type,!1),t;case 11:return t=zh(t.type.render,!1),t;case 1:return t=zh(t.type,!0),t;default:return""}}function b0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ra:return"Fragment";case Ca:return"Portal";case O0:return"Profiler";case lp:return"StrictMode";case L0:return"Suspense";case M0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mx:return(t.displayName||"Context")+".Consumer";case px:return(t._context.displayName||"Context")+".Provider";case up:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cp:return e=t.displayName||null,e!==null?e:b0(t.type)||"Memo";case Ci:e=t._payload,t=t._init;try{return b0(t(e))}catch{}}return null}function hA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return b0(e);case 8:return e===lp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function dA(t){var e=vx(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function zu(t){t._valueTracker||(t._valueTracker=dA(t))}function _x(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=vx(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Oc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function V0(t,e){var r=e.checked;return vt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Mg(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Yi(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xx(t,e){e=e.checked,e!=null&&op(t,"checked",e,!1)}function B0(t,e){xx(t,e);var r=Yi(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?U0(t,e.type,r):e.hasOwnProperty("defaultValue")&&U0(t,e.type,Yi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bg(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function U0(t,e,r){(e!=="number"||Oc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Zo=Array.isArray;function za(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Yi(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function j0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return vt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vg(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ae(92));if(Zo(r)){if(1<r.length)throw Error(ae(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Yi(r)}}function yx(t,e){var r=Yi(e.value),n=Yi(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Bg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ex(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function z0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ex(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var $u,wx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for($u=$u||document.createElement("div"),$u.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=$u.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Rl(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ol={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pA=["Webkit","ms","Moz","O"];Object.keys(ol).forEach(function(t){pA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ol[e]=ol[t]})});function Tx(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ol.hasOwnProperty(t)&&ol[t]?(""+e).trim():e+"px"}function Sx(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Tx(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var mA=vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $0(t,e){if(e){if(mA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function H0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var W0=null;function fp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var G0=null,$a=null,Ha=null;function Ug(t){if(t=fu(t)){if(typeof G0!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=zf(e),G0(t.stateNode,t.type,e))}}function Ax(t){$a?Ha?Ha.push(t):Ha=[t]:$a=t}function kx(){if($a){var t=$a,e=Ha;if(Ha=$a=null,Ug(t),e)for(t=0;t<e.length;t++)Ug(e[t])}}function Ix(t,e){return t(e)}function Cx(){}var $h=!1;function Rx(t,e,r){if($h)return t(e,r);$h=!0;try{return Ix(t,e,r)}finally{$h=!1,($a!==null||Ha!==null)&&(Cx(),kx())}}function Pl(t,e){var r=t.stateNode;if(r===null)return null;var n=zf(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ae(231,e,typeof r));return r}var K0=!1;if(ii)try{var zo={};Object.defineProperty(zo,"passive",{get:function(){K0=!0}}),window.addEventListener("test",zo,zo),window.removeEventListener("test",zo,zo)}catch{K0=!1}function gA(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var ll=!1,Lc=null,Mc=!1,q0=null,vA={onError:function(t){ll=!0,Lc=t}};function _A(t,e,r,n,i,s,a,o,l){ll=!1,Lc=null,gA.apply(vA,arguments)}function xA(t,e,r,n,i,s,a,o,l){if(_A.apply(this,arguments),ll){if(ll){var u=Lc;ll=!1,Lc=null}else throw Error(ae(198));Mc||(Mc=!0,q0=u)}}function Js(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Px(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function jg(t){if(Js(t)!==t)throw Error(ae(188))}function yA(t){var e=t.alternate;if(!e){if(e=Js(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return jg(i),t;if(s===n)return jg(i),e;s=s.sibling}throw Error(ae(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ae(189))}}if(r.alternate!==n)throw Error(ae(190))}if(r.tag!==3)throw Error(ae(188));return r.stateNode.current===r?t:e}function Nx(t){return t=yA(t),t!==null?Fx(t):null}function Fx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Fx(t);if(e!==null)return e;t=t.sibling}return null}var Dx=Wr.unstable_scheduleCallback,zg=Wr.unstable_cancelCallback,EA=Wr.unstable_shouldYield,wA=Wr.unstable_requestPaint,St=Wr.unstable_now,TA=Wr.unstable_getCurrentPriorityLevel,hp=Wr.unstable_ImmediatePriority,Ox=Wr.unstable_UserBlockingPriority,bc=Wr.unstable_NormalPriority,SA=Wr.unstable_LowPriority,Lx=Wr.unstable_IdlePriority,Vf=null,Ln=null;function AA(t){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(Vf,t,void 0,(t.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:CA,kA=Math.log,IA=Math.LN2;function CA(t){return t>>>=0,t===0?32:31-(kA(t)/IA|0)|0}var Hu=64,Wu=4194304;function el(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=el(o):(s&=a,s!==0&&(n=el(s)))}else a=r&~i,a!==0?n=el(a):s!==0&&(n=el(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-En(e),i=1<<r,n|=t[r],e&=~i;return n}function RA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PA(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-En(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=RA(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function X0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Mx(){var t=Hu;return Hu<<=1,!(Hu&4194240)&&(Hu=64),t}function Hh(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function uu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-En(e),t[e]=r}function NA(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-En(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function dp(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-En(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Qe=0;function bx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vx,pp,Bx,Ux,jx,Q0=!1,Gu=[],Vi=null,Bi=null,Ui=null,Nl=new Map,Fl=new Map,Pi=[],FA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $g(t,e){switch(t){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Ui=null;break;case"pointerover":case"pointerout":Nl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fl.delete(e.pointerId)}}function $o(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=fu(e),e!==null&&pp(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function DA(t,e,r,n,i){switch(e){case"focusin":return Vi=$o(Vi,t,e,r,n,i),!0;case"dragenter":return Bi=$o(Bi,t,e,r,n,i),!0;case"mouseover":return Ui=$o(Ui,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Nl.set(s,$o(Nl.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Fl.set(s,$o(Fl.get(s)||null,t,e,r,n,i)),!0}return!1}function zx(t){var e=Cs(t.target);if(e!==null){var r=Js(e);if(r!==null){if(e=r.tag,e===13){if(e=Px(r),e!==null){t.blockedOn=e,jx(t.priority,function(){Bx(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _c(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Y0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);W0=n,r.target.dispatchEvent(n),W0=null}else return e=fu(r),e!==null&&pp(e),t.blockedOn=r,!1;e.shift()}return!0}function Hg(t,e,r){_c(t)&&r.delete(e)}function OA(){Q0=!1,Vi!==null&&_c(Vi)&&(Vi=null),Bi!==null&&_c(Bi)&&(Bi=null),Ui!==null&&_c(Ui)&&(Ui=null),Nl.forEach(Hg),Fl.forEach(Hg)}function Ho(t,e){t.blockedOn===e&&(t.blockedOn=null,Q0||(Q0=!0,Wr.unstable_scheduleCallback(Wr.unstable_NormalPriority,OA)))}function Dl(t){function e(i){return Ho(i,t)}if(0<Gu.length){Ho(Gu[0],t);for(var r=1;r<Gu.length;r++){var n=Gu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Vi!==null&&Ho(Vi,t),Bi!==null&&Ho(Bi,t),Ui!==null&&Ho(Ui,t),Nl.forEach(e),Fl.forEach(e),r=0;r<Pi.length;r++)n=Pi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Pi.length&&(r=Pi[0],r.blockedOn===null);)zx(r),r.blockedOn===null&&Pi.shift()}var Wa=pi.ReactCurrentBatchConfig,Bc=!0;function LA(t,e,r,n){var i=Qe,s=Wa.transition;Wa.transition=null;try{Qe=1,mp(t,e,r,n)}finally{Qe=i,Wa.transition=s}}function MA(t,e,r,n){var i=Qe,s=Wa.transition;Wa.transition=null;try{Qe=4,mp(t,e,r,n)}finally{Qe=i,Wa.transition=s}}function mp(t,e,r,n){if(Bc){var i=Y0(t,e,r,n);if(i===null)e0(t,e,n,Uc,r),$g(t,n);else if(DA(i,t,e,r,n))n.stopPropagation();else if($g(t,n),e&4&&-1<FA.indexOf(t)){for(;i!==null;){var s=fu(i);if(s!==null&&Vx(s),s=Y0(t,e,r,n),s===null&&e0(t,e,n,Uc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else e0(t,e,n,null,r)}}var Uc=null;function Y0(t,e,r,n){if(Uc=null,t=fp(n),t=Cs(t),t!==null)if(e=Js(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Px(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Uc=t,null}function $x(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(TA()){case hp:return 1;case Ox:return 4;case bc:case SA:return 16;case Lx:return 536870912;default:return 16}default:return 16}}var Fi=null,gp=null,xc=null;function Hx(){if(xc)return xc;var t,e=gp,r=e.length,n,i="value"in Fi?Fi.value:Fi.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return xc=i.slice(t,1<n?1-n:void 0)}function yc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ku(){return!0}function Wg(){return!1}function qr(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ku:Wg,this.isPropagationStopped=Wg,this}return vt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ku)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ku)},persist:function(){},isPersistent:Ku}),e}var go={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vp=qr(go),cu=vt({},go,{view:0,detail:0}),bA=qr(cu),Wh,Gh,Wo,Bf=vt({},cu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_p,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wo&&(Wo&&t.type==="mousemove"?(Wh=t.screenX-Wo.screenX,Gh=t.screenY-Wo.screenY):Gh=Wh=0,Wo=t),Wh)},movementY:function(t){return"movementY"in t?t.movementY:Gh}}),Gg=qr(Bf),VA=vt({},Bf,{dataTransfer:0}),BA=qr(VA),UA=vt({},cu,{relatedTarget:0}),Kh=qr(UA),jA=vt({},go,{animationName:0,elapsedTime:0,pseudoElement:0}),zA=qr(jA),$A=vt({},go,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),HA=qr($A),WA=vt({},go,{data:0}),Kg=qr(WA),GA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qA[t])?!!e[t]:!1}function _p(){return XA}var QA=vt({},cu,{key:function(t){if(t.key){var e=GA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?KA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_p,charCode:function(t){return t.type==="keypress"?yc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),YA=qr(QA),JA=vt({},Bf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qg=qr(JA),ZA=vt({},cu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_p}),e4=qr(ZA),t4=vt({},go,{propertyName:0,elapsedTime:0,pseudoElement:0}),r4=qr(t4),n4=vt({},Bf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),i4=qr(n4),s4=[9,13,27,32],xp=ii&&"CompositionEvent"in window,ul=null;ii&&"documentMode"in document&&(ul=document.documentMode);var a4=ii&&"TextEvent"in window&&!ul,Wx=ii&&(!xp||ul&&8<ul&&11>=ul),Xg=" ",Qg=!1;function Gx(t,e){switch(t){case"keyup":return s4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pa=!1;function o4(t,e){switch(t){case"compositionend":return Kx(e);case"keypress":return e.which!==32?null:(Qg=!0,Xg);case"textInput":return t=e.data,t===Xg&&Qg?null:t;default:return null}}function l4(t,e){if(Pa)return t==="compositionend"||!xp&&Gx(t,e)?(t=Hx(),xc=gp=Fi=null,Pa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wx&&e.locale!=="ko"?null:e.data;default:return null}}var u4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!u4[t.type]:e==="textarea"}function qx(t,e,r,n){Ax(n),e=jc(e,"onChange"),0<e.length&&(r=new vp("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var cl=null,Ol=null;function c4(t){sy(t,0)}function Uf(t){var e=Da(t);if(_x(e))return t}function f4(t,e){if(t==="change")return e}var Xx=!1;if(ii){var qh;if(ii){var Xh="oninput"in document;if(!Xh){var Jg=document.createElement("div");Jg.setAttribute("oninput","return;"),Xh=typeof Jg.oninput=="function"}qh=Xh}else qh=!1;Xx=qh&&(!document.documentMode||9<document.documentMode)}function Zg(){cl&&(cl.detachEvent("onpropertychange",Qx),Ol=cl=null)}function Qx(t){if(t.propertyName==="value"&&Uf(Ol)){var e=[];qx(e,Ol,t,fp(t)),Rx(c4,e)}}function h4(t,e,r){t==="focusin"?(Zg(),cl=e,Ol=r,cl.attachEvent("onpropertychange",Qx)):t==="focusout"&&Zg()}function d4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uf(Ol)}function p4(t,e){if(t==="click")return Uf(e)}function m4(t,e){if(t==="input"||t==="change")return Uf(e)}function g4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Sn=typeof Object.is=="function"?Object.is:g4;function Ll(t,e){if(Sn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!D0.call(e,i)||!Sn(t[i],e[i]))return!1}return!0}function e1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function t1(t,e){var r=e1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=e1(r)}}function Yx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Yx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Jx(){for(var t=window,e=Oc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Oc(t.document)}return e}function yp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function v4(t){var e=Jx(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Yx(r.ownerDocument.documentElement,r)){if(n!==null&&yp(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=t1(r,s);var a=t1(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var _4=ii&&"documentMode"in document&&11>=document.documentMode,Na=null,J0=null,fl=null,Z0=!1;function r1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Z0||Na==null||Na!==Oc(n)||(n=Na,"selectionStart"in n&&yp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),fl&&Ll(fl,n)||(fl=n,n=jc(J0,"onSelect"),0<n.length&&(e=new vp("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Na)))}function qu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Fa={animationend:qu("Animation","AnimationEnd"),animationiteration:qu("Animation","AnimationIteration"),animationstart:qu("Animation","AnimationStart"),transitionend:qu("Transition","TransitionEnd")},Qh={},Zx={};ii&&(Zx=document.createElement("div").style,"AnimationEvent"in window||(delete Fa.animationend.animation,delete Fa.animationiteration.animation,delete Fa.animationstart.animation),"TransitionEvent"in window||delete Fa.transitionend.transition);function jf(t){if(Qh[t])return Qh[t];if(!Fa[t])return t;var e=Fa[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Zx)return Qh[t]=e[r];return t}var ey=jf("animationend"),ty=jf("animationiteration"),ry=jf("animationstart"),ny=jf("transitionend"),iy=new Map,n1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function us(t,e){iy.set(t,e),Ys(e,[t])}for(var Yh=0;Yh<n1.length;Yh++){var Jh=n1[Yh],x4=Jh.toLowerCase(),y4=Jh[0].toUpperCase()+Jh.slice(1);us(x4,"on"+y4)}us(ey,"onAnimationEnd");us(ty,"onAnimationIteration");us(ry,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(ny,"onTransitionEnd");eo("onMouseEnter",["mouseout","mouseover"]);eo("onMouseLeave",["mouseout","mouseover"]);eo("onPointerEnter",["pointerout","pointerover"]);eo("onPointerLeave",["pointerout","pointerover"]);Ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E4=new Set("cancel close invalid load scroll toggle".split(" ").concat(tl));function i1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,xA(n,e,void 0,t),t.currentTarget=null}function sy(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;i1(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;i1(i,o,u),s=l}}}if(Mc)throw t=q0,Mc=!1,q0=null,t}function ot(t,e){var r=e[id];r===void 0&&(r=e[id]=new Set);var n=t+"__bubble";r.has(n)||(ay(e,t,2,!1),r.add(n))}function Zh(t,e,r){var n=0;e&&(n|=4),ay(r,t,n,e)}var Xu="_reactListening"+Math.random().toString(36).slice(2);function Ml(t){if(!t[Xu]){t[Xu]=!0,dx.forEach(function(r){r!=="selectionchange"&&(E4.has(r)||Zh(r,!1,t),Zh(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xu]||(e[Xu]=!0,Zh("selectionchange",!1,e))}}function ay(t,e,r,n){switch($x(e)){case 1:var i=LA;break;case 4:i=MA;break;default:i=mp}r=i.bind(null,e,r,t),i=void 0,!K0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function e0(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Cs(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Rx(function(){var u=s,f=fp(r),h=[];e:{var d=iy.get(t);if(d!==void 0){var g=vp,_=t;switch(t){case"keypress":if(yc(r)===0)break e;case"keydown":case"keyup":g=YA;break;case"focusin":_="focus",g=Kh;break;case"focusout":_="blur",g=Kh;break;case"beforeblur":case"afterblur":g=Kh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Gg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=BA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=e4;break;case ey:case ty:case ry:g=zA;break;case ny:g=r4;break;case"scroll":g=bA;break;case"wheel":g=i4;break;case"copy":case"cut":case"paste":g=HA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=qg}var m=(e&4)!==0,y=!m&&t==="scroll",w=m?d!==null?d+"Capture":null:d;m=[];for(var x=u,T;x!==null;){T=x;var O=T.stateNode;if(T.tag===5&&O!==null&&(T=O,w!==null&&(O=Pl(x,w),O!=null&&m.push(bl(x,O,T)))),y)break;x=x.return}0<m.length&&(d=new g(d,_,null,r,f),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",d&&r!==W0&&(_=r.relatedTarget||r.fromElement)&&(Cs(_)||_[si]))break e;if((g||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,g?(_=r.relatedTarget||r.toElement,g=u,_=_?Cs(_):null,_!==null&&(y=Js(_),_!==y||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=u),g!==_)){if(m=Gg,O="onMouseLeave",w="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(m=qg,O="onPointerLeave",w="onPointerEnter",x="pointer"),y=g==null?d:Da(g),T=_==null?d:Da(_),d=new m(O,x+"leave",g,r,f),d.target=y,d.relatedTarget=T,O=null,Cs(f)===u&&(m=new m(w,x+"enter",_,r,f),m.target=T,m.relatedTarget=y,O=m),y=O,g&&_)t:{for(m=g,w=_,x=0,T=m;T;T=_a(T))x++;for(T=0,O=w;O;O=_a(O))T++;for(;0<x-T;)m=_a(m),x--;for(;0<T-x;)w=_a(w),T--;for(;x--;){if(m===w||w!==null&&m===w.alternate)break t;m=_a(m),w=_a(w)}m=null}else m=null;g!==null&&s1(h,d,g,m,!1),_!==null&&y!==null&&s1(h,y,_,m,!0)}}e:{if(d=u?Da(u):window,g=d.nodeName&&d.nodeName.toLowerCase(),g==="select"||g==="input"&&d.type==="file")var U=f4;else if(Yg(d))if(Xx)U=m4;else{U=d4;var W=h4}else(g=d.nodeName)&&g.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(U=p4);if(U&&(U=U(t,u))){qx(h,U,r,f);break e}W&&W(t,d,u),t==="focusout"&&(W=d._wrapperState)&&W.controlled&&d.type==="number"&&U0(d,"number",d.value)}switch(W=u?Da(u):window,t){case"focusin":(Yg(W)||W.contentEditable==="true")&&(Na=W,J0=u,fl=null);break;case"focusout":fl=J0=Na=null;break;case"mousedown":Z0=!0;break;case"contextmenu":case"mouseup":case"dragend":Z0=!1,r1(h,r,f);break;case"selectionchange":if(_4)break;case"keydown":case"keyup":r1(h,r,f)}var E;if(xp)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Pa?Gx(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(Wx&&r.locale!=="ko"&&(Pa||S!=="onCompositionStart"?S==="onCompositionEnd"&&Pa&&(E=Hx()):(Fi=f,gp="value"in Fi?Fi.value:Fi.textContent,Pa=!0)),W=jc(u,S),0<W.length&&(S=new Kg(S,t,null,r,f),h.push({event:S,listeners:W}),E?S.data=E:(E=Kx(r),E!==null&&(S.data=E)))),(E=a4?o4(t,r):l4(t,r))&&(u=jc(u,"onBeforeInput"),0<u.length&&(f=new Kg("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:u}),f.data=E))}sy(h,e)})}function bl(t,e,r){return{instance:t,listener:e,currentTarget:r}}function jc(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Pl(t,r),s!=null&&n.unshift(bl(t,s,i)),s=Pl(t,e),s!=null&&n.push(bl(t,s,i))),t=t.return}return n}function _a(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function s1(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Pl(r,s),l!=null&&a.unshift(bl(r,l,o))):i||(l=Pl(r,s),l!=null&&a.push(bl(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var w4=/\r\n?/g,T4=/\u0000|\uFFFD/g;function a1(t){return(typeof t=="string"?t:""+t).replace(w4,`
`).replace(T4,"")}function Qu(t,e,r){if(e=a1(e),a1(t)!==e&&r)throw Error(ae(425))}function zc(){}var ed=null,td=null;function rd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var nd=typeof setTimeout=="function"?setTimeout:void 0,S4=typeof clearTimeout=="function"?clearTimeout:void 0,o1=typeof Promise=="function"?Promise:void 0,A4=typeof queueMicrotask=="function"?queueMicrotask:typeof o1<"u"?function(t){return o1.resolve(null).then(t).catch(k4)}:nd;function k4(t){setTimeout(function(){throw t})}function t0(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Dl(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Dl(e)}function ji(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function l1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var vo=Math.random().toString(36).slice(2),On="__reactFiber$"+vo,Vl="__reactProps$"+vo,si="__reactContainer$"+vo,id="__reactEvents$"+vo,I4="__reactListeners$"+vo,C4="__reactHandles$"+vo;function Cs(t){var e=t[On];if(e)return e;for(var r=t.parentNode;r;){if(e=r[si]||r[On]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=l1(t);t!==null;){if(r=t[On])return r;t=l1(t)}return e}t=r,r=t.parentNode}return null}function fu(t){return t=t[On]||t[si],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Da(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function zf(t){return t[Vl]||null}var sd=[],Oa=-1;function cs(t){return{current:t}}function ct(t){0>Oa||(t.current=sd[Oa],sd[Oa]=null,Oa--)}function st(t,e){Oa++,sd[Oa]=t.current,t.current=e}var Ji={},vr=cs(Ji),Rr=cs(!1),bs=Ji;function to(t,e){var r=t.type.contextTypes;if(!r)return Ji;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Pr(t){return t=t.childContextTypes,t!=null}function $c(){ct(Rr),ct(vr)}function u1(t,e,r){if(vr.current!==Ji)throw Error(ae(168));st(vr,e),st(Rr,r)}function oy(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ae(108,hA(t)||"Unknown",i));return vt({},r,n)}function Hc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ji,bs=vr.current,st(vr,t),st(Rr,Rr.current),!0}function c1(t,e,r){var n=t.stateNode;if(!n)throw Error(ae(169));r?(t=oy(t,e,bs),n.__reactInternalMemoizedMergedChildContext=t,ct(Rr),ct(vr),st(vr,t)):ct(Rr),st(Rr,r)}var Xn=null,$f=!1,r0=!1;function ly(t){Xn===null?Xn=[t]:Xn.push(t)}function R4(t){$f=!0,ly(t)}function fs(){if(!r0&&Xn!==null){r0=!0;var t=0,e=Qe;try{var r=Xn;for(Qe=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Xn=null,$f=!1}catch(i){throw Xn!==null&&(Xn=Xn.slice(t+1)),Dx(hp,fs),i}finally{Qe=e,r0=!1}}return null}var La=[],Ma=0,Wc=null,Gc=0,Jr=[],Zr=0,Vs=null,Qn=1,Yn="";function Ss(t,e){La[Ma++]=Gc,La[Ma++]=Wc,Wc=t,Gc=e}function uy(t,e,r){Jr[Zr++]=Qn,Jr[Zr++]=Yn,Jr[Zr++]=Vs,Vs=t;var n=Qn;t=Yn;var i=32-En(n)-1;n&=~(1<<i),r+=1;var s=32-En(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Qn=1<<32-En(e)+i|r<<i|n,Yn=s+t}else Qn=1<<s|r<<i|n,Yn=t}function Ep(t){t.return!==null&&(Ss(t,1),uy(t,1,0))}function wp(t){for(;t===Wc;)Wc=La[--Ma],La[Ma]=null,Gc=La[--Ma],La[Ma]=null;for(;t===Vs;)Vs=Jr[--Zr],Jr[Zr]=null,Yn=Jr[--Zr],Jr[Zr]=null,Qn=Jr[--Zr],Jr[Zr]=null}var $r=null,zr=null,ht=!1,vn=null;function cy(t,e){var r=rn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function f1(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,$r=t,zr=ji(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,$r=t,zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Vs!==null?{id:Qn,overflow:Yn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=rn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,$r=t,zr=null,!0):!1;default:return!1}}function ad(t){return(t.mode&1)!==0&&(t.flags&128)===0}function od(t){if(ht){var e=zr;if(e){var r=e;if(!f1(t,e)){if(ad(t))throw Error(ae(418));e=ji(r.nextSibling);var n=$r;e&&f1(t,e)?cy(n,r):(t.flags=t.flags&-4097|2,ht=!1,$r=t)}}else{if(ad(t))throw Error(ae(418));t.flags=t.flags&-4097|2,ht=!1,$r=t}}}function h1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$r=t}function Yu(t){if(t!==$r)return!1;if(!ht)return h1(t),ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rd(t.type,t.memoizedProps)),e&&(e=zr)){if(ad(t))throw fy(),Error(ae(418));for(;e;)cy(t,e),e=ji(e.nextSibling)}if(h1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){zr=ji(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}zr=null}}else zr=$r?ji(t.stateNode.nextSibling):null;return!0}function fy(){for(var t=zr;t;)t=ji(t.nextSibling)}function ro(){zr=$r=null,ht=!1}function Tp(t){vn===null?vn=[t]:vn.push(t)}var P4=pi.ReactCurrentBatchConfig;function Go(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ae(309));var n=r.stateNode}if(!n)throw Error(ae(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ae(284));if(!r._owner)throw Error(ae(290,t))}return t}function Ju(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function d1(t){var e=t._init;return e(t._payload)}function hy(t){function e(w,x){if(t){var T=w.deletions;T===null?(w.deletions=[x],w.flags|=16):T.push(x)}}function r(w,x){if(!t)return null;for(;x!==null;)e(w,x),x=x.sibling;return null}function n(w,x){for(w=new Map;x!==null;)x.key!==null?w.set(x.key,x):w.set(x.index,x),x=x.sibling;return w}function i(w,x){return w=Wi(w,x),w.index=0,w.sibling=null,w}function s(w,x,T){return w.index=T,t?(T=w.alternate,T!==null?(T=T.index,T<x?(w.flags|=2,x):T):(w.flags|=2,x)):(w.flags|=1048576,x)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function o(w,x,T,O){return x===null||x.tag!==6?(x=u0(T,w.mode,O),x.return=w,x):(x=i(x,T),x.return=w,x)}function l(w,x,T,O){var U=T.type;return U===Ra?f(w,x,T.props.children,O,T.key):x!==null&&(x.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ci&&d1(U)===x.type)?(O=i(x,T.props),O.ref=Go(w,x,T),O.return=w,O):(O=Ic(T.type,T.key,T.props,null,w.mode,O),O.ref=Go(w,x,T),O.return=w,O)}function u(w,x,T,O){return x===null||x.tag!==4||x.stateNode.containerInfo!==T.containerInfo||x.stateNode.implementation!==T.implementation?(x=c0(T,w.mode,O),x.return=w,x):(x=i(x,T.children||[]),x.return=w,x)}function f(w,x,T,O,U){return x===null||x.tag!==7?(x=Os(T,w.mode,O,U),x.return=w,x):(x=i(x,T),x.return=w,x)}function h(w,x,T){if(typeof x=="string"&&x!==""||typeof x=="number")return x=u0(""+x,w.mode,T),x.return=w,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ju:return T=Ic(x.type,x.key,x.props,null,w.mode,T),T.ref=Go(w,null,x),T.return=w,T;case Ca:return x=c0(x,w.mode,T),x.return=w,x;case Ci:var O=x._init;return h(w,O(x._payload),T)}if(Zo(x)||jo(x))return x=Os(x,w.mode,T,null),x.return=w,x;Ju(w,x)}return null}function d(w,x,T,O){var U=x!==null?x.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return U!==null?null:o(w,x,""+T,O);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ju:return T.key===U?l(w,x,T,O):null;case Ca:return T.key===U?u(w,x,T,O):null;case Ci:return U=T._init,d(w,x,U(T._payload),O)}if(Zo(T)||jo(T))return U!==null?null:f(w,x,T,O,null);Ju(w,T)}return null}function g(w,x,T,O,U){if(typeof O=="string"&&O!==""||typeof O=="number")return w=w.get(T)||null,o(x,w,""+O,U);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case ju:return w=w.get(O.key===null?T:O.key)||null,l(x,w,O,U);case Ca:return w=w.get(O.key===null?T:O.key)||null,u(x,w,O,U);case Ci:var W=O._init;return g(w,x,T,W(O._payload),U)}if(Zo(O)||jo(O))return w=w.get(T)||null,f(x,w,O,U,null);Ju(x,O)}return null}function _(w,x,T,O){for(var U=null,W=null,E=x,S=x=0,A=null;E!==null&&S<T.length;S++){E.index>S?(A=E,E=null):A=E.sibling;var I=d(w,E,T[S],O);if(I===null){E===null&&(E=A);break}t&&E&&I.alternate===null&&e(w,E),x=s(I,x,S),W===null?U=I:W.sibling=I,W=I,E=A}if(S===T.length)return r(w,E),ht&&Ss(w,S),U;if(E===null){for(;S<T.length;S++)E=h(w,T[S],O),E!==null&&(x=s(E,x,S),W===null?U=E:W.sibling=E,W=E);return ht&&Ss(w,S),U}for(E=n(w,E);S<T.length;S++)A=g(E,w,S,T[S],O),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?S:A.key),x=s(A,x,S),W===null?U=A:W.sibling=A,W=A);return t&&E.forEach(function(P){return e(w,P)}),ht&&Ss(w,S),U}function m(w,x,T,O){var U=jo(T);if(typeof U!="function")throw Error(ae(150));if(T=U.call(T),T==null)throw Error(ae(151));for(var W=U=null,E=x,S=x=0,A=null,I=T.next();E!==null&&!I.done;S++,I=T.next()){E.index>S?(A=E,E=null):A=E.sibling;var P=d(w,E,I.value,O);if(P===null){E===null&&(E=A);break}t&&E&&P.alternate===null&&e(w,E),x=s(P,x,S),W===null?U=P:W.sibling=P,W=P,E=A}if(I.done)return r(w,E),ht&&Ss(w,S),U;if(E===null){for(;!I.done;S++,I=T.next())I=h(w,I.value,O),I!==null&&(x=s(I,x,S),W===null?U=I:W.sibling=I,W=I);return ht&&Ss(w,S),U}for(E=n(w,E);!I.done;S++,I=T.next())I=g(E,w,S,I.value,O),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?S:I.key),x=s(I,x,S),W===null?U=I:W.sibling=I,W=I);return t&&E.forEach(function(V){return e(w,V)}),ht&&Ss(w,S),U}function y(w,x,T,O){if(typeof T=="object"&&T!==null&&T.type===Ra&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case ju:e:{for(var U=T.key,W=x;W!==null;){if(W.key===U){if(U=T.type,U===Ra){if(W.tag===7){r(w,W.sibling),x=i(W,T.props.children),x.return=w,w=x;break e}}else if(W.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ci&&d1(U)===W.type){r(w,W.sibling),x=i(W,T.props),x.ref=Go(w,W,T),x.return=w,w=x;break e}r(w,W);break}else e(w,W);W=W.sibling}T.type===Ra?(x=Os(T.props.children,w.mode,O,T.key),x.return=w,w=x):(O=Ic(T.type,T.key,T.props,null,w.mode,O),O.ref=Go(w,x,T),O.return=w,w=O)}return a(w);case Ca:e:{for(W=T.key;x!==null;){if(x.key===W)if(x.tag===4&&x.stateNode.containerInfo===T.containerInfo&&x.stateNode.implementation===T.implementation){r(w,x.sibling),x=i(x,T.children||[]),x.return=w,w=x;break e}else{r(w,x);break}else e(w,x);x=x.sibling}x=c0(T,w.mode,O),x.return=w,w=x}return a(w);case Ci:return W=T._init,y(w,x,W(T._payload),O)}if(Zo(T))return _(w,x,T,O);if(jo(T))return m(w,x,T,O);Ju(w,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,x!==null&&x.tag===6?(r(w,x.sibling),x=i(x,T),x.return=w,w=x):(r(w,x),x=u0(T,w.mode,O),x.return=w,w=x),a(w)):r(w,x)}return y}var no=hy(!0),dy=hy(!1),Kc=cs(null),qc=null,ba=null,Sp=null;function Ap(){Sp=ba=qc=null}function kp(t){var e=Kc.current;ct(Kc),t._currentValue=e}function ld(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ga(t,e){qc=t,Sp=ba=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cr=!0),t.firstContext=null)}function sn(t){var e=t._currentValue;if(Sp!==t)if(t={context:t,memoizedValue:e,next:null},ba===null){if(qc===null)throw Error(ae(308));ba=t,qc.dependencies={lanes:0,firstContext:t}}else ba=ba.next=t;return e}var Rs=null;function Ip(t){Rs===null?Rs=[t]:Rs.push(t)}function py(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Ip(e)):(r.next=i.next,i.next=r),e.interleaved=r,ai(t,n)}function ai(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ri=!1;function Cp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function my(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,ze&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ai(t,r)}return i=n.interleaved,i===null?(e.next=e,Ip(n)):(e.next=i.next,i.next=e),n.interleaved=e,ai(t,r)}function Ec(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,dp(t,r)}}function p1(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Xc(t,e,r,n){var i=t.updateQueue;Ri=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,f=u=l=null,o=s;do{var d=o.lane,g=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var _=t,m=o;switch(d=e,g=r,m.tag){case 1:if(_=m.payload,typeof _=="function"){h=_.call(g,h,d);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=m.payload,d=typeof _=="function"?_.call(g,h,d):_,d==null)break e;h=vt({},h,d);break e;case 2:Ri=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else g={eventTime:g,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=g,l=h):f=f.next=g,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Us|=a,t.lanes=a,t.memoizedState=h}}function m1(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ae(191,i));i.call(n)}}}var hu={},Mn=cs(hu),Bl=cs(hu),Ul=cs(hu);function Ps(t){if(t===hu)throw Error(ae(174));return t}function Rp(t,e){switch(st(Ul,e),st(Bl,t),st(Mn,hu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:z0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=z0(e,t)}ct(Mn),st(Mn,e)}function io(){ct(Mn),ct(Bl),ct(Ul)}function gy(t){Ps(Ul.current);var e=Ps(Mn.current),r=z0(e,t.type);e!==r&&(st(Bl,t),st(Mn,r))}function Pp(t){Bl.current===t&&(ct(Mn),ct(Bl))}var mt=cs(0);function Qc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var n0=[];function Np(){for(var t=0;t<n0.length;t++)n0[t]._workInProgressVersionPrimary=null;n0.length=0}var wc=pi.ReactCurrentDispatcher,i0=pi.ReactCurrentBatchConfig,Bs=0,gt=null,Mt=null,$t=null,Yc=!1,hl=!1,jl=0,N4=0;function ur(){throw Error(ae(321))}function Fp(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Sn(t[r],e[r]))return!1;return!0}function Dp(t,e,r,n,i,s){if(Bs=s,gt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wc.current=t===null||t.memoizedState===null?L4:M4,t=r(n,i),hl){s=0;do{if(hl=!1,jl=0,25<=s)throw Error(ae(301));s+=1,$t=Mt=null,e.updateQueue=null,wc.current=b4,t=r(n,i)}while(hl)}if(wc.current=Jc,e=Mt!==null&&Mt.next!==null,Bs=0,$t=Mt=gt=null,Yc=!1,e)throw Error(ae(300));return t}function Op(){var t=jl!==0;return jl=0,t}function Fn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?gt.memoizedState=$t=t:$t=$t.next=t,$t}function an(){if(Mt===null){var t=gt.alternate;t=t!==null?t.memoizedState:null}else t=Mt.next;var e=$t===null?gt.memoizedState:$t.next;if(e!==null)$t=e,Mt=t;else{if(t===null)throw Error(ae(310));Mt=t,t={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},$t===null?gt.memoizedState=$t=t:$t=$t.next=t}return $t}function zl(t,e){return typeof e=="function"?e(t):e}function s0(t){var e=an(),r=e.queue;if(r===null)throw Error(ae(311));r.lastRenderedReducer=t;var n=Mt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var f=u.lane;if((Bs&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,gt.lanes|=f,Us|=f}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,Sn(n,e.memoizedState)||(Cr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,gt.lanes|=s,Us|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function a0(t){var e=an(),r=e.queue;if(r===null)throw Error(ae(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Sn(s,e.memoizedState)||(Cr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function vy(){}function _y(t,e){var r=gt,n=an(),i=e(),s=!Sn(n.memoizedState,i);if(s&&(n.memoizedState=i,Cr=!0),n=n.queue,Lp(Ey.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||$t!==null&&$t.memoizedState.tag&1){if(r.flags|=2048,$l(9,yy.bind(null,r,n,i,e),void 0,null),Kt===null)throw Error(ae(349));Bs&30||xy(r,e,i)}return i}function xy(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function yy(t,e,r,n){e.value=r,e.getSnapshot=n,wy(e)&&Ty(t)}function Ey(t,e,r){return r(function(){wy(e)&&Ty(t)})}function wy(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Sn(t,r)}catch{return!0}}function Ty(t){var e=ai(t,1);e!==null&&wn(e,t,1,-1)}function g1(t){var e=Fn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zl,lastRenderedState:t},e.queue=t,t=t.dispatch=O4.bind(null,gt,t),[e.memoizedState,t]}function $l(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=gt.updateQueue,e===null?(e={lastEffect:null,stores:null},gt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Sy(){return an().memoizedState}function Tc(t,e,r,n){var i=Fn();gt.flags|=t,i.memoizedState=$l(1|e,r,void 0,n===void 0?null:n)}function Hf(t,e,r,n){var i=an();n=n===void 0?null:n;var s=void 0;if(Mt!==null){var a=Mt.memoizedState;if(s=a.destroy,n!==null&&Fp(n,a.deps)){i.memoizedState=$l(e,r,s,n);return}}gt.flags|=t,i.memoizedState=$l(1|e,r,s,n)}function v1(t,e){return Tc(8390656,8,t,e)}function Lp(t,e){return Hf(2048,8,t,e)}function Ay(t,e){return Hf(4,2,t,e)}function ky(t,e){return Hf(4,4,t,e)}function Iy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Cy(t,e,r){return r=r!=null?r.concat([t]):null,Hf(4,4,Iy.bind(null,e,t),r)}function Mp(){}function Ry(t,e){var r=an();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Fp(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Py(t,e){var r=an();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Fp(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Ny(t,e,r){return Bs&21?(Sn(r,e)||(r=Mx(),gt.lanes|=r,Us|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cr=!0),t.memoizedState=r)}function F4(t,e){var r=Qe;Qe=r!==0&&4>r?r:4,t(!0);var n=i0.transition;i0.transition={};try{t(!1),e()}finally{Qe=r,i0.transition=n}}function Fy(){return an().memoizedState}function D4(t,e,r){var n=Hi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Dy(t))Oy(e,r);else if(r=py(t,e,r,n),r!==null){var i=wr();wn(r,t,n,i),Ly(r,e,n)}}function O4(t,e,r){var n=Hi(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Dy(t))Oy(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Sn(o,a)){var l=e.interleaved;l===null?(i.next=i,Ip(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=py(t,e,i,n),r!==null&&(i=wr(),wn(r,t,n,i),Ly(r,e,n))}}function Dy(t){var e=t.alternate;return t===gt||e!==null&&e===gt}function Oy(t,e){hl=Yc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Ly(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,dp(t,r)}}var Jc={readContext:sn,useCallback:ur,useContext:ur,useEffect:ur,useImperativeHandle:ur,useInsertionEffect:ur,useLayoutEffect:ur,useMemo:ur,useReducer:ur,useRef:ur,useState:ur,useDebugValue:ur,useDeferredValue:ur,useTransition:ur,useMutableSource:ur,useSyncExternalStore:ur,useId:ur,unstable_isNewReconciler:!1},L4={readContext:sn,useCallback:function(t,e){return Fn().memoizedState=[t,e===void 0?null:e],t},useContext:sn,useEffect:v1,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Tc(4194308,4,Iy.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Tc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tc(4,2,t,e)},useMemo:function(t,e){var r=Fn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Fn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=D4.bind(null,gt,t),[n.memoizedState,t]},useRef:function(t){var e=Fn();return t={current:t},e.memoizedState=t},useState:g1,useDebugValue:Mp,useDeferredValue:function(t){return Fn().memoizedState=t},useTransition:function(){var t=g1(!1),e=t[0];return t=F4.bind(null,t[1]),Fn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=gt,i=Fn();if(ht){if(r===void 0)throw Error(ae(407));r=r()}else{if(r=e(),Kt===null)throw Error(ae(349));Bs&30||xy(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,v1(Ey.bind(null,n,s,t),[t]),n.flags|=2048,$l(9,yy.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Fn(),e=Kt.identifierPrefix;if(ht){var r=Yn,n=Qn;r=(n&~(1<<32-En(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=jl++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=N4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},M4={readContext:sn,useCallback:Ry,useContext:sn,useEffect:Lp,useImperativeHandle:Cy,useInsertionEffect:Ay,useLayoutEffect:ky,useMemo:Py,useReducer:s0,useRef:Sy,useState:function(){return s0(zl)},useDebugValue:Mp,useDeferredValue:function(t){var e=an();return Ny(e,Mt.memoizedState,t)},useTransition:function(){var t=s0(zl)[0],e=an().memoizedState;return[t,e]},useMutableSource:vy,useSyncExternalStore:_y,useId:Fy,unstable_isNewReconciler:!1},b4={readContext:sn,useCallback:Ry,useContext:sn,useEffect:Lp,useImperativeHandle:Cy,useInsertionEffect:Ay,useLayoutEffect:ky,useMemo:Py,useReducer:a0,useRef:Sy,useState:function(){return a0(zl)},useDebugValue:Mp,useDeferredValue:function(t){var e=an();return Mt===null?e.memoizedState=t:Ny(e,Mt.memoizedState,t)},useTransition:function(){var t=a0(zl)[0],e=an().memoizedState;return[t,e]},useMutableSource:vy,useSyncExternalStore:_y,useId:Fy,unstable_isNewReconciler:!1};function mn(t,e){if(t&&t.defaultProps){e=vt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ud(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:vt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Wf={isMounted:function(t){return(t=t._reactInternals)?Js(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=wr(),i=Hi(t),s=Jn(n,i);s.payload=e,r!=null&&(s.callback=r),e=zi(t,s,i),e!==null&&(wn(e,t,i,n),Ec(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=wr(),i=Hi(t),s=Jn(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=zi(t,s,i),e!==null&&(wn(e,t,i,n),Ec(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=wr(),n=Hi(t),i=Jn(r,n);i.tag=2,e!=null&&(i.callback=e),e=zi(t,i,n),e!==null&&(wn(e,t,n,r),Ec(e,t,n))}};function _1(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Ll(r,n)||!Ll(i,s):!0}function My(t,e,r){var n=!1,i=Ji,s=e.contextType;return typeof s=="object"&&s!==null?s=sn(s):(i=Pr(e)?bs:vr.current,n=e.contextTypes,s=(n=n!=null)?to(t,i):Ji),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Wf,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function x1(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Wf.enqueueReplaceState(e,e.state,null)}function cd(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Cp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=sn(s):(s=Pr(e)?bs:vr.current,i.context=to(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ud(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Wf.enqueueReplaceState(i,i.state,null),Xc(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function so(t,e){try{var r="",n=e;do r+=fA(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function o0(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function fd(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var V4=typeof WeakMap=="function"?WeakMap:Map;function by(t,e,r){r=Jn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ef||(ef=!0,Ed=n),fd(t,e)},r}function Vy(t,e,r){r=Jn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){fd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){fd(t,e),typeof n!="function"&&($i===null?$i=new Set([this]):$i.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function y1(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new V4;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=J4.bind(null,t,e,r),e.then(t,t))}function E1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function w1(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Jn(-1,1),e.tag=2,zi(r,e,1))),r.lanes|=1),t)}var B4=pi.ReactCurrentOwner,Cr=!1;function xr(t,e,r,n){e.child=t===null?dy(e,null,r,n):no(e,t.child,r,n)}function T1(t,e,r,n,i){r=r.render;var s=e.ref;return Ga(e,i),n=Dp(t,e,r,n,s,i),r=Op(),t!==null&&!Cr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oi(t,e,i)):(ht&&r&&Ep(e),e.flags|=1,xr(t,e,n,i),e.child)}function S1(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!Hp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,By(t,e,s,n,i)):(t=Ic(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ll,r(a,n)&&t.ref===e.ref)return oi(t,e,i)}return e.flags|=1,t=Wi(s,n),t.ref=e.ref,t.return=e,e.child=t}function By(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Ll(s,n)&&t.ref===e.ref)if(Cr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Cr=!0);else return e.lanes=t.lanes,oi(t,e,i)}return hd(t,e,r,n,i)}function Uy(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Ba,Vr),Vr|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Ba,Vr),Vr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,st(Ba,Vr),Vr|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,st(Ba,Vr),Vr|=n;return xr(t,e,i,r),e.child}function jy(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function hd(t,e,r,n,i){var s=Pr(r)?bs:vr.current;return s=to(e,s),Ga(e,i),r=Dp(t,e,r,n,s,i),n=Op(),t!==null&&!Cr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oi(t,e,i)):(ht&&n&&Ep(e),e.flags|=1,xr(t,e,r,i),e.child)}function A1(t,e,r,n,i){if(Pr(r)){var s=!0;Hc(e)}else s=!1;if(Ga(e,i),e.stateNode===null)Sc(t,e),My(e,r,n),cd(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=sn(u):(u=Pr(r)?bs:vr.current,u=to(e,u));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&x1(e,a,n,u),Ri=!1;var d=e.memoizedState;a.state=d,Xc(e,n,a,i),l=e.memoizedState,o!==n||d!==l||Rr.current||Ri?(typeof f=="function"&&(ud(e,r,f,n),l=e.memoizedState),(o=Ri||_1(e,r,o,n,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,my(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:mn(e.type,o),a.props=u,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=sn(l):(l=Pr(r)?bs:vr.current,l=to(e,l));var g=r.getDerivedStateFromProps;(f=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&x1(e,a,n,l),Ri=!1,d=e.memoizedState,a.state=d,Xc(e,n,a,i);var _=e.memoizedState;o!==h||d!==_||Rr.current||Ri?(typeof g=="function"&&(ud(e,r,g,n),_=e.memoizedState),(u=Ri||_1(e,r,u,n,d,_,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,_,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,_,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=_),a.props=n,a.state=_,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return dd(t,e,r,n,s,i)}function dd(t,e,r,n,i,s){jy(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&c1(e,r,!1),oi(t,e,s);n=e.stateNode,B4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=no(e,t.child,null,s),e.child=no(e,null,o,s)):xr(t,e,o,s),e.memoizedState=n.state,i&&c1(e,r,!0),e.child}function zy(t){var e=t.stateNode;e.pendingContext?u1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&u1(t,e.context,!1),Rp(t,e.containerInfo)}function k1(t,e,r,n,i){return ro(),Tp(i),e.flags|=256,xr(t,e,r,n),e.child}var pd={dehydrated:null,treeContext:null,retryLane:0};function md(t){return{baseLanes:t,cachePool:null,transitions:null}}function $y(t,e,r){var n=e.pendingProps,i=mt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),st(mt,i&1),t===null)return od(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=qf(a,n,0,null),t=Os(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=md(r),e.memoizedState=pd,t):bp(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return U4(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Wi(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Wi(o,s):(s=Os(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?md(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=pd,n}return s=t.child,t=s.sibling,n=Wi(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function bp(t,e){return e=qf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Zu(t,e,r,n){return n!==null&&Tp(n),no(e,t.child,null,r),t=bp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function U4(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=o0(Error(ae(422))),Zu(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=qf({mode:"visible",children:n.children},i,0,null),s=Os(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&no(e,t.child,null,a),e.child.memoizedState=md(a),e.memoizedState=pd,s);if(!(e.mode&1))return Zu(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ae(419)),n=o0(s,n,void 0),Zu(t,e,a,n)}if(o=(a&t.childLanes)!==0,Cr||o){if(n=Kt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ai(t,i),wn(n,t,i,-1))}return $p(),n=o0(Error(ae(421))),Zu(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Z4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,zr=ji(i.nextSibling),$r=e,ht=!0,vn=null,t!==null&&(Jr[Zr++]=Qn,Jr[Zr++]=Yn,Jr[Zr++]=Vs,Qn=t.id,Yn=t.overflow,Vs=e),e=bp(e,n.children),e.flags|=4096,e)}function I1(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),ld(t.return,e,r)}function l0(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Hy(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(xr(t,e,n.children,r),n=mt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&I1(t,r,e);else if(t.tag===19)I1(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(st(mt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Qc(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),l0(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Qc(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}l0(e,!0,r,null,s);break;case"together":l0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Us|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,r=Wi(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Wi(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function j4(t,e,r){switch(e.tag){case 3:zy(e),ro();break;case 5:gy(e);break;case 1:Pr(e.type)&&Hc(e);break;case 4:Rp(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;st(Kc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(st(mt,mt.current&1),e.flags|=128,null):r&e.child.childLanes?$y(t,e,r):(st(mt,mt.current&1),t=oi(t,e,r),t!==null?t.sibling:null);st(mt,mt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Hy(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),st(mt,mt.current),n)break;return null;case 22:case 23:return e.lanes=0,Uy(t,e,r)}return oi(t,e,r)}var Wy,gd,Gy,Ky;Wy=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gd=function(){};Gy=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Ps(Mn.current);var s=null;switch(r){case"input":i=V0(t,i),n=V0(t,n),s=[];break;case"select":i=vt({},i,{value:void 0}),n=vt({},n,{value:void 0}),s=[];break;case"textarea":i=j0(t,i),n=j0(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=zc)}$0(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cl.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cl.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ot("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Ky=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ko(t,e){if(!ht)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function cr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function z4(t,e,r){var n=e.pendingProps;switch(wp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cr(e),null;case 1:return Pr(e.type)&&$c(),cr(e),null;case 3:return n=e.stateNode,io(),ct(Rr),ct(vr),Np(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Yu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vn!==null&&(Sd(vn),vn=null))),gd(t,e),cr(e),null;case 5:Pp(e);var i=Ps(Ul.current);if(r=e.type,t!==null&&e.stateNode!=null)Gy(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ae(166));return cr(e),null}if(t=Ps(Mn.current),Yu(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[On]=e,n[Vl]=s,t=(e.mode&1)!==0,r){case"dialog":ot("cancel",n),ot("close",n);break;case"iframe":case"object":case"embed":ot("load",n);break;case"video":case"audio":for(i=0;i<tl.length;i++)ot(tl[i],n);break;case"source":ot("error",n);break;case"img":case"image":case"link":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"input":Mg(n,s),ot("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ot("invalid",n);break;case"textarea":Vg(n,s),ot("invalid",n)}$0(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Qu(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Qu(n.textContent,o,t),i=["children",""+o]):Cl.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ot("scroll",n)}switch(r){case"input":zu(n),bg(n,s,!0);break;case"textarea":zu(n),Bg(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=zc)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ex(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[On]=e,t[Vl]=n,Wy(t,e,!1,!1),e.stateNode=t;e:{switch(a=H0(r,n),r){case"dialog":ot("cancel",t),ot("close",t),i=n;break;case"iframe":case"object":case"embed":ot("load",t),i=n;break;case"video":case"audio":for(i=0;i<tl.length;i++)ot(tl[i],t);i=n;break;case"source":ot("error",t),i=n;break;case"img":case"image":case"link":ot("error",t),ot("load",t),i=n;break;case"details":ot("toggle",t),i=n;break;case"input":Mg(t,n),i=V0(t,n),ot("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=vt({},n,{value:void 0}),ot("invalid",t);break;case"textarea":Vg(t,n),i=j0(t,n),ot("invalid",t);break;default:i=n}$0(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Sx(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&wx(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Rl(t,l):typeof l=="number"&&Rl(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ot("scroll",t):l!=null&&op(t,s,l,a))}switch(r){case"input":zu(t),bg(t,n,!1);break;case"textarea":zu(t),Bg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Yi(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?za(t,!!n.multiple,s,!1):n.defaultValue!=null&&za(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=zc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return cr(e),null;case 6:if(t&&e.stateNode!=null)Ky(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ae(166));if(r=Ps(Ul.current),Ps(Mn.current),Yu(e)){if(n=e.stateNode,r=e.memoizedProps,n[On]=e,(s=n.nodeValue!==r)&&(t=$r,t!==null))switch(t.tag){case 3:Qu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qu(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[On]=e,e.stateNode=n}return cr(e),null;case 13:if(ct(mt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ht&&zr!==null&&e.mode&1&&!(e.flags&128))fy(),ro(),e.flags|=98560,s=!1;else if(s=Yu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(ae(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[On]=e}else ro(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;cr(e),s=!1}else vn!==null&&(Sd(vn),vn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||mt.current&1?Vt===0&&(Vt=3):$p())),e.updateQueue!==null&&(e.flags|=4),cr(e),null);case 4:return io(),gd(t,e),t===null&&Ml(e.stateNode.containerInfo),cr(e),null;case 10:return kp(e.type._context),cr(e),null;case 17:return Pr(e.type)&&$c(),cr(e),null;case 19:if(ct(mt),s=e.memoizedState,s===null)return cr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Ko(s,!1);else{if(Vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Qc(t),a!==null){for(e.flags|=128,Ko(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return st(mt,mt.current&1|2),e.child}t=t.sibling}s.tail!==null&&St()>ao&&(e.flags|=128,n=!0,Ko(s,!1),e.lanes=4194304)}else{if(!n)if(t=Qc(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ko(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!ht)return cr(e),null}else 2*St()-s.renderingStartTime>ao&&r!==1073741824&&(e.flags|=128,n=!0,Ko(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=St(),e.sibling=null,r=mt.current,st(mt,n?r&1|2:r&1),e):(cr(e),null);case 22:case 23:return zp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Vr&1073741824&&(cr(e),e.subtreeFlags&6&&(e.flags|=8192)):cr(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function $4(t,e){switch(wp(e),e.tag){case 1:return Pr(e.type)&&$c(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return io(),ct(Rr),ct(vr),Np(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Pp(e),null;case 13:if(ct(mt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));ro()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ct(mt),null;case 4:return io(),null;case 10:return kp(e.type._context),null;case 22:case 23:return zp(),null;case 24:return null;default:return null}}var ec=!1,dr=!1,H4=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Va(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){yt(t,e,n)}else r.current=null}function vd(t,e,r){try{r()}catch(n){yt(t,e,n)}}var C1=!1;function W4(t,e){if(ed=Bc,t=Jx(),yp(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,f=0,h=t,d=null;t:for(;;){for(var g;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(g=h.firstChild)!==null;)d=h,h=g;for(;;){if(h===t)break t;if(d===r&&++u===i&&(o=a),d===s&&++f===n&&(l=a),(g=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=g}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(td={focusedElem:t,selectionRange:r},Bc=!1,xe=e;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var m=_.memoizedProps,y=_.memoizedState,w=e.stateNode,x=w.getSnapshotBeforeUpdate(e.elementType===e.type?m:mn(e.type,m),y);w.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(O){yt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return _=C1,C1=!1,_}function dl(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&vd(e,r,s)}i=i.next}while(i!==n)}}function Gf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function _d(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function qy(t){var e=t.alternate;e!==null&&(t.alternate=null,qy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[On],delete e[Vl],delete e[id],delete e[I4],delete e[C4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Xy(t){return t.tag===5||t.tag===3||t.tag===4}function R1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Xy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function xd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=zc));else if(n!==4&&(t=t.child,t!==null))for(xd(t,e,r),t=t.sibling;t!==null;)xd(t,e,r),t=t.sibling}function yd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(yd(t,e,r),t=t.sibling;t!==null;)yd(t,e,r),t=t.sibling}var Yt=null,gn=!1;function ki(t,e,r){for(r=r.child;r!==null;)Qy(t,e,r),r=r.sibling}function Qy(t,e,r){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(Vf,r)}catch{}switch(r.tag){case 5:dr||Va(r,e);case 6:var n=Yt,i=gn;Yt=null,ki(t,e,r),Yt=n,gn=i,Yt!==null&&(gn?(t=Yt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Yt.removeChild(r.stateNode));break;case 18:Yt!==null&&(gn?(t=Yt,r=r.stateNode,t.nodeType===8?t0(t.parentNode,r):t.nodeType===1&&t0(t,r),Dl(t)):t0(Yt,r.stateNode));break;case 4:n=Yt,i=gn,Yt=r.stateNode.containerInfo,gn=!0,ki(t,e,r),Yt=n,gn=i;break;case 0:case 11:case 14:case 15:if(!dr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&vd(r,e,a),i=i.next}while(i!==n)}ki(t,e,r);break;case 1:if(!dr&&(Va(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){yt(r,e,o)}ki(t,e,r);break;case 21:ki(t,e,r);break;case 22:r.mode&1?(dr=(n=dr)||r.memoizedState!==null,ki(t,e,r),dr=n):ki(t,e,r);break;default:ki(t,e,r)}}function P1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new H4),e.forEach(function(n){var i=ek.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function hn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Yt=o.stateNode,gn=!1;break e;case 3:Yt=o.stateNode.containerInfo,gn=!0;break e;case 4:Yt=o.stateNode.containerInfo,gn=!0;break e}o=o.return}if(Yt===null)throw Error(ae(160));Qy(s,a,i),Yt=null,gn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){yt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Yy(e,t),e=e.sibling}function Yy(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(hn(e,t),Rn(t),n&4){try{dl(3,t,t.return),Gf(3,t)}catch(m){yt(t,t.return,m)}try{dl(5,t,t.return)}catch(m){yt(t,t.return,m)}}break;case 1:hn(e,t),Rn(t),n&512&&r!==null&&Va(r,r.return);break;case 5:if(hn(e,t),Rn(t),n&512&&r!==null&&Va(r,r.return),t.flags&32){var i=t.stateNode;try{Rl(i,"")}catch(m){yt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&xx(i,s),H0(o,a);var u=H0(o,s);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?Sx(i,h):f==="dangerouslySetInnerHTML"?wx(i,h):f==="children"?Rl(i,h):op(i,f,h,u)}switch(o){case"input":B0(i,s);break;case"textarea":yx(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?za(i,!!s.multiple,g,!1):d!==!!s.multiple&&(s.defaultValue!=null?za(i,!!s.multiple,s.defaultValue,!0):za(i,!!s.multiple,s.multiple?[]:"",!1))}i[Vl]=s}catch(m){yt(t,t.return,m)}}break;case 6:if(hn(e,t),Rn(t),n&4){if(t.stateNode===null)throw Error(ae(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){yt(t,t.return,m)}}break;case 3:if(hn(e,t),Rn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Dl(e.containerInfo)}catch(m){yt(t,t.return,m)}break;case 4:hn(e,t),Rn(t);break;case 13:hn(e,t),Rn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Up=St())),n&4&&P1(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(dr=(u=dr)||f,hn(e,t),dr=u):hn(e,t),Rn(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(xe=t,f=t.child;f!==null;){for(h=xe=f;xe!==null;){switch(d=xe,g=d.child,d.tag){case 0:case 11:case 14:case 15:dl(4,d,d.return);break;case 1:Va(d,d.return);var _=d.stateNode;if(typeof _.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(m){yt(n,r,m)}}break;case 5:Va(d,d.return);break;case 22:if(d.memoizedState!==null){F1(h);continue}}g!==null?(g.return=d,xe=g):F1(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Tx("display",a))}catch(m){yt(t,t.return,m)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){yt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:hn(e,t),Rn(t),n&4&&P1(t);break;case 21:break;default:hn(e,t),Rn(t)}}function Rn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Xy(r)){var n=r;break e}r=r.return}throw Error(ae(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Rl(i,""),n.flags&=-33);var s=R1(t);yd(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=R1(t);xd(t,o,a);break;default:throw Error(ae(161))}}catch(l){yt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function G4(t,e,r){xe=t,Jy(t)}function Jy(t,e,r){for(var n=(t.mode&1)!==0;xe!==null;){var i=xe,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||ec;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||dr;o=ec;var u=dr;if(ec=a,(dr=l)&&!u)for(xe=i;xe!==null;)a=xe,l=a.child,a.tag===22&&a.memoizedState!==null?D1(i):l!==null?(l.return=a,xe=l):D1(i);for(;s!==null;)xe=s,Jy(s),s=s.sibling;xe=i,ec=o,dr=u}N1(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,xe=s):N1(t)}}function N1(t){for(;xe!==null;){var e=xe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:dr||Gf(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!dr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:mn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&m1(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}m1(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Dl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}dr||e.flags&512&&_d(e)}catch(d){yt(e,e.return,d)}}if(e===t){xe=null;break}if(r=e.sibling,r!==null){r.return=e.return,xe=r;break}xe=e.return}}function F1(t){for(;xe!==null;){var e=xe;if(e===t){xe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,xe=r;break}xe=e.return}}function D1(t){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Gf(4,e)}catch(l){yt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){yt(e,i,l)}}var s=e.return;try{_d(e)}catch(l){yt(e,s,l)}break;case 5:var a=e.return;try{_d(e)}catch(l){yt(e,a,l)}}}catch(l){yt(e,e.return,l)}if(e===t){xe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,xe=o;break}xe=e.return}}var K4=Math.ceil,Zc=pi.ReactCurrentDispatcher,Vp=pi.ReactCurrentOwner,nn=pi.ReactCurrentBatchConfig,ze=0,Kt=null,Ct=null,nr=0,Vr=0,Ba=cs(0),Vt=0,Hl=null,Us=0,Kf=0,Bp=0,pl=null,Ir=null,Up=0,ao=1/0,qn=null,ef=!1,Ed=null,$i=null,tc=!1,Di=null,tf=0,ml=0,wd=null,Ac=-1,kc=0;function wr(){return ze&6?St():Ac!==-1?Ac:Ac=St()}function Hi(t){return t.mode&1?ze&2&&nr!==0?nr&-nr:P4.transition!==null?(kc===0&&(kc=Mx()),kc):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:$x(t.type)),t):1}function wn(t,e,r,n){if(50<ml)throw ml=0,wd=null,Error(ae(185));uu(t,r,n),(!(ze&2)||t!==Kt)&&(t===Kt&&(!(ze&2)&&(Kf|=r),Vt===4&&Ni(t,nr)),Nr(t,n),r===1&&ze===0&&!(e.mode&1)&&(ao=St()+500,$f&&fs()))}function Nr(t,e){var r=t.callbackNode;PA(t,e);var n=Vc(t,t===Kt?nr:0);if(n===0)r!==null&&zg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&zg(r),e===1)t.tag===0?R4(O1.bind(null,t)):ly(O1.bind(null,t)),A4(function(){!(ze&6)&&fs()}),r=null;else{switch(bx(n)){case 1:r=hp;break;case 4:r=Ox;break;case 16:r=bc;break;case 536870912:r=Lx;break;default:r=bc}r=a2(r,Zy.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Zy(t,e){if(Ac=-1,kc=0,ze&6)throw Error(ae(327));var r=t.callbackNode;if(Ka()&&t.callbackNode!==r)return null;var n=Vc(t,t===Kt?nr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=rf(t,n);else{e=n;var i=ze;ze|=2;var s=t2();(Kt!==t||nr!==e)&&(qn=null,ao=St()+500,Ds(t,e));do try{Q4();break}catch(o){e2(t,o)}while(!0);Ap(),Zc.current=s,ze=i,Ct!==null?e=0:(Kt=null,nr=0,e=Vt)}if(e!==0){if(e===2&&(i=X0(t),i!==0&&(n=i,e=Td(t,i))),e===1)throw r=Hl,Ds(t,0),Ni(t,n),Nr(t,St()),r;if(e===6)Ni(t,n);else{if(i=t.current.alternate,!(n&30)&&!q4(i)&&(e=rf(t,n),e===2&&(s=X0(t),s!==0&&(n=s,e=Td(t,s))),e===1))throw r=Hl,Ds(t,0),Ni(t,n),Nr(t,St()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ae(345));case 2:As(t,Ir,qn);break;case 3:if(Ni(t,n),(n&130023424)===n&&(e=Up+500-St(),10<e)){if(Vc(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){wr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=nd(As.bind(null,t,Ir,qn),e);break}As(t,Ir,qn);break;case 4:if(Ni(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-En(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=St()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*K4(n/1960))-n,10<n){t.timeoutHandle=nd(As.bind(null,t,Ir,qn),n);break}As(t,Ir,qn);break;case 5:As(t,Ir,qn);break;default:throw Error(ae(329))}}}return Nr(t,St()),t.callbackNode===r?Zy.bind(null,t):null}function Td(t,e){var r=pl;return t.current.memoizedState.isDehydrated&&(Ds(t,e).flags|=256),t=rf(t,e),t!==2&&(e=Ir,Ir=r,e!==null&&Sd(e)),t}function Sd(t){Ir===null?Ir=t:Ir.push.apply(Ir,t)}function q4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Sn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ni(t,e){for(e&=~Bp,e&=~Kf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-En(e),n=1<<r;t[r]=-1,e&=~n}}function O1(t){if(ze&6)throw Error(ae(327));Ka();var e=Vc(t,0);if(!(e&1))return Nr(t,St()),null;var r=rf(t,e);if(t.tag!==0&&r===2){var n=X0(t);n!==0&&(e=n,r=Td(t,n))}if(r===1)throw r=Hl,Ds(t,0),Ni(t,e),Nr(t,St()),r;if(r===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,As(t,Ir,qn),Nr(t,St()),null}function jp(t,e){var r=ze;ze|=1;try{return t(e)}finally{ze=r,ze===0&&(ao=St()+500,$f&&fs())}}function js(t){Di!==null&&Di.tag===0&&!(ze&6)&&Ka();var e=ze;ze|=1;var r=nn.transition,n=Qe;try{if(nn.transition=null,Qe=1,t)return t()}finally{Qe=n,nn.transition=r,ze=e,!(ze&6)&&fs()}}function zp(){Vr=Ba.current,ct(Ba)}function Ds(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,S4(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(wp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&$c();break;case 3:io(),ct(Rr),ct(vr),Np();break;case 5:Pp(n);break;case 4:io();break;case 13:ct(mt);break;case 19:ct(mt);break;case 10:kp(n.type._context);break;case 22:case 23:zp()}r=r.return}if(Kt=t,Ct=t=Wi(t.current,null),nr=Vr=e,Vt=0,Hl=null,Bp=Kf=Us=0,Ir=pl=null,Rs!==null){for(e=0;e<Rs.length;e++)if(r=Rs[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Rs=null}return t}function e2(t,e){do{var r=Ct;try{if(Ap(),wc.current=Jc,Yc){for(var n=gt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Yc=!1}if(Bs=0,$t=Mt=gt=null,hl=!1,jl=0,Vp.current=null,r===null||r.return===null){Vt=1,Hl=e,Ct=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=nr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var g=E1(a);if(g!==null){g.flags&=-257,w1(g,a,o,s,e),g.mode&1&&y1(s,u,e),e=g,l=u;var _=e.updateQueue;if(_===null){var m=new Set;m.add(l),e.updateQueue=m}else _.add(l);break e}else{if(!(e&1)){y1(s,u,e),$p();break e}l=Error(ae(426))}}else if(ht&&o.mode&1){var y=E1(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),w1(y,a,o,s,e),Tp(so(l,o));break e}}s=l=so(l,o),Vt!==4&&(Vt=2),pl===null?pl=[s]:pl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=by(s,l,e);p1(s,w);break e;case 1:o=l;var x=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&($i===null||!$i.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=Vy(s,o,e);p1(s,O);break e}}s=s.return}while(s!==null)}n2(r)}catch(U){e=U,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function t2(){var t=Zc.current;return Zc.current=Jc,t===null?Jc:t}function $p(){(Vt===0||Vt===3||Vt===2)&&(Vt=4),Kt===null||!(Us&268435455)&&!(Kf&268435455)||Ni(Kt,nr)}function rf(t,e){var r=ze;ze|=2;var n=t2();(Kt!==t||nr!==e)&&(qn=null,Ds(t,e));do try{X4();break}catch(i){e2(t,i)}while(!0);if(Ap(),ze=r,Zc.current=n,Ct!==null)throw Error(ae(261));return Kt=null,nr=0,Vt}function X4(){for(;Ct!==null;)r2(Ct)}function Q4(){for(;Ct!==null&&!EA();)r2(Ct)}function r2(t){var e=s2(t.alternate,t,Vr);t.memoizedProps=t.pendingProps,e===null?n2(t):Ct=e,Vp.current=null}function n2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=$4(r,e),r!==null){r.flags&=32767,Ct=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Vt=6,Ct=null;return}}else if(r=z4(r,e,Vr),r!==null){Ct=r;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);Vt===0&&(Vt=5)}function As(t,e,r){var n=Qe,i=nn.transition;try{nn.transition=null,Qe=1,Y4(t,e,r,n)}finally{nn.transition=i,Qe=n}return null}function Y4(t,e,r,n){do Ka();while(Di!==null);if(ze&6)throw Error(ae(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(NA(t,s),t===Kt&&(Ct=Kt=null,nr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||tc||(tc=!0,a2(bc,function(){return Ka(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=nn.transition,nn.transition=null;var a=Qe;Qe=1;var o=ze;ze|=4,Vp.current=null,W4(t,r),Yy(r,t),v4(td),Bc=!!ed,td=ed=null,t.current=r,G4(r),wA(),ze=o,Qe=a,nn.transition=s}else t.current=r;if(tc&&(tc=!1,Di=t,tf=i),s=t.pendingLanes,s===0&&($i=null),AA(r.stateNode),Nr(t,St()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(ef)throw ef=!1,t=Ed,Ed=null,t;return tf&1&&t.tag!==0&&Ka(),s=t.pendingLanes,s&1?t===wd?ml++:(ml=0,wd=t):ml=0,fs(),null}function Ka(){if(Di!==null){var t=bx(tf),e=nn.transition,r=Qe;try{if(nn.transition=null,Qe=16>t?16:t,Di===null)var n=!1;else{if(t=Di,Di=null,tf=0,ze&6)throw Error(ae(331));var i=ze;for(ze|=4,xe=t.current;xe!==null;){var s=xe,a=s.child;if(xe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(xe=u;xe!==null;){var f=xe;switch(f.tag){case 0:case 11:case 15:dl(8,f,s)}var h=f.child;if(h!==null)h.return=f,xe=h;else for(;xe!==null;){f=xe;var d=f.sibling,g=f.return;if(qy(f),f===u){xe=null;break}if(d!==null){d.return=g,xe=d;break}xe=g}}}var _=s.alternate;if(_!==null){var m=_.child;if(m!==null){_.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}xe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,xe=a;else e:for(;xe!==null;){if(s=xe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:dl(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,xe=w;break e}xe=s.return}}var x=t.current;for(xe=x;xe!==null;){a=xe;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,xe=T;else e:for(a=x;xe!==null;){if(o=xe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Gf(9,o)}}catch(U){yt(o,o.return,U)}if(o===a){xe=null;break e}var O=o.sibling;if(O!==null){O.return=o.return,xe=O;break e}xe=o.return}}if(ze=i,fs(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(Vf,t)}catch{}n=!0}return n}finally{Qe=r,nn.transition=e}}return!1}function L1(t,e,r){e=so(r,e),e=by(t,e,1),t=zi(t,e,1),e=wr(),t!==null&&(uu(t,1,e),Nr(t,e))}function yt(t,e,r){if(t.tag===3)L1(t,t,r);else for(;e!==null;){if(e.tag===3){L1(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($i===null||!$i.has(n))){t=so(r,t),t=Vy(e,t,1),e=zi(e,t,1),t=wr(),e!==null&&(uu(e,1,t),Nr(e,t));break}}e=e.return}}function J4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=wr(),t.pingedLanes|=t.suspendedLanes&r,Kt===t&&(nr&r)===r&&(Vt===4||Vt===3&&(nr&130023424)===nr&&500>St()-Up?Ds(t,0):Bp|=r),Nr(t,e)}function i2(t,e){e===0&&(t.mode&1?(e=Wu,Wu<<=1,!(Wu&130023424)&&(Wu=4194304)):e=1);var r=wr();t=ai(t,e),t!==null&&(uu(t,e,r),Nr(t,r))}function Z4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),i2(t,r)}function ek(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ae(314))}n!==null&&n.delete(e),i2(t,r)}var s2;s2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rr.current)Cr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Cr=!1,j4(t,e,r);Cr=!!(t.flags&131072)}else Cr=!1,ht&&e.flags&1048576&&uy(e,Gc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Sc(t,e),t=e.pendingProps;var i=to(e,vr.current);Ga(e,r),i=Dp(null,e,n,t,i,r);var s=Op();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pr(n)?(s=!0,Hc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Cp(e),i.updater=Wf,e.stateNode=i,i._reactInternals=e,cd(e,n,t,r),e=dd(null,e,n,!0,s,r)):(e.tag=0,ht&&s&&Ep(e),xr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Sc(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=rk(n),t=mn(n,t),i){case 0:e=hd(null,e,n,t,r);break e;case 1:e=A1(null,e,n,t,r);break e;case 11:e=T1(null,e,n,t,r);break e;case 14:e=S1(null,e,n,mn(n.type,t),r);break e}throw Error(ae(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mn(n,i),hd(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mn(n,i),A1(t,e,n,i,r);case 3:e:{if(zy(e),t===null)throw Error(ae(387));n=e.pendingProps,s=e.memoizedState,i=s.element,my(t,e),Xc(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=so(Error(ae(423)),e),e=k1(t,e,n,r,i);break e}else if(n!==i){i=so(Error(ae(424)),e),e=k1(t,e,n,r,i);break e}else for(zr=ji(e.stateNode.containerInfo.firstChild),$r=e,ht=!0,vn=null,r=dy(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ro(),n===i){e=oi(t,e,r);break e}xr(t,e,n,r)}e=e.child}return e;case 5:return gy(e),t===null&&od(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,rd(n,i)?a=null:s!==null&&rd(n,s)&&(e.flags|=32),jy(t,e),xr(t,e,a,r),e.child;case 6:return t===null&&od(e),null;case 13:return $y(t,e,r);case 4:return Rp(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=no(e,null,n,r):xr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mn(n,i),T1(t,e,n,i,r);case 7:return xr(t,e,e.pendingProps,r),e.child;case 8:return xr(t,e,e.pendingProps.children,r),e.child;case 12:return xr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,st(Kc,n._currentValue),n._currentValue=a,s!==null)if(Sn(s.value,a)){if(s.children===i.children&&!Rr.current){e=oi(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Jn(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),ld(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ae(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),ld(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}xr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Ga(e,r),i=sn(i),n=n(i),e.flags|=1,xr(t,e,n,r),e.child;case 14:return n=e.type,i=mn(n,e.pendingProps),i=mn(n.type,i),S1(t,e,n,i,r);case 15:return By(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:mn(n,i),Sc(t,e),e.tag=1,Pr(n)?(t=!0,Hc(e)):t=!1,Ga(e,r),My(e,n,i),cd(e,n,i,r),dd(null,e,n,!0,t,r);case 19:return Hy(t,e,r);case 22:return Uy(t,e,r)}throw Error(ae(156,e.tag))};function a2(t,e){return Dx(t,e)}function tk(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(t,e,r,n){return new tk(t,e,r,n)}function Hp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rk(t){if(typeof t=="function")return Hp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===up)return 11;if(t===cp)return 14}return 2}function Wi(t,e){var r=t.alternate;return r===null?(r=rn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ic(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")Hp(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ra:return Os(r.children,i,s,e);case lp:a=8,i|=8;break;case O0:return t=rn(12,r,e,i|2),t.elementType=O0,t.lanes=s,t;case L0:return t=rn(13,r,e,i),t.elementType=L0,t.lanes=s,t;case M0:return t=rn(19,r,e,i),t.elementType=M0,t.lanes=s,t;case gx:return qf(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case px:a=10;break e;case mx:a=9;break e;case up:a=11;break e;case cp:a=14;break e;case Ci:a=16,n=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=rn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Os(t,e,r,n){return t=rn(7,t,n,e),t.lanes=r,t}function qf(t,e,r,n){return t=rn(22,t,n,e),t.elementType=gx,t.lanes=r,t.stateNode={isHidden:!1},t}function u0(t,e,r){return t=rn(6,t,null,e),t.lanes=r,t}function c0(t,e,r){return e=rn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function nk(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hh(0),this.expirationTimes=Hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hh(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wp(t,e,r,n,i,s,a,o,l){return t=new nk(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=rn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cp(s),t}function ik(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ca,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function o2(t){if(!t)return Ji;t=t._reactInternals;e:{if(Js(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var r=t.type;if(Pr(r))return oy(t,r,e)}return e}function l2(t,e,r,n,i,s,a,o,l){return t=Wp(r,n,!0,t,i,s,a,o,l),t.context=o2(null),r=t.current,n=wr(),i=Hi(r),s=Jn(n,i),s.callback=e??null,zi(r,s,i),t.current.lanes=i,uu(t,i,n),Nr(t,n),t}function Xf(t,e,r,n){var i=e.current,s=wr(),a=Hi(i);return r=o2(r),e.context===null?e.context=r:e.pendingContext=r,e=Jn(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=zi(i,e,a),t!==null&&(wn(t,i,a,s),Ec(t,i,a)),a}function nf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function M1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Gp(t,e){M1(t,e),(t=t.alternate)&&M1(t,e)}function sk(){return null}var u2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Kp(t){this._internalRoot=t}Qf.prototype.render=Kp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));Xf(t,e,null,null)};Qf.prototype.unmount=Kp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;js(function(){Xf(null,t,null,null)}),e[si]=null}};function Qf(t){this._internalRoot=t}Qf.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ux();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Pi.length&&e!==0&&e<Pi[r].priority;r++);Pi.splice(r,0,t),r===0&&zx(t)}};function qp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function b1(){}function ak(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=nf(a);s.call(u)}}var a=l2(e,n,t,0,null,!1,!1,"",b1);return t._reactRootContainer=a,t[si]=a.current,Ml(t.nodeType===8?t.parentNode:t),js(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=nf(l);o.call(u)}}var l=Wp(t,0,!1,null,null,!1,!1,"",b1);return t._reactRootContainer=l,t[si]=l.current,Ml(t.nodeType===8?t.parentNode:t),js(function(){Xf(e,l,r,n)}),l}function Jf(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=nf(a);o.call(l)}}Xf(e,a,t,i)}else a=ak(r,e,t,i,n);return nf(a)}Vx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=el(e.pendingLanes);r!==0&&(dp(e,r|1),Nr(e,St()),!(ze&6)&&(ao=St()+500,fs()))}break;case 13:js(function(){var n=ai(t,1);if(n!==null){var i=wr();wn(n,t,1,i)}}),Gp(t,1)}};pp=function(t){if(t.tag===13){var e=ai(t,134217728);if(e!==null){var r=wr();wn(e,t,134217728,r)}Gp(t,134217728)}};Bx=function(t){if(t.tag===13){var e=Hi(t),r=ai(t,e);if(r!==null){var n=wr();wn(r,t,e,n)}Gp(t,e)}};Ux=function(){return Qe};jx=function(t,e){var r=Qe;try{return Qe=t,e()}finally{Qe=r}};G0=function(t,e,r){switch(e){case"input":if(B0(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=zf(n);if(!i)throw Error(ae(90));_x(n),B0(n,i)}}}break;case"textarea":yx(t,r);break;case"select":e=r.value,e!=null&&za(t,!!r.multiple,e,!1)}};Ix=jp;Cx=js;var ok={usingClientEntryPoint:!1,Events:[fu,Da,zf,Ax,kx,jp]},qo={findFiberByHostInstance:Cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lk={bundleType:qo.bundleType,version:qo.version,rendererPackageName:qo.rendererPackageName,rendererConfig:qo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nx(t),t===null?null:t.stateNode},findFiberByHostInstance:qo.findFiberByHostInstance||sk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{Vf=rc.inject(lk),Ln=rc}catch{}}Kr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ok;Kr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qp(e))throw Error(ae(200));return ik(t,e,null,r)};Kr.createRoot=function(t,e){if(!qp(t))throw Error(ae(299));var r=!1,n="",i=u2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Wp(t,1,!1,null,null,r,!1,n,i),t[si]=e.current,Ml(t.nodeType===8?t.parentNode:t),new Kp(e)};Kr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=Nx(e),t=t===null?null:t.stateNode,t};Kr.flushSync=function(t){return js(t)};Kr.hydrate=function(t,e,r){if(!Yf(e))throw Error(ae(200));return Jf(null,t,e,!0,r)};Kr.hydrateRoot=function(t,e,r){if(!qp(t))throw Error(ae(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=u2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=l2(e,null,t,1,r??null,i,!1,s,a),t[si]=e.current,Ml(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Qf(e)};Kr.render=function(t,e,r){if(!Yf(e))throw Error(ae(200));return Jf(null,t,e,!1,r)};Kr.unmountComponentAtNode=function(t){if(!Yf(t))throw Error(ae(40));return t._reactRootContainer?(js(function(){Jf(null,null,t,!1,function(){t._reactRootContainer=null,t[si]=null})}),!0):!1};Kr.unstable_batchedUpdates=jp;Kr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Yf(r))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return Jf(t,e,r,!1,n)};Kr.version="18.3.1-next-f1338f8080-20240426";function c2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c2)}catch(t){console.error(t)}}c2(),cx.exports=Kr;var uk=cx.exports;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wl(){return Wl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wl.apply(this,arguments)}var Oi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Oi||(Oi={}));const V1="popstate";function ck(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:a,hash:o}=n.location;return Ad("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:sf(i)}return hk(e,r,null,t)}function At(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function f2(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function fk(){return Math.random().toString(36).substr(2,8)}function B1(t,e){return{usr:t.state,key:t.key,idx:e}}function Ad(t,e,r,n){return r===void 0&&(r=null),Wl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?_o(e):e,{state:r,key:e&&e.key||n||fk()})}function sf(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function _o(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function hk(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=Oi.Pop,l=null,u=f();u==null&&(u=0,a.replaceState(Wl({},a.state,{idx:u}),""));function f(){return(a.state||{idx:null}).idx}function h(){o=Oi.Pop;let y=f(),w=y==null?null:y-u;u=y,l&&l({action:o,location:m.location,delta:w})}function d(y,w){o=Oi.Push;let x=Ad(m.location,y,w);u=f()+1;let T=B1(x,u),O=m.createHref(x);try{a.pushState(T,"",O)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;i.location.assign(O)}s&&l&&l({action:o,location:m.location,delta:1})}function g(y,w){o=Oi.Replace;let x=Ad(m.location,y,w);u=f();let T=B1(x,u),O=m.createHref(x);a.replaceState(T,"",O),s&&l&&l({action:o,location:m.location,delta:0})}function _(y){let w=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof y=="string"?y:sf(y);return x=x.replace(/ $/,"%20"),At(w,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,w)}let m={get action(){return o},get location(){return t(i,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(V1,h),l=y,()=>{i.removeEventListener(V1,h),l=null}},createHref(y){return e(i,y)},createURL:_,encodeLocation(y){let w=_(y);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:d,replace:g,go(y){return a.go(y)}};return m}var U1;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(U1||(U1={}));function dk(t,e,r){return r===void 0&&(r="/"),pk(t,e,r)}function pk(t,e,r,n){let i=typeof e=="string"?_o(e):e,s=Xp(i.pathname||"/",r);if(s==null)return null;let a=h2(t);mk(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=Ik(s);o=Sk(a[l],u)}return o}function h2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(At(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Gi([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(At(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),h2(s.children,e,f,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:wk(u,s.index),routesMeta:f})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of d2(s.path))i(s,a,l)}),e}function d2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=d2(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function mk(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Tk(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const gk=/^:[\w-]+$/,vk=3,_k=2,xk=1,yk=10,Ek=-2,j1=t=>t==="*";function wk(t,e){let r=t.split("/"),n=r.length;return r.some(j1)&&(n+=Ek),e&&(n+=_k),r.filter(i=>!j1(i)).reduce((i,s)=>i+(gk.test(s)?vk:s===""?xk:yk),n)}function Tk(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Sk(t,e,r){let{routesMeta:n}=t,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=s==="/"?e:e.slice(s.length)||"/",h=Ak({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),d=l.route;if(!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:Gi([s,h.pathname]),pathnameBase:Nk(Gi([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Gi([s,h.pathnameBase]))}return a}function Ak(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=kk(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,f,h)=>{let{paramName:d,isOptional:g}=f;if(d==="*"){let m=o[h]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const _=o[h];return g&&!_?u[d]=void 0:u[d]=(_||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:t}}function kk(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),f2(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Ik(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return f2(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Xp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function Ck(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?_o(t):t;return{pathname:r?r.startsWith("/")?r:Rk(r,e):e,search:Fk(n),hash:Dk(i)}}function Rk(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function f0(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Pk(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Qp(t,e){let r=Pk(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Yp(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=_o(t):(i=Wl({},t),At(!i.pathname||!i.pathname.includes("?"),f0("?","pathname","search",i)),At(!i.pathname||!i.pathname.includes("#"),f0("#","pathname","hash",i)),At(!i.search||!i.search.includes("#"),f0("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let h=e.length-1;if(!n&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=Ck(i,o),u=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const Gi=t=>t.join("/").replace(/\/\/+/g,"/"),Nk=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Fk=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Dk=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Ok(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const p2=["post","put","patch","delete"];new Set(p2);const Lk=["get",...p2];new Set(Lk);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gl(){return Gl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gl.apply(this,arguments)}const Jp=oe.createContext(null),Mk=oe.createContext(null),hs=oe.createContext(null),Zf=oe.createContext(null),mi=oe.createContext({outlet:null,matches:[],isDataRoute:!1}),m2=oe.createContext(null);function bk(t,e){let{relative:r}=e===void 0?{}:e;xo()||At(!1);let{basename:n,navigator:i}=oe.useContext(hs),{hash:s,pathname:a,search:o}=v2(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Gi([n,a])),i.createHref({pathname:l,search:o,hash:s})}function xo(){return oe.useContext(Zf)!=null}function du(){return xo()||At(!1),oe.useContext(Zf).location}function g2(t){oe.useContext(hs).static||oe.useLayoutEffect(t)}function pu(){let{isDataRoute:t}=oe.useContext(mi);return t?Yk():Vk()}function Vk(){xo()||At(!1);let t=oe.useContext(Jp),{basename:e,future:r,navigator:n}=oe.useContext(hs),{matches:i}=oe.useContext(mi),{pathname:s}=du(),a=JSON.stringify(Qp(i,r.v7_relativeSplatPath)),o=oe.useRef(!1);return g2(()=>{o.current=!0}),oe.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=Yp(u,JSON.parse(a),s,f.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Gi([e,h.pathname])),(f.replace?n.replace:n.push)(h,f.state,f)},[e,n,a,s,t])}function Bk(){let{matches:t}=oe.useContext(mi),e=t[t.length-1];return e?e.params:{}}function v2(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=oe.useContext(hs),{matches:i}=oe.useContext(mi),{pathname:s}=du(),a=JSON.stringify(Qp(i,n.v7_relativeSplatPath));return oe.useMemo(()=>Yp(t,JSON.parse(a),s,r==="path"),[t,a,s,r])}function Uk(t,e){return jk(t,e)}function jk(t,e,r,n){xo()||At(!1);let{navigator:i}=oe.useContext(hs),{matches:s}=oe.useContext(mi),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=du(),f;if(e){var h;let y=typeof e=="string"?_o(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||At(!1),f=y}else f=u;let d=f.pathname||"/",g=d;if(l!=="/"){let y=l.replace(/^\//,"").split("/");g="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let _=dk(t,{pathname:g}),m=Gk(_&&_.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Gi([l,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Gi([l,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return e&&m?oe.createElement(Zf.Provider,{value:{location:Gl({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Oi.Pop}},m):m}function zk(){let t=Qk(),e=Ok(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return oe.createElement(oe.Fragment,null,oe.createElement("h2",null,"Unexpected Application Error!"),oe.createElement("h3",{style:{fontStyle:"italic"}},e),r?oe.createElement("pre",{style:i},r):null,null)}const $k=oe.createElement(zk,null);class Hk extends oe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?oe.createElement(mi.Provider,{value:this.props.routeContext},oe.createElement(m2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Wk(t){let{routeContext:e,match:r,children:n}=t,i=oe.useContext(Jp);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),oe.createElement(mi.Provider,{value:e},n)}function Gk(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let f=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);f>=0||At(!1),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<a.length;f++){let h=a[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=f),h.route.id){let{loaderData:d,errors:g}=r,_=h.route.loader&&d[h.route.id]===void 0&&(!g||g[h.route.id]===void 0);if(h.route.lazy||_){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((f,h,d)=>{let g,_=!1,m=null,y=null;r&&(g=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||$k,l&&(u<0&&d===0?(Jk("route-fallback"),_=!0,y=null):u===d&&(_=!0,y=h.route.hydrateFallbackElement||null)));let w=e.concat(a.slice(0,d+1)),x=()=>{let T;return g?T=m:_?T=y:h.route.Component?T=oe.createElement(h.route.Component,null):h.route.element?T=h.route.element:T=f,oe.createElement(Wk,{match:h,routeContext:{outlet:f,matches:w,isDataRoute:r!=null},children:T})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?oe.createElement(Hk,{location:r.location,revalidation:r.revalidation,component:m,error:g,children:x(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):x()},null)}var _2=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(_2||{}),x2=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(x2||{});function Kk(t){let e=oe.useContext(Jp);return e||At(!1),e}function qk(t){let e=oe.useContext(Mk);return e||At(!1),e}function Xk(t){let e=oe.useContext(mi);return e||At(!1),e}function y2(t){let e=Xk(),r=e.matches[e.matches.length-1];return r.route.id||At(!1),r.route.id}function Qk(){var t;let e=oe.useContext(m2),r=qk(),n=y2();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function Yk(){let{router:t}=Kk(_2.UseNavigateStable),e=y2(x2.UseNavigateStable),r=oe.useRef(!1);return g2(()=>{r.current=!0}),oe.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Gl({fromRouteId:e},s)))},[t,e])}const z1={};function Jk(t,e,r){z1[t]||(z1[t]=!0)}function Zk(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function E2(t){let{to:e,replace:r,state:n,relative:i}=t;xo()||At(!1);let{future:s,static:a}=oe.useContext(hs),{matches:o}=oe.useContext(mi),{pathname:l}=du(),u=pu(),f=Yp(e,Qp(o,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(f);return oe.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:i}),[u,h,i,r,n]),null}function wa(t){At(!1)}function eI(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Oi.Pop,navigator:s,static:a=!1,future:o}=t;xo()&&At(!1);let l=e.replace(/^\/*/,"/"),u=oe.useMemo(()=>({basename:l,navigator:s,static:a,future:Gl({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=_o(n));let{pathname:f="/",search:h="",hash:d="",state:g=null,key:_="default"}=n,m=oe.useMemo(()=>{let y=Xp(f,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:g,key:_},navigationType:i}},[l,f,h,d,g,_,i]);return m==null?null:oe.createElement(hs.Provider,{value:u},oe.createElement(Zf.Provider,{children:r,value:m}))}function tI(t){let{children:e,location:r}=t;return Uk(kd(e),r)}new Promise(()=>{});function kd(t,e){e===void 0&&(e=[]);let r=[];return oe.Children.forEach(t,(n,i)=>{if(!oe.isValidElement(n))return;let s=[...e,i];if(n.type===oe.Fragment){r.push.apply(r,kd(n.props.children,s));return}n.type!==wa&&At(!1),!n.props.index||!n.props.children||At(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=kd(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Id(){return Id=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Id.apply(this,arguments)}function rI(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function nI(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function iI(t,e){return t.button===0&&(!e||e==="_self")&&!nI(t)}const sI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],aI="6";try{window.__reactRouterVersion=aI}catch{}const oI="startTransition",$1=JS[oI];function lI(t){let{basename:e,children:r,future:n,window:i}=t,s=oe.useRef();s.current==null&&(s.current=ck({window:i,v5Compat:!0}));let a=s.current,[o,l]=oe.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},f=oe.useCallback(h=>{u&&$1?$1(()=>l(h)):l(h)},[l,u]);return oe.useLayoutEffect(()=>a.listen(f),[a,f]),oe.useEffect(()=>Zk(n),[n]),oe.createElement(eI,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const uI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",cI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fI=oe.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:f,viewTransition:h}=e,d=rI(e,sI),{basename:g}=oe.useContext(hs),_,m=!1;if(typeof u=="string"&&cI.test(u)&&(_=u,uI))try{let T=new URL(window.location.href),O=u.startsWith("//")?new URL(T.protocol+u):new URL(u),U=Xp(O.pathname,g);O.origin===T.origin&&U!=null?u=U+O.search+O.hash:m=!0}catch{}let y=bk(u,{relative:i}),w=hI(u,{replace:a,state:o,target:l,preventScrollReset:f,relative:i,viewTransition:h});function x(T){n&&n(T),T.defaultPrevented||w(T)}return oe.createElement("a",Id({},d,{href:_||y,onClick:m||s?n:x,ref:r,target:l}))});var H1;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(H1||(H1={}));var W1;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(W1||(W1={}));function hI(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,l=pu(),u=du(),f=v2(t,{relative:a});return oe.useCallback(h=>{if(iI(h,r)){h.preventDefault();let d=n!==void 0?n:sf(u)===sf(f);l(t,{replace:d,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,f,n,i,r,t,s,a,o])}const dI=()=>{};var G1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},pI=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},T2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|u>>6,g=u&63;l||(g=64,a||(d=64)),n.push(r[f],r[h],r[d],r[g])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(w2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):pI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||u==null||h==null)throw new mI;const d=s<<2|o>>4;if(n.push(d),u!==64){const g=o<<4&240|u>>2;if(n.push(g),h!==64){const _=u<<6&192|h;n.push(_)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class mI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gI=function(t){const e=w2(t);return T2.encodeByteArray(e,!0)},af=function(t){return gI(t).replace(/\./g,"")},vI=function(t){try{return T2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI=()=>_I().__FIREBASE_DEFAULTS__,yI=()=>{if(typeof process>"u"||typeof G1>"u")return;const t=G1.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},EI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&vI(t[1]);return e&&JSON.parse(e)},Zp=()=>{try{return dI()||xI()||yI()||EI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wI=t=>{var e,r;return(r=(e=Zp())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},TI=t=>{const e=wI(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},S2=()=>{var t;return(t=Zp())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function AI(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[af(JSON.stringify(r)),af(JSON.stringify(a)),""].join(".")}const gl={};function II(){const t={prod:[],emulator:[]};for(const e of Object.keys(gl))gl[e]?t.emulator.push(e):t.prod.push(e);return t}function CI(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let K1=!1;function RI(t,e){if(typeof window>"u"||typeof document>"u"||!em(window.location.host)||gl[t]===e||gl[t]||K1)return;gl[t]=e;function r(d){return`__firebase__banner__${d}`}const n="__firebase__banner",s=II().prod.length>0;function a(){const d=document.getElementById(n);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,g){d.setAttribute("width","24"),d.setAttribute("id",g),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function u(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{K1=!0,a()},d}function f(d,g){d.setAttribute("id",g),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=CI(n),g=r("text"),_=document.getElementById(g)||document.createElement("span"),m=r("learnmore"),y=document.getElementById(m)||document.createElement("a"),w=r("preprendIcon"),x=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const T=d.element;o(T),f(y,m);const O=u();l(x,w),T.append(x,_,y,O),document.body.appendChild(T)}s?(_.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NI(){var e;const t=(e=Zp())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function DI(){return!NI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function A2(){try{return typeof indexedDB=="object"}catch{return!1}}function k2(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(r){e(r)}})}function OI(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI="FirebaseError";class ds extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=LI,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eh.prototype.create)}}class eh{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?MI(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new ds(i,o,n)}}function MI(t,e){return t.replace(bI,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const bI=/\{\$([^}]+)}/g;function Kl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(q1(s)&&q1(a)){if(!Kl(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function q1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=1e3,BI=2,UI=4*60*60*1e3,jI=.5;function X1(t,e=VI,r=BI){const n=e*Math.pow(r,t),i=Math.round(jI*n*(Math.random()-.5)*2);return Math.min(UI,n+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(t){return t&&t._delegate?t._delegate:t}class li{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new SI;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HI(e))try{this.getOrInitializeService({instanceIdentifier:ks})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=ks){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ks){return this.instances.has(e)}getOptions(e=ks){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:$I(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ks){return this.component?this.component.multipleInstances?e:ks:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $I(t){return t===ks?void 0:t}function HI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new zI(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ue||(Ue={}));const GI={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},KI=Ue.INFO,qI={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},XI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=qI[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tm{constructor(e){this.name=e,this._logLevel=KI,this._logHandler=XI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...e),this._logHandler(this,Ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...e),this._logHandler(this,Ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...e),this._logHandler(this,Ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...e),this._logHandler(this,Ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...e),this._logHandler(this,Ue.ERROR,...e)}}const QI=(t,e)=>e.some(r=>t instanceof r);let Q1,Y1;function YI(){return Q1||(Q1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JI(){return Y1||(Y1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const I2=new WeakMap,Cd=new WeakMap,C2=new WeakMap,h0=new WeakMap,rm=new WeakMap;function ZI(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Ki(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&I2.set(r,t)}).catch(()=>{}),rm.set(e,t),e}function eC(t){if(Cd.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Cd.set(t,e)}let Rd={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Cd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||C2.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ki(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tC(t){Rd=t(Rd)}function rC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(d0(this),e,...r);return C2.set(n,e.sort?e.sort():[e]),Ki(n)}:JI().includes(t)?function(...e){return t.apply(d0(this),e),Ki(I2.get(this))}:function(...e){return Ki(t.apply(d0(this),e))}}function nC(t){return typeof t=="function"?rC(t):(t instanceof IDBTransaction&&eC(t),QI(t,YI())?new Proxy(t,Rd):t)}function Ki(t){if(t instanceof IDBRequest)return ZI(t);if(h0.has(t))return h0.get(t);const e=nC(t);return e!==t&&(h0.set(t,e),rm.set(e,t)),e}const d0=t=>rm.get(t);function R2(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Ki(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Ki(a.result),l.oldVersion,l.newVersion,Ki(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const iC=["get","getKey","getAll","getAllKeys","count"],sC=["put","add","delete","clear"],p0=new Map;function J1(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(p0.get(e))return p0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=sC.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||iC.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),i&&l.done]))[0]};return p0.set(e,s),s}tC(t=>({...t,get:(e,r,n)=>J1(e,r)||t.get(e,r,n),has:(e,r)=>!!J1(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(oC(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function oC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pd="@firebase/app",Z1="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new tm("@firebase/app"),lC="@firebase/app-compat",uC="@firebase/analytics-compat",cC="@firebase/analytics",fC="@firebase/app-check-compat",hC="@firebase/app-check",dC="@firebase/auth",pC="@firebase/auth-compat",mC="@firebase/database",gC="@firebase/data-connect",vC="@firebase/database-compat",_C="@firebase/functions",xC="@firebase/functions-compat",yC="@firebase/installations",EC="@firebase/installations-compat",wC="@firebase/messaging",TC="@firebase/messaging-compat",SC="@firebase/performance",AC="@firebase/performance-compat",kC="@firebase/remote-config",IC="@firebase/remote-config-compat",CC="@firebase/storage",RC="@firebase/storage-compat",PC="@firebase/firestore",NC="@firebase/ai",FC="@firebase/firestore-compat",DC="firebase",OC="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="[DEFAULT]",LC={[Pd]:"fire-core",[lC]:"fire-core-compat",[cC]:"fire-analytics",[uC]:"fire-analytics-compat",[hC]:"fire-app-check",[fC]:"fire-app-check-compat",[dC]:"fire-auth",[pC]:"fire-auth-compat",[mC]:"fire-rtdb",[gC]:"fire-data-connect",[vC]:"fire-rtdb-compat",[_C]:"fire-fn",[xC]:"fire-fn-compat",[yC]:"fire-iid",[EC]:"fire-iid-compat",[wC]:"fire-fcm",[TC]:"fire-fcm-compat",[SC]:"fire-perf",[AC]:"fire-perf-compat",[kC]:"fire-rc",[IC]:"fire-rc-compat",[CC]:"fire-gcs",[RC]:"fire-gcs-compat",[PC]:"fire-fst",[FC]:"fire-fst-compat",[NC]:"fire-vertex","fire-js":"fire-js",[DC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of=new Map,MC=new Map,Fd=new Map;function ev(t,e){try{t.container.addComponent(e)}catch(r){ui.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Zi(t){const e=t.name;if(Fd.has(e))return ui.debug(`There were multiple attempts to register component ${e}.`),!1;Fd.set(e,t);for(const r of of.values())ev(r,t);for(const r of MC.values())ev(r,t);return!0}function mu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function bC(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qi=new eh("app","Firebase",VC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new li("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=OC;function P2(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Nd,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw qi.create("bad-app-name",{appName:String(i)});if(r||(r=S2()),!r)throw qi.create("no-options");const s=of.get(i);if(s){if(Kl(r,s.options)&&Kl(n,s.config))return s;throw qi.create("duplicate-app",{appName:i})}const a=new WI(i);for(const l of Fd.values())a.addComponent(l);const o=new BC(r,n,a);return of.set(i,o),o}function N2(t=Nd){const e=of.get(t);if(!e&&t===Nd&&S2())return P2();if(!e)throw qi.create("no-app",{appName:t});return e}function bn(t,e,r){let n=LC[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ui.warn(a.join(" "));return}Zi(new li(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC="firebase-heartbeat-database",zC=1,ql="firebase-heartbeat-store";let m0=null;function F2(){return m0||(m0=R2(jC,zC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ql)}catch(r){console.warn(r)}}}}).catch(t=>{throw qi.create("idb-open",{originalErrorMessage:t.message})})),m0}async function $C(t){try{const r=(await F2()).transaction(ql),n=await r.objectStore(ql).get(D2(t));return await r.done,n}catch(e){if(e instanceof ds)ui.warn(e.message);else{const r=qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ui.warn(r.message)}}}async function tv(t,e){try{const n=(await F2()).transaction(ql,"readwrite");await n.objectStore(ql).put(e,D2(t)),await n.done}catch(r){if(r instanceof ds)ui.warn(r.message);else{const n=qi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ui.warn(n.message)}}}function D2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=1024,WC=30;class GC{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new qC(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=rv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>WC){const a=XC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ui.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=rv(),{heartbeatsToSend:n,unsentEntries:i}=KC(this._heartbeatsCache.heartbeats),s=af(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ui.warn(r),""}}}function rv(){return new Date().toISOString().substring(0,10)}function KC(t,e=HC){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),nv(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),nv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class qC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return A2()?k2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await $C(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return tv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return tv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function nv(t){return af(JSON.stringify({version:2,heartbeats:t})).length}function XC(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t){Zi(new li("platform-logger",e=>new aC(e),"PRIVATE")),Zi(new li("heartbeat",e=>new GC(e),"PRIVATE")),bn(Pd,Z1,t),bn(Pd,Z1,"esm2020"),bn("fire-js","")}QC("");var YC="firebase",JC="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn(YC,JC,"app");const O2="@firebase/installations",nm="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=1e4,M2=`w:${nm}`,b2="FIS_v2",ZC="https://firebaseinstallations.googleapis.com/v1",e3=60*60*1e3,t3="installations",r3="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},$s=new eh(t3,r3,n3);function V2(t){return t instanceof ds&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2({projectId:t}){return`${ZC}/projects/${t}/installations`}function U2(t){return{token:t.token,requestStatus:2,expiresIn:s3(t.expiresIn),creationTime:Date.now()}}async function j2(t,e){const n=(await e.json()).error;return $s.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function z2({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function i3(t,{refreshToken:e}){const r=z2(t);return r.append("Authorization",a3(e)),r}async function $2(t){const e=await t();return e.status>=500&&e.status<600?t():e}function s3(t){return Number(t.replace("s","000"))}function a3(t){return`${b2} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o3({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=B2(t),i=z2(t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const a={fid:r,authVersion:b2,appId:t.appId,sdkVersion:M2},o={method:"POST",headers:i,body:JSON.stringify(a)},l=await $2(()=>fetch(n,o));if(l.ok){const u=await l.json();return{fid:u.fid||r,registrationStatus:2,refreshToken:u.refreshToken,authToken:U2(u.authToken)}}else throw await j2("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l3(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3=/^[cdef][\w-]{21}$/,Dd="";function c3(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=f3(t);return u3.test(r)?r:Dd}catch{return Dd}}function f3(t){return l3(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2=new Map;function G2(t,e){const r=th(t);K2(r,e),h3(r,e)}function K2(t,e){const r=W2.get(t);if(r)for(const n of r)n(e)}function h3(t,e){const r=d3();r&&r.postMessage({key:t,fid:e}),p3()}let Ns=null;function d3(){return!Ns&&"BroadcastChannel"in self&&(Ns=new BroadcastChannel("[Firebase] FID Change"),Ns.onmessage=t=>{K2(t.data.key,t.data.fid)}),Ns}function p3(){W2.size===0&&Ns&&(Ns.close(),Ns=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3="firebase-installations-database",g3=1,Hs="firebase-installations-store";let g0=null;function im(){return g0||(g0=R2(m3,g3,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Hs)}}})),g0}async function lf(t,e){const r=th(t),i=(await im()).transaction(Hs,"readwrite"),s=i.objectStore(Hs),a=await s.get(r);return await s.put(e,r),await i.done,(!a||a.fid!==e.fid)&&G2(t,e.fid),e}async function q2(t){const e=th(t),n=(await im()).transaction(Hs,"readwrite");await n.objectStore(Hs).delete(e),await n.done}async function rh(t,e){const r=th(t),i=(await im()).transaction(Hs,"readwrite"),s=i.objectStore(Hs),a=await s.get(r),o=e(a);return o===void 0?await s.delete(r):await s.put(o,r),await i.done,o&&(!a||a.fid!==o.fid)&&G2(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sm(t){let e;const r=await rh(t.appConfig,n=>{const i=v3(n),s=_3(t,i);return e=s.registrationPromise,s.installationEntry});return r.fid===Dd?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function v3(t){const e=t||{fid:c3(),registrationStatus:0};return X2(e)}function _3(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject($s.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=x3(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:y3(t)}:{installationEntry:e}}async function x3(t,e){try{const r=await o3(t,e);return lf(t.appConfig,r)}catch(r){throw V2(r)&&r.customData.serverCode===409?await q2(t.appConfig):await lf(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function y3(t){let e=await iv(t.appConfig);for(;e.registrationStatus===1;)await H2(100),e=await iv(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await sm(t);return n||r}return e}function iv(t){return rh(t,e=>{if(!e)throw $s.create("installation-not-found");return X2(e)})}function X2(t){return E3(t)?{fid:t.fid,registrationStatus:0}:t}function E3(t){return t.registrationStatus===1&&t.registrationTime+L2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w3({appConfig:t,heartbeatServiceProvider:e},r){const n=T3(t,r),i=i3(t,r),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const a={installation:{sdkVersion:M2,appId:t.appId}},o={method:"POST",headers:i,body:JSON.stringify(a)},l=await $2(()=>fetch(n,o));if(l.ok){const u=await l.json();return U2(u)}else throw await j2("Generate Auth Token",l)}function T3(t,{fid:e}){return`${B2(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function am(t,e=!1){let r;const n=await rh(t.appConfig,s=>{if(!Q2(s))throw $s.create("not-registered");const a=s.authToken;if(!e&&k3(a))return s;if(a.requestStatus===1)return r=S3(t,e),s;{if(!navigator.onLine)throw $s.create("app-offline");const o=C3(s);return r=A3(t,o),o}});return r?await r:n.authToken}async function S3(t,e){let r=await sv(t.appConfig);for(;r.authToken.requestStatus===1;)await H2(100),r=await sv(t.appConfig);const n=r.authToken;return n.requestStatus===0?am(t,e):n}function sv(t){return rh(t,e=>{if(!Q2(e))throw $s.create("not-registered");const r=e.authToken;return R3(r)?{...e,authToken:{requestStatus:0}}:e})}async function A3(t,e){try{const r=await w3(t,e),n={...e,authToken:r};return await lf(t.appConfig,n),r}catch(r){if(V2(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await q2(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await lf(t.appConfig,n)}throw r}}function Q2(t){return t!==void 0&&t.registrationStatus===2}function k3(t){return t.requestStatus===2&&!I3(t)}function I3(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+e3}function C3(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function R3(t){return t.requestStatus===1&&t.requestTime+L2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P3(t){const e=t,{installationEntry:r,registrationPromise:n}=await sm(e);return n?n.catch(console.error):am(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N3(t,e=!1){const r=t;return await F3(r),(await am(r,e)).token}async function F3(t){const{registrationPromise:e}=await sm(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D3(t){if(!t||!t.options)throw v0("App Configuration");if(!t.name)throw v0("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw v0(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function v0(t){return $s.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2="installations",O3="installations-internal",L3=t=>{const e=t.getProvider("app").getImmediate(),r=D3(e),n=mu(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},M3=t=>{const e=t.getProvider("app").getImmediate(),r=mu(e,Y2).getImmediate();return{getId:()=>P3(r),getToken:i=>N3(r,i)}};function b3(){Zi(new li(Y2,L3,"PUBLIC")),Zi(new li(O3,M3,"PRIVATE"))}b3();bn(O2,nm);bn(O2,nm,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf="analytics",V3="firebase_id",B3="origin",U3=60*1e3,j3="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",om="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr=new tm("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Hr=new eh("analytics","Analytics",z3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(t){if(!t.startsWith(om)){const e=Hr.create("invalid-gtag-resource",{gtagURL:t});return Fr.warn(e.message),""}return t}function J2(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function H3(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function W3(t,e){const r=H3("firebase-js-sdk-policy",{createScriptURL:$3}),n=document.createElement("script"),i=`${om}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function G3(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function K3(t,e,r,n,i,s){const a=n[i];try{if(a)await e[a];else{const l=(await J2(r)).find(u=>u.measurementId===i);l&&await e[l.appId]}}catch(o){Fr.error(o)}t("config",i,s)}async function q3(t,e,r,n,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const o=await J2(r);for(const l of a){const u=o.find(h=>h.measurementId===l),f=u&&e[u.appId];if(f)s.push(f);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",n,i||{})}catch(s){Fr.error(s)}}function X3(t,e,r,n){async function i(s,...a){try{if(s==="event"){const[o,l]=a;await q3(t,e,r,o,l)}else if(s==="config"){const[o,l]=a;await K3(t,e,r,n,o,l)}else if(s==="consent"){const[o,l]=a;t("consent",o,l)}else if(s==="get"){const[o,l,u]=a;t("get",o,l,u)}else if(s==="set"){const[o]=a;t("set",o)}else t(s,...a)}catch(o){Fr.error(o)}}return i}function Q3(t,e,r,n,i){let s=function(...a){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=X3(s,t,e,r),{gtagCore:s,wrappedGtag:window[i]}}function Y3(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(om)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3=30,Z3=1e3;class eR{constructor(e={},r=Z3){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Z2=new eR;function tR(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function rR(t){var a;const{appId:e,apiKey:r}=t,n={method:"GET",headers:tR(r)},i=j3.replace("{app-id}",e),s=await fetch(i,n);if(s.status!==200&&s.status!==304){let o="";try{const l=await s.json();(a=l.error)!=null&&a.message&&(o=l.error.message)}catch{}throw Hr.create("config-fetch-failed",{httpStatus:s.status,responseMessage:o})}return s.json()}async function nR(t,e=Z2,r){const{appId:n,apiKey:i,measurementId:s}=t.options;if(!n)throw Hr.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw Hr.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new aR;return setTimeout(async()=>{o.abort()},U3),eE({appId:n,apiKey:i,measurementId:s},a,o,e)}async function eE(t,{throttleEndTimeMillis:e,backoffCount:r},n,i=Z2){var o;const{appId:s,measurementId:a}=t;try{await iR(n,e)}catch(l){if(a)return Fr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:a};throw l}try{const l=await rR(t);return i.deleteThrottleMetadata(s),l}catch(l){const u=l;if(!sR(u)){if(i.deleteThrottleMetadata(s),a)return Fr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:s,measurementId:a};throw l}const f=Number((o=u==null?void 0:u.customData)==null?void 0:o.httpStatus)===503?X1(r,i.intervalMillis,J3):X1(r,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return i.setThrottleMetadata(s,h),Fr.debug(`Calling attemptFetch again in ${f} millis`),eE(t,h,n,i)}}function iR(t,e){return new Promise((r,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(r,i);t.addEventListener(()=>{clearTimeout(s),n(Hr.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function sR(t){if(!(t instanceof ds)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class aR{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function oR(t,e,r,n,i){if(i&&i.global){t("event",r,n);return}else{const s=await e,a={...n,send_to:s};t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lR(){if(A2())try{await k2()}catch(t){return Fr.warn(Hr.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Fr.warn(Hr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function uR(t,e,r,n,i,s,a){const o=nR(t);o.then(d=>{r[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&Fr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>Fr.error(d)),e.push(o);const l=lR().then(d=>{if(d)return n.getId()}),[u,f]=await Promise.all([o,l]);Y3(s)||W3(s,u.measurementId),i("js",new Date);const h=(a==null?void 0:a.config)??{};return h[B3]="firebase",h.update=!0,f!=null&&(h[V3]=f),i("config",u.measurementId,h),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e){this.app=e}_delete(){return delete vl[this.app.options.appId],Promise.resolve()}}let vl={},av=[];const ov={};let _0="dataLayer",fR="gtag",lv,tE,uv=!1;function hR(){const t=[];if(FI()&&t.push("This is a browser extension environment."),OI()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,i)=>`(${i+1}) ${n}`).join(" "),r=Hr.create("invalid-analytics-context",{errorInfo:e});Fr.warn(r.message)}}function dR(t,e,r){hR();const n=t.options.appId;if(!n)throw Hr.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Fr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Hr.create("no-api-key");if(vl[n]!=null)throw Hr.create("already-exists",{id:n});if(!uv){G3(_0);const{wrappedGtag:s,gtagCore:a}=Q3(vl,av,ov,_0,fR);tE=s,lv=a,uv=!0}return vl[n]=uR(t,av,ov,e,lv,_0,r),new cR(t)}function pR(t=N2()){t=zs(t);const e=mu(t,uf);return e.isInitialized()?e.getImmediate():mR(t)}function mR(t,e={}){const r=mu(t,uf);if(r.isInitialized()){const i=r.getImmediate();if(Kl(e,r.getOptions()))return i;throw Hr.create("already-initialized")}return r.initialize({options:e})}function gR(t,e,r,n){t=zs(t),oR(tE,vl[t.app.options.appId],e,r,n).catch(i=>Fr.error(i))}const cv="@firebase/analytics",fv="0.10.18";function vR(){Zi(new li(uf,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return dR(n,i,r)},"PUBLIC")),Zi(new li("analytics-internal",t,"PRIVATE")),bn(cv,fv),bn(cv,fv,"esm2020");function t(e){try{const r=e.getProvider(uf).getImmediate();return{logEvent:(n,i,s)=>gR(r,n,i,s)}}catch(r){throw Hr.create("interop-component-reg-failed",{reason:r})}}}vR();var hv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xi,rE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,S){function A(){}A.prototype=S.prototype,E.F=S.prototype,E.prototype=new A,E.prototype.constructor=E,E.D=function(I,P,V){for(var N=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)N[Ce-2]=arguments[Ce];return S.prototype[P].apply(I,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,S,A){A||(A=0);const I=Array(16);if(typeof S=="string")for(var P=0;P<16;++P)I[P]=S.charCodeAt(A++)|S.charCodeAt(A++)<<8|S.charCodeAt(A++)<<16|S.charCodeAt(A++)<<24;else for(P=0;P<16;++P)I[P]=S[A++]|S[A++]<<8|S[A++]<<16|S[A++]<<24;S=E.g[0],A=E.g[1],P=E.g[2];let V=E.g[3],N;N=S+(V^A&(P^V))+I[0]+3614090360&4294967295,S=A+(N<<7&4294967295|N>>>25),N=V+(P^S&(A^P))+I[1]+3905402710&4294967295,V=S+(N<<12&4294967295|N>>>20),N=P+(A^V&(S^A))+I[2]+606105819&4294967295,P=V+(N<<17&4294967295|N>>>15),N=A+(S^P&(V^S))+I[3]+3250441966&4294967295,A=P+(N<<22&4294967295|N>>>10),N=S+(V^A&(P^V))+I[4]+4118548399&4294967295,S=A+(N<<7&4294967295|N>>>25),N=V+(P^S&(A^P))+I[5]+1200080426&4294967295,V=S+(N<<12&4294967295|N>>>20),N=P+(A^V&(S^A))+I[6]+2821735955&4294967295,P=V+(N<<17&4294967295|N>>>15),N=A+(S^P&(V^S))+I[7]+4249261313&4294967295,A=P+(N<<22&4294967295|N>>>10),N=S+(V^A&(P^V))+I[8]+1770035416&4294967295,S=A+(N<<7&4294967295|N>>>25),N=V+(P^S&(A^P))+I[9]+2336552879&4294967295,V=S+(N<<12&4294967295|N>>>20),N=P+(A^V&(S^A))+I[10]+4294925233&4294967295,P=V+(N<<17&4294967295|N>>>15),N=A+(S^P&(V^S))+I[11]+2304563134&4294967295,A=P+(N<<22&4294967295|N>>>10),N=S+(V^A&(P^V))+I[12]+1804603682&4294967295,S=A+(N<<7&4294967295|N>>>25),N=V+(P^S&(A^P))+I[13]+4254626195&4294967295,V=S+(N<<12&4294967295|N>>>20),N=P+(A^V&(S^A))+I[14]+2792965006&4294967295,P=V+(N<<17&4294967295|N>>>15),N=A+(S^P&(V^S))+I[15]+1236535329&4294967295,A=P+(N<<22&4294967295|N>>>10),N=S+(P^V&(A^P))+I[1]+4129170786&4294967295,S=A+(N<<5&4294967295|N>>>27),N=V+(A^P&(S^A))+I[6]+3225465664&4294967295,V=S+(N<<9&4294967295|N>>>23),N=P+(S^A&(V^S))+I[11]+643717713&4294967295,P=V+(N<<14&4294967295|N>>>18),N=A+(V^S&(P^V))+I[0]+3921069994&4294967295,A=P+(N<<20&4294967295|N>>>12),N=S+(P^V&(A^P))+I[5]+3593408605&4294967295,S=A+(N<<5&4294967295|N>>>27),N=V+(A^P&(S^A))+I[10]+38016083&4294967295,V=S+(N<<9&4294967295|N>>>23),N=P+(S^A&(V^S))+I[15]+3634488961&4294967295,P=V+(N<<14&4294967295|N>>>18),N=A+(V^S&(P^V))+I[4]+3889429448&4294967295,A=P+(N<<20&4294967295|N>>>12),N=S+(P^V&(A^P))+I[9]+568446438&4294967295,S=A+(N<<5&4294967295|N>>>27),N=V+(A^P&(S^A))+I[14]+3275163606&4294967295,V=S+(N<<9&4294967295|N>>>23),N=P+(S^A&(V^S))+I[3]+4107603335&4294967295,P=V+(N<<14&4294967295|N>>>18),N=A+(V^S&(P^V))+I[8]+1163531501&4294967295,A=P+(N<<20&4294967295|N>>>12),N=S+(P^V&(A^P))+I[13]+2850285829&4294967295,S=A+(N<<5&4294967295|N>>>27),N=V+(A^P&(S^A))+I[2]+4243563512&4294967295,V=S+(N<<9&4294967295|N>>>23),N=P+(S^A&(V^S))+I[7]+1735328473&4294967295,P=V+(N<<14&4294967295|N>>>18),N=A+(V^S&(P^V))+I[12]+2368359562&4294967295,A=P+(N<<20&4294967295|N>>>12),N=S+(A^P^V)+I[5]+4294588738&4294967295,S=A+(N<<4&4294967295|N>>>28),N=V+(S^A^P)+I[8]+2272392833&4294967295,V=S+(N<<11&4294967295|N>>>21),N=P+(V^S^A)+I[11]+1839030562&4294967295,P=V+(N<<16&4294967295|N>>>16),N=A+(P^V^S)+I[14]+4259657740&4294967295,A=P+(N<<23&4294967295|N>>>9),N=S+(A^P^V)+I[1]+2763975236&4294967295,S=A+(N<<4&4294967295|N>>>28),N=V+(S^A^P)+I[4]+1272893353&4294967295,V=S+(N<<11&4294967295|N>>>21),N=P+(V^S^A)+I[7]+4139469664&4294967295,P=V+(N<<16&4294967295|N>>>16),N=A+(P^V^S)+I[10]+3200236656&4294967295,A=P+(N<<23&4294967295|N>>>9),N=S+(A^P^V)+I[13]+681279174&4294967295,S=A+(N<<4&4294967295|N>>>28),N=V+(S^A^P)+I[0]+3936430074&4294967295,V=S+(N<<11&4294967295|N>>>21),N=P+(V^S^A)+I[3]+3572445317&4294967295,P=V+(N<<16&4294967295|N>>>16),N=A+(P^V^S)+I[6]+76029189&4294967295,A=P+(N<<23&4294967295|N>>>9),N=S+(A^P^V)+I[9]+3654602809&4294967295,S=A+(N<<4&4294967295|N>>>28),N=V+(S^A^P)+I[12]+3873151461&4294967295,V=S+(N<<11&4294967295|N>>>21),N=P+(V^S^A)+I[15]+530742520&4294967295,P=V+(N<<16&4294967295|N>>>16),N=A+(P^V^S)+I[2]+3299628645&4294967295,A=P+(N<<23&4294967295|N>>>9),N=S+(P^(A|~V))+I[0]+4096336452&4294967295,S=A+(N<<6&4294967295|N>>>26),N=V+(A^(S|~P))+I[7]+1126891415&4294967295,V=S+(N<<10&4294967295|N>>>22),N=P+(S^(V|~A))+I[14]+2878612391&4294967295,P=V+(N<<15&4294967295|N>>>17),N=A+(V^(P|~S))+I[5]+4237533241&4294967295,A=P+(N<<21&4294967295|N>>>11),N=S+(P^(A|~V))+I[12]+1700485571&4294967295,S=A+(N<<6&4294967295|N>>>26),N=V+(A^(S|~P))+I[3]+2399980690&4294967295,V=S+(N<<10&4294967295|N>>>22),N=P+(S^(V|~A))+I[10]+4293915773&4294967295,P=V+(N<<15&4294967295|N>>>17),N=A+(V^(P|~S))+I[1]+2240044497&4294967295,A=P+(N<<21&4294967295|N>>>11),N=S+(P^(A|~V))+I[8]+1873313359&4294967295,S=A+(N<<6&4294967295|N>>>26),N=V+(A^(S|~P))+I[15]+4264355552&4294967295,V=S+(N<<10&4294967295|N>>>22),N=P+(S^(V|~A))+I[6]+2734768916&4294967295,P=V+(N<<15&4294967295|N>>>17),N=A+(V^(P|~S))+I[13]+1309151649&4294967295,A=P+(N<<21&4294967295|N>>>11),N=S+(P^(A|~V))+I[4]+4149444226&4294967295,S=A+(N<<6&4294967295|N>>>26),N=V+(A^(S|~P))+I[11]+3174756917&4294967295,V=S+(N<<10&4294967295|N>>>22),N=P+(S^(V|~A))+I[2]+718787259&4294967295,P=V+(N<<15&4294967295|N>>>17),N=A+(V^(P|~S))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+S&4294967295,E.g[1]=E.g[1]+(P+(N<<21&4294967295|N>>>11))&4294967295,E.g[2]=E.g[2]+P&4294967295,E.g[3]=E.g[3]+V&4294967295}n.prototype.v=function(E,S){S===void 0&&(S=E.length);const A=S-this.blockSize,I=this.C;let P=this.h,V=0;for(;V<S;){if(P==0)for(;V<=A;)i(this,E,V),V+=this.blockSize;if(typeof E=="string"){for(;V<S;)if(I[P++]=E.charCodeAt(V++),P==this.blockSize){i(this,I),P=0;break}}else for(;V<S;)if(I[P++]=E[V++],P==this.blockSize){i(this,I),P=0;break}}this.h=P,this.o+=S},n.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var S=1;S<E.length-8;++S)E[S]=0;S=this.o*8;for(var A=E.length-8;A<E.length;++A)E[A]=S&255,S/=256;for(this.v(E),E=Array(16),S=0,A=0;A<4;++A)for(let I=0;I<32;I+=8)E[S++]=this.g[A]>>>I&255;return E};function s(E,S){var A=o;return Object.prototype.hasOwnProperty.call(A,E)?A[E]:A[E]=S(E)}function a(E,S){this.h=S;const A=[];let I=!0;for(let P=E.length-1;P>=0;P--){const V=E[P]|0;I&&V==S||(A[P]=V,I=!1)}this.g=A}var o={};function l(E){return-128<=E&&E<128?s(E,function(S){return new a([S|0],S<0?-1:0)}):new a([E|0],E<0?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return h;if(E<0)return y(u(-E));const S=[];let A=1;for(let I=0;E>=A;I++)S[I]=E/A|0,A*=4294967296;return new a(S,0)}function f(E,S){if(E.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(E.charAt(0)=="-")return y(f(E.substring(1),S));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=u(Math.pow(S,8));let I=h;for(let V=0;V<E.length;V+=8){var P=Math.min(8,E.length-V);const N=parseInt(E.substring(V,V+P),S);P<8?(P=u(Math.pow(S,P)),I=I.j(P).add(u(N))):(I=I.j(A),I=I.add(u(N)))}return I}var h=l(0),d=l(1),g=l(16777216);t=a.prototype,t.m=function(){if(m(this))return-y(this).m();let E=0,S=1;for(let A=0;A<this.g.length;A++){const I=this.i(A);E+=(I>=0?I:4294967296+I)*S,S*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(_(this))return"0";if(m(this))return"-"+y(this).toString(E);const S=u(Math.pow(E,6));var A=this;let I="";for(;;){const P=O(A,S).g;A=w(A,P.j(S));let V=((A.g.length>0?A.g[0]:A.h)>>>0).toString(E);if(A=P,_(A))return V+I;for(;V.length<6;)V="0"+V;I=V+I}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function _(E){if(E.h!=0)return!1;for(let S=0;S<E.g.length;S++)if(E.g[S]!=0)return!1;return!0}function m(E){return E.h==-1}t.l=function(E){return E=w(this,E),m(E)?-1:_(E)?0:1};function y(E){const S=E.g.length,A=[];for(let I=0;I<S;I++)A[I]=~E.g[I];return new a(A,~E.h).add(d)}t.abs=function(){return m(this)?y(this):this},t.add=function(E){const S=Math.max(this.g.length,E.g.length),A=[];let I=0;for(let P=0;P<=S;P++){let V=I+(this.i(P)&65535)+(E.i(P)&65535),N=(V>>>16)+(this.i(P)>>>16)+(E.i(P)>>>16);I=N>>>16,V&=65535,N&=65535,A[P]=N<<16|V}return new a(A,A[A.length-1]&-2147483648?-1:0)};function w(E,S){return E.add(y(S))}t.j=function(E){if(_(this)||_(E))return h;if(m(this))return m(E)?y(this).j(y(E)):y(y(this).j(E));if(m(E))return y(this.j(y(E)));if(this.l(g)<0&&E.l(g)<0)return u(this.m()*E.m());const S=this.g.length+E.g.length,A=[];for(var I=0;I<2*S;I++)A[I]=0;for(I=0;I<this.g.length;I++)for(let P=0;P<E.g.length;P++){const V=this.i(I)>>>16,N=this.i(I)&65535,Ce=E.i(P)>>>16,ke=E.i(P)&65535;A[2*I+2*P]+=N*ke,x(A,2*I+2*P),A[2*I+2*P+1]+=V*ke,x(A,2*I+2*P+1),A[2*I+2*P+1]+=N*Ce,x(A,2*I+2*P+1),A[2*I+2*P+2]+=V*Ce,x(A,2*I+2*P+2)}for(E=0;E<S;E++)A[E]=A[2*E+1]<<16|A[2*E];for(E=S;E<2*S;E++)A[E]=0;return new a(A,0)};function x(E,S){for(;(E[S]&65535)!=E[S];)E[S+1]+=E[S]>>>16,E[S]&=65535,S++}function T(E,S){this.g=E,this.h=S}function O(E,S){if(_(S))throw Error("division by zero");if(_(E))return new T(h,h);if(m(E))return S=O(y(E),S),new T(y(S.g),y(S.h));if(m(S))return S=O(E,y(S)),new T(y(S.g),S.h);if(E.g.length>30){if(m(E)||m(S))throw Error("slowDivide_ only works with positive integers.");for(var A=d,I=S;I.l(E)<=0;)A=U(A),I=U(I);var P=W(A,1),V=W(I,1);for(I=W(I,2),A=W(A,2);!_(I);){var N=V.add(I);N.l(E)<=0&&(P=P.add(A),V=N),I=W(I,1),A=W(A,1)}return S=w(E,P.j(S)),new T(P,S)}for(P=h;E.l(S)>=0;){for(A=Math.max(1,Math.floor(E.m()/S.m())),I=Math.ceil(Math.log(A)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),V=u(A),N=V.j(S);m(N)||N.l(E)>0;)A-=I,V=u(A),N=V.j(S);_(V)&&(V=d),P=P.add(V),E=w(E,N)}return new T(P,E)}t.B=function(E){return O(this,E).h},t.and=function(E){const S=Math.max(this.g.length,E.g.length),A=[];for(let I=0;I<S;I++)A[I]=this.i(I)&E.i(I);return new a(A,this.h&E.h)},t.or=function(E){const S=Math.max(this.g.length,E.g.length),A=[];for(let I=0;I<S;I++)A[I]=this.i(I)|E.i(I);return new a(A,this.h|E.h)},t.xor=function(E){const S=Math.max(this.g.length,E.g.length),A=[];for(let I=0;I<S;I++)A[I]=this.i(I)^E.i(I);return new a(A,this.h^E.h)};function U(E){const S=E.g.length+1,A=[];for(let I=0;I<S;I++)A[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(A,E.h)}function W(E,S){const A=S>>5;S%=32;const I=E.g.length-A,P=[];for(let V=0;V<I;V++)P[V]=S>0?E.i(V+A)>>>S|E.i(V+A+1)<<32-S:E.i(V+A);return new a(P,E.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,rE=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=f,Xi=a}).apply(typeof hv<"u"?hv:typeof self<"u"?self:typeof window<"u"?window:{});var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nE,rl,iE,Cc,Od,sE,aE,oE;(function(){var t,e=Object.defineProperty;function r(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof nc=="object"&&nc];for(var p=0;p<c.length;++p){var v=c[p];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var n=r(this);function i(c,p){if(p)e:{var v=n;c=c.split(".");for(var C=0;C<c.length-1;C++){var H=c[C];if(!(H in v))break e;v=v[H]}c=c[c.length-1],C=v[c],p=p(C),p!=C&&p!=null&&e(v,c,{configurable:!0,writable:!0,value:p})}}i("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(c){return c||function(p){var v=[],C;for(C in p)Object.prototype.hasOwnProperty.call(p,C)&&v.push([C,p[C]]);return v}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function o(c){var p=typeof c;return p=="object"&&c!=null||p=="function"}function l(c,p,v){return c.call.apply(c.bind,arguments)}function u(c,p,v){return u=l,u.apply(null,arguments)}function f(c,p){var v=Array.prototype.slice.call(arguments,1);return function(){var C=v.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function h(c,p){function v(){}v.prototype=p.prototype,c.Z=p.prototype,c.prototype=new v,c.prototype.constructor=c,c.Ob=function(C,H,Y){for(var he=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)he[Fe-2]=arguments[Fe];return p.prototype[H].apply(C,he)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){const p=c.length;if(p>0){const v=Array(p);for(let C=0;C<p;C++)v[C]=c[C];return v}return[]}function _(c,p){for(let C=1;C<arguments.length;C++){const H=arguments[C];var v=typeof H;if(v=v!="object"?v:H?Array.isArray(H)?"array":v:"null",v=="array"||v=="object"&&typeof H.length=="number"){v=c.length||0;const Y=H.length||0;c.length=v+Y;for(let he=0;he<Y;he++)c[v+he]=H[he]}else c.push(H)}}class m{constructor(p,v){this.i=p,this.j=v,this.h=0,this.g=null}get(){let p;return this.h>0?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function y(c){a.setTimeout(()=>{throw c},0)}function w(){var c=E;let p=null;return c.g&&(p=c.g,c.g=c.g.next,c.g||(c.h=null),p.next=null),p}class x{constructor(){this.h=this.g=null}add(p,v){const C=T.get();C.set(p,v),this.h?this.h.next=C:this.g=C,this.h=C}}var T=new m(()=>new O,c=>c.reset());class O{constructor(){this.next=this.g=this.h=null}set(p,v){this.h=p,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let U,W=!1,E=new x,S=()=>{const c=Promise.resolve(void 0);U=()=>{c.then(A)}};function A(){for(var c;c=w();){try{c.h.call(c.g)}catch(v){y(v)}var p=T;p.j(c),p.h<100&&(p.h++,c.next=p.g,p.g=c)}W=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(c,p){this.type=c,this.g=this.target=p,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,p=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};a.addEventListener("test",v,p),a.removeEventListener("test",v,p)}catch{}return c}();function N(c){return/^[\s\xa0]*$/.test(c)}function Ce(c,p){P.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,p)}h(Ce,P),Ce.prototype.init=function(c,p){const v=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=p,p=c.relatedTarget,p||(v=="mouseover"?p=c.fromElement:v=="mouseout"&&(p=c.toElement)),this.relatedTarget=p,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&Ce.Z.h.call(this)},Ce.prototype.h=function(){Ce.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ke="closure_listenable_"+(Math.random()*1e6|0),dt=0;function Ze(c,p,v,C,H){this.listener=c,this.proxy=null,this.src=p,this.type=v,this.capture=!!C,this.ha=H,this.key=++dt,this.da=this.fa=!1}function fe(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ye(c,p,v){for(const C in c)p.call(v,c[C],C,c)}function Se(c,p){for(const v in c)p.call(void 0,c[v],v,c)}function Oe(c){const p={};for(const v in c)p[v]=c[v];return p}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(c,p){let v,C;for(let H=1;H<arguments.length;H++){C=arguments[H];for(v in C)c[v]=C[v];for(let Y=0;Y<B.length;Y++)v=B[Y],Object.prototype.hasOwnProperty.call(C,v)&&(c[v]=C[v])}}function z(c){this.src=c,this.g={},this.h=0}z.prototype.add=function(c,p,v,C,H){const Y=c.toString();c=this.g[Y],c||(c=this.g[Y]=[],this.h++);const he=ee(c,p,C,H);return he>-1?(p=c[he],v||(p.fa=!1)):(p=new Ze(p,this.src,Y,!!C,H),p.fa=v,c.push(p)),p};function j(c,p){const v=p.type;if(v in c.g){var C=c.g[v],H=Array.prototype.indexOf.call(C,p,void 0),Y;(Y=H>=0)&&Array.prototype.splice.call(C,H,1),Y&&(fe(p),c.g[v].length==0&&(delete c.g[v],c.h--))}}function ee(c,p,v,C){for(let H=0;H<c.length;++H){const Y=c[H];if(!Y.da&&Y.listener==p&&Y.capture==!!v&&Y.ha==C)return H}return-1}var ge="closure_lm_"+(Math.random()*1e6|0),Te={};function Ee(c,p,v,C,H){if(Array.isArray(p)){for(let Y=0;Y<p.length;Y++)Ee(c,p[Y],v,C,H);return null}return v=_r(v),c&&c[ke]?c.J(p,v,o(C)?!!C.capture:!1,H):de(c,p,v,!1,C,H)}function de(c,p,v,C,H,Y){if(!p)throw Error("Invalid event type");const he=o(H)?!!H.capture:!!H;let Fe=tt(c);if(Fe||(c[ge]=Fe=new z(c)),v=Fe.add(p,v,C,he,Y),v.proxy)return v;if(C=Ge(),v.proxy=C,C.src=c,C.listener=v,c.addEventListener)V||(H=he),H===void 0&&(H=!1),c.addEventListener(p.toString(),C,H);else if(c.attachEvent)c.attachEvent(je(p.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Ge(){function c(v){return p.call(c.src,c.listener,v)}const p=ln;return c}function Me(c,p,v,C,H){if(Array.isArray(p))for(var Y=0;Y<p.length;Y++)Me(c,p[Y],v,C,H);else C=o(C)?!!C.capture:!!C,v=_r(v),c&&c[ke]?(c=c.i,Y=String(p).toString(),Y in c.g&&(p=c.g[Y],v=ee(p,v,C,H),v>-1&&(fe(p[v]),Array.prototype.splice.call(p,v,1),p.length==0&&(delete c.g[Y],c.h--)))):c&&(c=tt(c))&&(p=c.g[p.toString()],c=-1,p&&(c=ee(p,v,C,H)),(v=c>-1?p[c]:null)&&Ft(v))}function Ft(c){if(typeof c!="number"&&c&&!c.da){var p=c.src;if(p&&p[ke])j(p.i,c);else{var v=c.type,C=c.proxy;p.removeEventListener?p.removeEventListener(v,C,c.capture):p.detachEvent?p.detachEvent(je(v),C):p.addListener&&p.removeListener&&p.removeListener(C),(v=tt(p))?(j(v,c),v.h==0&&(v.src=null,p[ge]=null)):fe(c)}}}function je(c){return c in Te?Te[c]:Te[c]="on"+c}function ln(c,p){if(c.da)c=!0;else{p=new Ce(p,this);const v=c.listener,C=c.ha||c.src;c.fa&&Ft(c),c=v.call(C,p)}return c}function tt(c){return c=c[ge],c instanceof z?c:null}var _e="__closure_events_fn_"+(Math.random()*1e9>>>0);function _r(c){return typeof c=="function"?c:(c[_e]||(c[_e]=function(p){return c.handleEvent(p)}),c[_e])}function rt(){I.call(this),this.i=new z(this),this.M=this,this.G=null}h(rt,I),rt.prototype[ke]=!0,rt.prototype.removeEventListener=function(c,p,v,C){Me(this,c,p,v,C)};function pt(c,p){var v,C=c.G;if(C)for(v=[];C;C=C.G)v.push(C);if(c=c.M,C=p.type||p,typeof p=="string")p=new P(p,c);else if(p instanceof P)p.target=p.target||c;else{var H=p;p=new P(C,c),Q(p,H)}H=!0;let Y,he;if(v)for(he=v.length-1;he>=0;he--)Y=p.g=v[he],H=un(Y,C,!0,p)&&H;if(Y=p.g=c,H=un(Y,C,!0,p)&&H,H=un(Y,C,!1,p)&&H,v)for(he=0;he<v.length;he++)Y=p.g=v[he],H=un(Y,C,!1,p)&&H}rt.prototype.N=function(){if(rt.Z.N.call(this),this.i){var c=this.i;for(const p in c.g){const v=c.g[p];for(let C=0;C<v.length;C++)fe(v[C]);delete c.g[p],c.h--}}this.G=null},rt.prototype.J=function(c,p,v,C){return this.i.add(String(c),p,!1,v,C)},rt.prototype.K=function(c,p,v,C){return this.i.add(String(c),p,!0,v,C)};function un(c,p,v,C){if(p=c.i.g[String(p)],!p)return!0;p=p.concat();let H=!0;for(let Y=0;Y<p.length;++Y){const he=p[Y];if(he&&!he.da&&he.capture==v){const Fe=he.listener,Ot=he.ha||he.src;he.fa&&j(c.i,he),H=Fe.call(Ot,C)!==!1&&H}}return H&&!C.defaultPrevented}function Iu(c,p){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(p)>2147483647?-1:a.setTimeout(c,p||0)}function la(c){c.g=Iu(()=>{c.g=null,c.i&&(c.i=!1,la(c))},c.l);const p=c.h;c.h=null,c.m.apply(null,p)}class Xr extends I{constructor(p,v){super(),this.m=p,this.l=v,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:la(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function An(c){I.call(this),this.h=c,this.g={}}h(An,I);var ua=[];function ca(c){ye(c.g,function(p,v){this.g.hasOwnProperty(v)&&Ft(p)},c),c.g={}}An.prototype.N=function(){An.Z.N.call(this),ca(this)},An.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cn=a.JSON.stringify,Ih=a.JSON.parse,Cu=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Co(){}function Ro(){}var vi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function fa(){P.call(this,"d")}h(fa,P);function ha(){P.call(this,"c")}h(ha,P);var Wn={},Ru=null;function ms(){return Ru=Ru||new rt}Wn.Ia="serverreachability";function Po(c){P.call(this,Wn.Ia,c)}h(Po,P);function _i(c){const p=ms();pt(p,new Po(p))}Wn.STAT_EVENT="statevent";function Pu(c,p){P.call(this,Wn.STAT_EVENT,c),this.stat=p}h(Pu,P);function qt(c){const p=ms();pt(p,new Pu(p,c))}Wn.Ja="timingevent";function gs(c,p){P.call(this,Wn.Ja,c),this.size=p}h(gs,P);function vs(c,p){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},p)}function _s(){this.g=!0}_s.prototype.ua=function(){this.g=!1};function Ch(c,p,v,C,H,Y){c.info(function(){if(c.g)if(Y){var he="",Fe=Y.split("&");for(let et=0;et<Fe.length;et++){var Ot=Fe[et].split("=");if(Ot.length>1){const jt=Ot[0];Ot=Ot[1];const Cn=jt.split("_");he=Cn.length>=2&&Cn[1]=="type"?he+(jt+"="+Ot+"&"):he+(jt+"=redacted&")}}}else he=null;else he=Y;return"XMLHTTP REQ ("+C+") [attempt "+H+"]: "+p+`
`+v+`
`+he})}function Rh(c,p,v,C,H,Y,he){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+H+"]: "+p+`
`+v+`
`+Y+" "+he})}function xi(c,p,v,C){c.info(function(){return"XMLHTTP TEXT ("+p+"): "+Nh(c,v)+(C?" "+C:"")})}function Ph(c,p){c.info(function(){return"TIMEOUT: "+p})}_s.prototype.info=function(){};function Nh(c,p){if(!c.g)return p;if(!p)return null;try{const Y=JSON.parse(p);if(Y){for(c=0;c<Y.length;c++)if(Array.isArray(Y[c])){var v=Y[c];if(!(v.length<2)){var C=v[1];if(Array.isArray(C)&&!(C.length<1)){var H=C[0];if(H!="noop"&&H!="stop"&&H!="close")for(let he=1;he<C.length;he++)C[he]=""}}}}return cn(Y)}catch{return p}}var da={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Nu;function No(){}h(No,Co),No.prototype.g=function(){return new XMLHttpRequest},Nu=new No;function xs(c){return encodeURIComponent(String(c))}function k(c){var p=1;c=c.split(":");const v=[];for(;p>0&&c.length;)v.push(c.shift()),p--;return c.length&&v.push(c.join(":")),v}function D(c,p,v,C){this.j=c,this.i=p,this.l=v,this.S=C||1,this.V=new An(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new R}function R(){this.i=null,this.g="",this.h=!1}var F={},L={};function b(c,p,v){c.M=1,c.A=Fu(In(p)),c.u=v,c.R=!0,K(c,null)}function K(c,p){c.F=Date.now(),X(c),c.B=In(c.A);var v=c.B,C=c.S;Array.isArray(C)||(C=[String(C)]),lg(v.i,"t",C),c.C=0,v=c.j.L,c.h=new R,c.g=kg(c.j,v?p:null,!c.u),c.P>0&&(c.O=new Xr(u(c.Y,c,c.g),c.P)),p=c.V,v=c.g,C=c.ba;var H="readystatechange";Array.isArray(H)||(H&&(ua[0]=H.toString()),H=ua);for(let Y=0;Y<H.length;Y++){const he=Ee(v,H[Y],C||p.handleEvent,!1,p.h||p);if(!he)break;p.g[he.key]=he}p=c.J?Oe(c.J):{},c.u?(c.v||(c.v="POST"),p["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,p)):(c.v="GET",c.g.ea(c.B,c.v,null,p)),_i(),Ch(c.i,c.v,c.B,c.l,c.S,c.u)}D.prototype.ba=function(c){c=c.target;const p=this.O;p&&Ti(c)==3?p.j():this.Y(c)},D.prototype.Y=function(c){try{if(c==this.g)e:{const Fe=Ti(this.g),Ot=this.g.ya(),et=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||mg(this.g)))){this.K||Fe!=4||Ot==7||(Ot==8||et<=0?_i(3):_i(2)),ce(this);var p=this.g.ca();this.X=p;var v=Z(this);if(this.o=p==200,Rh(this.i,this.v,this.B,this.l,this.S,Fe,p),this.o){if(this.U&&!this.L){t:{if(this.g){var C,H=this.g;if((C=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(C)){var Y=C;break t}}Y=null}if(c=Y)xi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,pe(this,c);else{this.o=!1,this.m=3,qt(12),se(this),me(this);break e}}if(this.R){c=!0;let jt;for(;!this.K&&this.C<v.length;)if(jt=q(this,v),jt==L){Fe==4&&(this.m=4,qt(14),c=!1),xi(this.i,this.l,null,"[Incomplete Response]");break}else if(jt==F){this.m=4,qt(15),xi(this.i,this.l,v,"[Invalid Chunk]"),c=!1;break}else xi(this.i,this.l,jt,null),pe(this,jt);if(G(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||v.length!=0||this.h.h||(this.m=1,qt(16),c=!1),this.o=this.o&&c,!c)xi(this.i,this.l,v,"[Invalid Chunked Response]"),se(this),me(this);else if(v.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+v.length),bh(he),he.P=!0,qt(11))}}else xi(this.i,this.l,v,null),pe(this,v);Fe==4&&se(this),this.o&&!this.K&&(Fe==4?wg(this.j,this):(this.o=!1,X(this)))}else FS(this.g),p==400&&v.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),se(this),me(this)}}}catch{}finally{}};function Z(c){if(!G(c))return c.g.la();const p=mg(c.g);if(p==="")return"";let v="";const C=p.length,H=Ti(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return se(c),me(c),"";c.h.i=new a.TextDecoder}for(let Y=0;Y<C;Y++)c.h.h=!0,v+=c.h.i.decode(p[Y],{stream:!(H&&Y==C-1)});return p.length=0,c.h.g+=v,c.C=0,c.h.g}function G(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function q(c,p){var v=c.C,C=p.indexOf(`
`,v);return C==-1?L:(v=Number(p.substring(v,C)),isNaN(v)?F:(C+=1,C+v>p.length?L:(p=p.slice(C,C+v),c.C=C+v,p)))}D.prototype.cancel=function(){this.K=!0,se(this)};function X(c){c.T=Date.now()+c.H,ie(c,c.H)}function ie(c,p){if(c.D!=null)throw Error("WatchDog timer not null");c.D=vs(u(c.aa,c),p)}function ce(c){c.D&&(a.clearTimeout(c.D),c.D=null)}D.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(Ph(this.i,this.B),this.M!=2&&(_i(),qt(17)),se(this),this.m=2,me(this)):ie(this,this.T-c)};function me(c){c.j.I==0||c.K||wg(c.j,c)}function se(c){ce(c);var p=c.O;p&&typeof p.dispose=="function"&&p.dispose(),c.O=null,ca(c.V),c.g&&(p=c.g,c.g=null,p.abort(),p.dispose())}function pe(c,p){try{var v=c.j;if(v.I!=0&&(v.g==c||Gn(v.h,c))){if(!c.L&&Gn(v.h,c)&&v.I==3){try{var C=v.Ba.g.parse(p)}catch{C=null}if(Array.isArray(C)&&C.length==3){var H=C;if(H[0]==0){e:if(!v.v){if(v.g)if(v.g.F+3e3<c.F)bu(v),Lu(v);else break e;Mh(v),qt(18)}}else v.xa=H[1],0<v.xa-v.K&&H[2]<37500&&v.F&&v.A==0&&!v.C&&(v.C=vs(u(v.Va,v),6e3));Dt(v.h)<=1&&v.ta&&(v.ta=void 0)}else Es(v,11)}else if((c.L||v.g==c)&&bu(v),!N(p))for(H=v.Ba.g.parse(p),p=0;p<H.length;p++){let et=H[p];const jt=et[0];if(!(jt<=v.K))if(v.K=jt,et=et[1],v.I==2)if(et[0]=="c"){v.M=et[1],v.ba=et[2];const Cn=et[3];Cn!=null&&(v.ka=Cn,v.j.info("VER="+v.ka));const ws=et[4];ws!=null&&(v.za=ws,v.j.info("SVER="+v.za));const Si=et[5];Si!=null&&typeof Si=="number"&&Si>0&&(C=1.5*Si,v.O=C,v.j.info("backChannelRequestTimeoutMs_="+C)),C=v;const Ai=c.g;if(Ai){const Bu=Ai.g?Ai.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bu){var Y=C.h;Y.g||Bu.indexOf("spdy")==-1&&Bu.indexOf("quic")==-1&&Bu.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(Kn(Y,Y.h),Y.h=null))}if(C.G){const Vh=Ai.g?Ai.g.getResponseHeader("X-HTTP-Session-Id"):null;Vh&&(C.wa=Vh,at(C.J,C.G,Vh))}}v.I=3,v.l&&v.l.ra(),v.aa&&(v.T=Date.now()-c.F,v.j.info("Handshake RTT: "+v.T+"ms")),C=v;var he=c;if(C.na=Ag(C,C.L?C.ba:null,C.W),he.L){yi(C.h,he);var Fe=he,Ot=C.O;Ot&&(Fe.H=Ot),Fe.D&&(ce(Fe),X(Fe)),C.g=he}else yg(C);v.i.length>0&&Mu(v)}else et[0]!="stop"&&et[0]!="close"||Es(v,7);else v.I==3&&(et[0]=="stop"||et[0]=="close"?et[0]=="stop"?Es(v,7):Lh(v):et[0]!="noop"&&v.l&&v.l.qa(et),v.A=0)}}_i(4)}catch{}}var Re=class{constructor(c,p){this.g=c,this.map=p}};function nt(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function it(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Dt(c){return c.h?1:c.g?c.g.size:0}function Gn(c,p){return c.h?c.h==p:c.g?c.g.has(p):!1}function Kn(c,p){c.g?c.g.add(p):c.h=p}function yi(c,p){c.h&&c.h==p?c.h=null:c.g&&c.g.has(p)&&c.g.delete(p)}nt.prototype.cancel=function(){if(this.i=kn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function kn(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let p=c.i;for(const v of c.g.values())p=p.concat(v.G);return p}return g(c.i)}var ma=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fn(c,p){if(c){c=c.split("&");for(let v=0;v<c.length;v++){const C=c[v].indexOf("=");let H,Y=null;C>=0?(H=c[v].substring(0,C),Y=c[v].substring(C+1)):H=c[v],p(H,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Ei(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let p;c instanceof Ei?(this.l=c.l,Fo(this,c.j),this.o=c.o,this.g=c.g,Do(this,c.u),this.h=c.h,Fh(this,ug(c.i)),this.m=c.m):c&&(p=String(c).match(ma))?(this.l=!1,Fo(this,p[1]||"",!0),this.o=Oo(p[2]||""),this.g=Oo(p[3]||"",!0),Do(this,p[4]),this.h=Oo(p[5]||"",!0),Fh(this,p[6]||"",!0),this.m=Oo(p[7]||"")):(this.l=!1,this.i=new Mo(null,this.l))}Ei.prototype.toString=function(){const c=[];var p=this.j;p&&c.push(Lo(p,ig,!0),":");var v=this.g;return(v||p=="file")&&(c.push("//"),(p=this.o)&&c.push(Lo(p,ig,!0),"@"),c.push(xs(v).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.u,v!=null&&c.push(":",String(v))),(v=this.h)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(Lo(v,v.charAt(0)=="/"?TS:wS,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",Lo(v,AS)),c.join("")},Ei.prototype.resolve=function(c){const p=In(this);let v=!!c.j;v?Fo(p,c.j):v=!!c.o,v?p.o=c.o:v=!!c.g,v?p.g=c.g:v=c.u!=null;var C=c.h;if(v)Do(p,c.u);else if(v=!!c.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var H=p.h.lastIndexOf("/");H!=-1&&(C=p.h.slice(0,H+1)+C)}if(H=C,H==".."||H==".")C="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){C=H.lastIndexOf("/",0)==0,H=H.split("/");const Y=[];for(let he=0;he<H.length;){const Fe=H[he++];Fe=="."?C&&he==H.length&&Y.push(""):Fe==".."?((Y.length>1||Y.length==1&&Y[0]!="")&&Y.pop(),C&&he==H.length&&Y.push("")):(Y.push(Fe),C=!0)}C=Y.join("/")}else C=H}return v?p.h=C:v=c.i.toString()!=="",v?Fh(p,ug(c.i)):v=!!c.m,v&&(p.m=c.m),p};function In(c){return new Ei(c)}function Fo(c,p,v){c.j=v?Oo(p,!0):p,c.j&&(c.j=c.j.replace(/:$/,""))}function Do(c,p){if(p){if(p=Number(p),isNaN(p)||p<0)throw Error("Bad port number "+p);c.u=p}else c.u=null}function Fh(c,p,v){p instanceof Mo?(c.i=p,kS(c.i,c.l)):(v||(p=Lo(p,SS)),c.i=new Mo(p,c.l))}function at(c,p,v){c.i.set(p,v)}function Fu(c){return at(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Oo(c,p){return c?p?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Lo(c,p,v){return typeof c=="string"?(c=encodeURI(c).replace(p,ES),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function ES(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ig=/[#\/\?@]/g,wS=/[#\?:]/g,TS=/[#\?]/g,SS=/[#\?@]/g,AS=/#/g;function Mo(c,p){this.h=this.g=null,this.i=c||null,this.j=!!p}function ys(c){c.g||(c.g=new Map,c.h=0,c.i&&fn(c.i,function(p,v){c.add(decodeURIComponent(p.replace(/\+/g," ")),v)}))}t=Mo.prototype,t.add=function(c,p){ys(this),this.i=null,c=ga(this,c);let v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(p),this.h+=1,this};function sg(c,p){ys(c),p=ga(c,p),c.g.has(p)&&(c.i=null,c.h-=c.g.get(p).length,c.g.delete(p))}function ag(c,p){return ys(c),p=ga(c,p),c.g.has(p)}t.forEach=function(c,p){ys(this),this.g.forEach(function(v,C){v.forEach(function(H){c.call(p,H,C,this)},this)},this)};function og(c,p){ys(c);let v=[];if(typeof p=="string")ag(c,p)&&(v=v.concat(c.g.get(ga(c,p))));else for(c=Array.from(c.g.values()),p=0;p<c.length;p++)v=v.concat(c[p]);return v}t.set=function(c,p){return ys(this),this.i=null,c=ga(this,c),ag(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[p]),this.h+=1,this},t.get=function(c,p){return c?(c=og(this,c),c.length>0?String(c[0]):p):p};function lg(c,p,v){sg(c,p),v.length>0&&(c.i=null,c.g.set(ga(c,p),g(v)),c.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],p=Array.from(this.g.keys());for(let C=0;C<p.length;C++){var v=p[C];const H=xs(v);v=og(this,v);for(let Y=0;Y<v.length;Y++){let he=H;v[Y]!==""&&(he+="="+xs(v[Y])),c.push(he)}}return this.i=c.join("&")};function ug(c){const p=new Mo;return p.i=c.i,c.g&&(p.g=new Map(c.g),p.h=c.h),p}function ga(c,p){return p=String(p),c.j&&(p=p.toLowerCase()),p}function kS(c,p){p&&!c.j&&(ys(c),c.i=null,c.g.forEach(function(v,C){const H=C.toLowerCase();C!=H&&(sg(this,C),lg(this,H,v))},c)),c.j=p}function IS(c,p){const v=new _s;if(a.Image){const C=new Image;C.onload=f(wi,v,"TestLoadImage: loaded",!0,p,C),C.onerror=f(wi,v,"TestLoadImage: error",!1,p,C),C.onabort=f(wi,v,"TestLoadImage: abort",!1,p,C),C.ontimeout=f(wi,v,"TestLoadImage: timeout",!1,p,C),a.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else p(!1)}function CS(c,p){const v=new _s,C=new AbortController,H=setTimeout(()=>{C.abort(),wi(v,"TestPingServer: timeout",!1,p)},1e4);fetch(c,{signal:C.signal}).then(Y=>{clearTimeout(H),Y.ok?wi(v,"TestPingServer: ok",!0,p):wi(v,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(H),wi(v,"TestPingServer: error",!1,p)})}function wi(c,p,v,C,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),C(v)}catch{}}function RS(){this.g=new Cu}function Dh(c){this.i=c.Sb||null,this.h=c.ab||!1}h(Dh,Co),Dh.prototype.g=function(){return new Du(this.i,this.h)};function Du(c,p){rt.call(this),this.H=c,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Du,rt),t=Du.prototype,t.open=function(c,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=p,this.readyState=1,Vo(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const p={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(p.body=c),(this.H||a).fetch(new Request(this.D,p)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,bo(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Vo(this)),this.g&&(this.readyState=3,Vo(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;cg(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function cg(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var p=c.value?c.value:new Uint8Array(0);(p=this.B.decode(p,{stream:!c.done}))&&(this.response=this.responseText+=p)}c.done?bo(this):Vo(this),this.readyState==3&&cg(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,bo(this))},t.Na=function(c){this.g&&(this.response=c,bo(this))},t.ga=function(){this.g&&bo(this)};function bo(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Vo(c)}t.setRequestHeader=function(c,p){this.A.append(c,p)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],p=this.h.entries();for(var v=p.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=p.next();return c.join(`\r
`)};function Vo(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Du.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function fg(c){let p="";return ye(c,function(v,C){p+=C,p+=":",p+=v,p+=`\r
`}),p}function Oh(c,p,v){e:{for(C in v){var C=!1;break e}C=!0}C||(v=fg(v),typeof c=="string"?v!=null&&xs(v):at(c,p,v))}function xt(c){rt.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(xt,rt);var PS=/^https?$/i,NS=["POST","PUT"];t=xt.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,p,v,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);p=p?p.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Nu.g(),this.g.onreadystatechange=d(u(this.Ca,this));try{this.B=!0,this.g.open(p,String(c),!0),this.B=!1}catch(Y){hg(this,Y);return}if(c=v||"",v=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var H in C)v.set(H,C[H]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const Y of C.keys())v.set(Y,C.get(Y));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(v.keys()).find(Y=>Y.toLowerCase()=="content-type"),H=a.FormData&&c instanceof a.FormData,!(Array.prototype.indexOf.call(NS,p,void 0)>=0)||C||H||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,he]of v)this.g.setRequestHeader(Y,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(Y){hg(this,Y)}};function hg(c,p){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=p,c.o=5,dg(c),Ou(c)}function dg(c){c.A||(c.A=!0,pt(c,"complete"),pt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,pt(this,"complete"),pt(this,"abort"),Ou(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ou(this,!0)),xt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?pg(this):this.Xa())},t.Xa=function(){pg(this)};function pg(c){if(c.h&&typeof s<"u"){if(c.v&&Ti(c)==4)setTimeout(c.Ca.bind(c),0);else if(pt(c,"readystatechange"),Ti(c)==4){c.h=!1;try{const Y=c.ca();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var v;if(!(v=p)){var C;if(C=Y===0){let he=String(c.D).match(ma)[1]||null;!he&&a.self&&a.self.location&&(he=a.self.location.protocol.slice(0,-1)),C=!PS.test(he?he.toLowerCase():"")}v=C}if(v)pt(c,"complete"),pt(c,"success");else{c.o=6;try{var H=Ti(c)>2?c.g.statusText:""}catch{H=""}c.l=H+" ["+c.ca()+"]",dg(c)}}finally{Ou(c)}}}}function Ou(c,p){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const v=c.g;c.g=null,p||pt(c,"ready");try{v.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ti(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Ti(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var p=this.g.responseText;return c&&p.indexOf(c)==0&&(p=p.substring(c.length)),Ih(p)}};function mg(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function FS(c){const p={};c=(c.g&&Ti(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(N(c[C]))continue;var v=k(c[C]);const H=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Y=p[H]||[];p[H]=Y,Y.push(v)}Se(p,function(C){return C.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bo(c,p,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||p}function gg(c){this.za=0,this.i=[],this.j=new _s,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bo("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bo("baseRetryDelayMs",5e3,c),this.Za=Bo("retryDelaySeedMs",1e4,c),this.Ta=Bo("forwardChannelMaxRetries",2,c),this.va=Bo("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new nt(c&&c.concurrentRequestLimit),this.Ba=new RS,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=gg.prototype,t.ka=8,t.I=1,t.connect=function(c,p,v,C){qt(0),this.W=c,this.H=p||{},v&&C!==void 0&&(this.H.OSID=v,this.H.OAID=C),this.F=this.X,this.J=Ag(this,null,this.W),Mu(this)};function Lh(c){if(vg(c),c.I==3){var p=c.V++,v=In(c.J);if(at(v,"SID",c.M),at(v,"RID",p),at(v,"TYPE","terminate"),Uo(c,v),p=new D(c,c.j,p),p.M=2,p.A=Fu(In(v)),v=!1,a.navigator&&a.navigator.sendBeacon)try{v=a.navigator.sendBeacon(p.A.toString(),"")}catch{}!v&&a.Image&&(new Image().src=p.A,v=!0),v||(p.g=kg(p.j,null),p.g.ea(p.A)),p.F=Date.now(),X(p)}Sg(c)}function Lu(c){c.g&&(bh(c),c.g.cancel(),c.g=null)}function vg(c){Lu(c),c.v&&(a.clearTimeout(c.v),c.v=null),bu(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&a.clearTimeout(c.m),c.m=null)}function Mu(c){if(!it(c.h)&&!c.m){c.m=!0;var p=c.Ea;U||S(),W||(U(),W=!0),E.add(p,c),c.D=0}}function DS(c,p){return Dt(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=p.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=vs(u(c.Ea,c,p),Tg(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const H=new D(this,this.j,c);let Y=this.o;if(this.U&&(Y?(Y=Oe(Y),Q(Y,this.U)):Y=this.U),this.u!==null||this.R||(H.J=Y,Y=null),this.S)e:{for(var p=0,v=0;v<this.i.length;v++){t:{var C=this.i[v];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(p+=C,p>4096){p=v;break e}if(p===4096||v===this.i.length-1){p=v+1;break e}}p=1e3}else p=1e3;p=xg(this,H,p),v=In(this.J),at(v,"RID",c),at(v,"CVER",22),this.G&&at(v,"X-HTTP-Session-Id",this.G),Uo(this,v),Y&&(this.R?p="headers="+xs(fg(Y))+"&"+p:this.u&&Oh(v,this.u,Y)),Kn(this.h,H),this.Ra&&at(v,"TYPE","init"),this.S?(at(v,"$req",p),at(v,"SID","null"),H.U=!0,b(H,v,null)):b(H,v,p),this.I=2}}else this.I==3&&(c?_g(this,c):this.i.length==0||it(this.h)||_g(this))};function _g(c,p){var v;p?v=p.l:v=c.V++;const C=In(c.J);at(C,"SID",c.M),at(C,"RID",v),at(C,"AID",c.K),Uo(c,C),c.u&&c.o&&Oh(C,c.u,c.o),v=new D(c,c.j,v,c.D+1),c.u===null&&(v.J=c.o),p&&(c.i=p.G.concat(c.i)),p=xg(c,v,1e3),v.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),Kn(c.h,v),b(v,C,p)}function Uo(c,p){c.H&&ye(c.H,function(v,C){at(p,C,v)}),c.l&&ye({},function(v,C){at(p,C,v)})}function xg(c,p,v){v=Math.min(c.i.length,v);const C=c.l?u(c.l.Ka,c.l,c):null;e:{var H=c.i;let Fe=-1;for(;;){const Ot=["count="+v];Fe==-1?v>0?(Fe=H[0].g,Ot.push("ofs="+Fe)):Fe=0:Ot.push("ofs="+Fe);let et=!0;for(let jt=0;jt<v;jt++){var Y=H[jt].g;const Cn=H[jt].map;if(Y-=Fe,Y<0)Fe=Math.max(0,H[jt].g-100),et=!1;else try{Y="req"+Y+"_"||"";try{var he=Cn instanceof Map?Cn:Object.entries(Cn);for(const[ws,Si]of he){let Ai=Si;o(Si)&&(Ai=cn(Si)),Ot.push(Y+ws+"="+encodeURIComponent(Ai))}}catch(ws){throw Ot.push(Y+"type="+encodeURIComponent("_badmap")),ws}}catch{C&&C(Cn)}}if(et){he=Ot.join("&");break e}}he=void 0}return c=c.i.splice(0,v),p.G=c,he}function yg(c){if(!c.g&&!c.v){c.Y=1;var p=c.Da;U||S(),W||(U(),W=!0),E.add(p,c),c.A=0}}function Mh(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=vs(u(c.Da,c),Tg(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,Eg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=vs(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),Lu(this),Eg(this))};function bh(c){c.B!=null&&(a.clearTimeout(c.B),c.B=null)}function Eg(c){c.g=new D(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var p=In(c.na);at(p,"RID","rpc"),at(p,"SID",c.M),at(p,"AID",c.K),at(p,"CI",c.F?"0":"1"),!c.F&&c.ia&&at(p,"TO",c.ia),at(p,"TYPE","xmlhttp"),Uo(c,p),c.u&&c.o&&Oh(p,c.u,c.o),c.O&&(c.g.H=c.O);var v=c.g;c=c.ba,v.M=1,v.A=Fu(In(p)),v.u=null,v.R=!0,K(v,c)}t.Va=function(){this.C!=null&&(this.C=null,Lu(this),Mh(this),qt(19))};function bu(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function wg(c,p){var v=null;if(c.g==p){bu(c),bh(c),c.g=null;var C=2}else if(Gn(c.h,p))v=p.G,yi(c.h,p),C=1;else return;if(c.I!=0){if(p.o)if(C==1){v=p.u?p.u.length:0,p=Date.now()-p.F;var H=c.D;C=ms(),pt(C,new gs(C,v)),Mu(c)}else yg(c);else if(H=p.m,H==3||H==0&&p.X>0||!(C==1&&DS(c,p)||C==2&&Mh(c)))switch(v&&v.length>0&&(p=c.h,p.i=p.i.concat(v)),H){case 1:Es(c,5);break;case 4:Es(c,10);break;case 3:Es(c,6);break;default:Es(c,2)}}}function Tg(c,p){let v=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(v*=2),v*p}function Es(c,p){if(c.j.info("Error code "+p),p==2){var v=u(c.bb,c),C=c.Ua;const H=!C;C=new Ei(C||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Fo(C,"https"),Fu(C),H?IS(C.toString(),v):CS(C.toString(),v)}else qt(2);c.I=0,c.l&&c.l.pa(p),Sg(c),vg(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function Sg(c){if(c.I=0,c.ja=[],c.l){const p=kn(c.h);(p.length!=0||c.i.length!=0)&&(_(c.ja,p),_(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function Ag(c,p,v){var C=v instanceof Ei?In(v):new Ei(v);if(C.g!="")p&&(C.g=p+"."+C.g),Do(C,C.u);else{var H=a.location;C=H.protocol,p=p?p+"."+H.hostname:H.hostname,H=+H.port;const Y=new Ei(null);C&&Fo(Y,C),p&&(Y.g=p),H&&Do(Y,H),v&&(Y.h=v),C=Y}return v=c.G,p=c.wa,v&&p&&at(C,v,p),at(C,"VER",c.ka),Uo(c,C),C}function kg(c,p,v){if(p&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return p=c.Aa&&!c.ma?new xt(new Dh({ab:v})):new xt(c.ma),p.Fa(c.L),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ig(){}t=Ig.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Vu(){}Vu.prototype.g=function(c,p){return new Mr(c,p)};function Mr(c,p){rt.call(this),this.g=new gg(p),this.l=c,this.h=p&&p.messageUrlParams||null,c=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(c?c["X-WebChannel-Content-Type"]=p.messageContentType:c={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.sa&&(c?c["X-WebChannel-Client-Profile"]=p.sa:c={"X-WebChannel-Client-Profile":p.sa}),this.g.U=c,(c=p&&p.Qb)&&!N(c)&&(this.g.u=c),this.A=p&&p.supportsCrossDomainXhr||!1,this.v=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!N(p)&&(this.g.G=p,c=this.h,c!==null&&p in c&&(c=this.h,p in c&&delete c[p])),this.j=new va(this)}h(Mr,rt),Mr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Mr.prototype.close=function(){Lh(this.g)},Mr.prototype.o=function(c){var p=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.v&&(v={},v.__data__=cn(c),c=v);p.i.push(new Re(p.Ya++,c)),p.I==3&&Mu(p)},Mr.prototype.N=function(){this.g.l=null,delete this.j,Lh(this.g),delete this.g,Mr.Z.N.call(this)};function Cg(c){fa.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var p=c.__sm__;if(p){e:{for(const v in p){c=v;break e}c=void 0}(this.i=c)&&(c=this.i,p=p!==null&&c in p?p[c]:void 0),this.data=p}else this.data=c}h(Cg,fa);function Rg(){ha.call(this),this.status=1}h(Rg,ha);function va(c){this.g=c}h(va,Ig),va.prototype.ra=function(){pt(this.g,"a")},va.prototype.qa=function(c){pt(this.g,new Cg(c))},va.prototype.pa=function(c){pt(this.g,new Rg)},va.prototype.oa=function(){pt(this.g,"b")},Vu.prototype.createWebChannel=Vu.prototype.g,Mr.prototype.send=Mr.prototype.o,Mr.prototype.open=Mr.prototype.m,Mr.prototype.close=Mr.prototype.close,oE=function(){return new Vu},aE=function(){return ms()},sE=Wn,Od={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},da.NO_ERROR=0,da.TIMEOUT=8,da.HTTP_ERROR=6,Cc=da,pa.COMPLETE="complete",iE=pa,Ro.EventType=vi,vi.OPEN="a",vi.CLOSE="b",vi.ERROR="c",vi.MESSAGE="d",rt.prototype.listen=rt.prototype.J,rl=Ro,xt.prototype.listenOnce=xt.prototype.K,xt.prototype.getLastError=xt.prototype.Ha,xt.prototype.getLastErrorCode=xt.prototype.ya,xt.prototype.getStatus=xt.prototype.ca,xt.prototype.getResponseJson=xt.prototype.La,xt.prototype.getResponseText=xt.prototype.la,xt.prototype.send=xt.prototype.ea,xt.prototype.setWithCredentials=xt.prototype.Fa,nE=xt}).apply(typeof nc<"u"?nc:typeof self<"u"?self:typeof window<"u"?window:{});const dv="@firebase/firestore",pv="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hr.UNAUTHENTICATED=new hr(null),hr.GOOGLE_CREDENTIALS=new hr("google-credentials-uid"),hr.FIRST_PARTY=new hr("first-party-uid"),hr.MOCK_USER=new hr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yo="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=new tm("@firebase/firestore");function Ta(){return Ws.logLevel}function ve(t,...e){if(Ws.logLevel<=Ue.DEBUG){const r=e.map(lm);Ws.debug(`Firestore (${yo}): ${t}`,...r)}}function ci(t,...e){if(Ws.logLevel<=Ue.ERROR){const r=e.map(lm);Ws.error(`Firestore (${yo}): ${t}`,...r)}}function oo(t,...e){if(Ws.logLevel<=Ue.WARN){const r=e.map(lm);Ws.warn(`Firestore (${yo}): ${t}`,...r)}}function lm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,lE(t,n,r)}function lE(t,e,r){let n=`FIRESTORE (${yo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ci(n),new Error(n)}function We(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||lE(e,i,n)}function Ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends ds{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _R{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(hr.UNAUTHENTICATED))}shutdown(){}}class xR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class yR{constructor(e){this.t=e,this.currentUser=hr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){We(this.o===void 0,42304);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Zn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Zn)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(We(typeof n.accessToken=="string",31837,{l:n}),new uE(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return We(e===null||typeof e=="string",2055,{h:e}),new hr(e)}}class ER{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=hr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wR{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new ER(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(hr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class TR{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bC(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){We(this.o===void 0,3512);const n=s=>{s.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,ve("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new mv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(We(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new mv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=SR(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%62))}return n}}function be(t,e){return t<e?-1:t>e?1:0}function Ld(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),s=e.charAt(n);if(i!==s)return x0(i)===x0(s)?be(i,s):x0(i)?1:-1}return be(t.length,e.length)}const AR=55296,kR=57343;function x0(t){const e=t.charCodeAt(0);return e>=AR&&e<=kR}function lo(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="__name__";class Dn{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ie(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ie(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Dn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Dn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=Dn.compareSegments(e.get(i),r.get(i));if(s!==0)return s}return be(e.length,r.length)}static compareSegments(e,r){const n=Dn.isNumericId(e),i=Dn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Dn.extractNumericId(e).compare(Dn.extractNumericId(r)):Ld(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class lt extends Dn{construct(e,r,n){return new lt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new we(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new lt(r)}static emptyPath(){return new lt([])}}const IR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class er extends Dn{construct(e,r,n){return new er(e,r,n)}static isValidIdentifier(e){return IR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),er.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gv}static keyField(){return new er([gv])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new we(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new we(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new we(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new we(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new er(r)}static emptyPath(){return new er([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(lt.fromString(e))}static fromName(e){return new Ae(lt.fromString(e).popFirst(5))}static empty(){return new Ae(lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&lt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return lt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new lt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cE(t,e,r){if(!r)throw new we(ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function CR(t,e,r,n){if(e===!0&&n===!0)throw new we(ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function vv(t){if(!Ae.isDocumentKey(t))throw new we(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _v(t){if(Ae.isDocumentKey(t))throw new we(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function cm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ie(12329,{type:typeof t})}function Gs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=cm(t);throw new we(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t,e){const r={typeString:t};return e&&(r.value=e),r}function gu(t,e){if(!fE(t))throw new we(ne.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){r=`Expected '${n}' field to equal '${s.value}'`;break}}if(r)throw new we(ne.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=-62135596800,yv=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(e){return ut.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*yv);return new ut(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new we(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new we(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<xv)throw new we(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yv}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gu(e,ut._jsonSchema))return new ut(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:Rt("string",ut._jsonSchemaVersion),seconds:Rt("number"),nanoseconds:Rt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new ut(0,0))}static max(){return new Pe(new ut(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=-1;function RR(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Pe.fromTimestamp(n===1e9?new ut(r+1,0):new ut(r,n));return new es(i,Ae.empty(),e)}function PR(t){return new es(t.readTime,t.key,Xl)}class es{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new es(Pe.min(),Ae.empty(),Xl)}static max(){return new es(Pe.max(),Ae.empty(),Xl)}}function NR(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ae.comparator(t.documentKey,e.documentKey),r!==0?r:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eo(t){if(t.code!==ne.FAILED_PRECONDITION||t.message!==FR)throw t;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new te((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof te?r:te.resolve(r)}catch(r){return te.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):te.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):te.reject(r)}static resolve(e){return new te((r,n)=>{r(e)})}static reject(e){return new te((r,n)=>{n(e)})}static waitFor(e){return new te((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=te.resolve(!1);for(const n of e)r=r.next(i=>i?te.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new te((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;r(e[u]).next(f=>{a[u]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new te((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function OR(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function wo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm=-1;function ih(t){return t==null}function cf(t){return t===0&&1/t==-1/0}function LR(t){return typeof t=="number"&&Number.isInteger(t)&&!cf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE="";function MR(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Ev(e)),e=bR(t.get(r),e);return Ev(e)}function bR(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const s=t.charAt(i);switch(s){case"\0":r+="";break;case hE:r+="";break;default:r+=s}}return r}function Ev(t){return t+hE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Zs(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function dE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,r){this.comparator=e,this.root=r||Zt.EMPTY}insert(e,r){return new _t(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Zt.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ic(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ic(this.root,e,this.comparator,!1)}getReverseIterator(){return new ic(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ic(this.root,e,this.comparator,!0)}}class ic{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zt{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Zt.RED,this.left=i??Zt.EMPTY,this.right=s??Zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Zt(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Zt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ie(27949);return e+(this.isRed()?0:1)}}Zt.EMPTY=null,Zt.RED=!0,Zt.BLACK=!1;Zt.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie(57766)}get value(){throw Ie(16141)}get color(){throw Ie(16727)}get left(){throw Ie(29726)}get right(){throw Ie(36894)}copy(e,r,n,i,s){return this}insert(e,r,n){return new Zt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Tv(this.data.getIterator())}getIteratorFrom(e){return new Tv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ut)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ut(this.comparator);return r.data=e,r}}class Tv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.fields=e,e.sort(er.comparator)}static empty(){return new xn([])}unionWith(e){let r=new Ut(er.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new xn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return lo(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pE("Invalid base64 string: "+s):s}}(e);return new ar(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new ar(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ar.EMPTY_BYTE_STRING=new ar("");const VR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ts(t){if(We(!!t,39018),typeof t=="string"){let e=0;const r=VR.exec(t);if(We(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Tt(t.seconds),nanos:Tt(t.nanos)}}function Tt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function rs(t){return typeof t=="string"?ar.fromBase64String(t):ar.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="server_timestamp",gE="__type__",vE="__previous_value__",_E="__local_write_time__";function hm(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[gE])==null?void 0:n.stringValue)===mE}function sh(t){const e=t.mapValue.fields[vE];return hm(e)?sh(e):e}function Ql(t){const e=ts(t.mapValue.fields[_E].timestampValue);return new ut(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,r,n,i,s,a,o,l,u,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=f}}const ff="(default)";class Yl{constructor(e,r){this.projectId=e,this.database=r||ff}static empty(){return new Yl("","")}get isDefaultDatabase(){return this.database===ff}isEqual(e){return e instanceof Yl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE="__type__",UR="__max__",sc={mapValue:{}},yE="__vector__",hf="value";function ns(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?hm(t)?4:zR(t)?9007199254740991:jR(t)?10:11:Ie(28295,{value:t})}function zn(t,e){if(t===e)return!0;const r=ns(t);if(r!==ns(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ql(t).isEqual(Ql(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ts(i.timestampValue),o=ts(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return rs(i.bytesValue).isEqual(rs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Tt(i.geoPointValue.latitude)===Tt(s.geoPointValue.latitude)&&Tt(i.geoPointValue.longitude)===Tt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Tt(i.integerValue)===Tt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Tt(i.doubleValue),o=Tt(s.doubleValue);return a===o?cf(a)===cf(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return lo(t.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(wv(a)!==wv(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!zn(a[l],o[l])))return!1;return!0}(t,e);default:return Ie(52216,{left:t})}}function Jl(t,e){return(t.values||[]).find(r=>zn(r,e))!==void 0}function uo(t,e){if(t===e)return 0;const r=ns(t),n=ns(e);if(r!==n)return be(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Tt(s.integerValue||s.doubleValue),l=Tt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return Sv(t.timestampValue,e.timestampValue);case 4:return Sv(Ql(t),Ql(e));case 5:return Ld(t.stringValue,e.stringValue);case 6:return function(s,a){const o=rs(s),l=rs(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=be(o[u],l[u]);if(f!==0)return f}return be(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=be(Tt(s.latitude),Tt(a.latitude));return o!==0?o:be(Tt(s.longitude),Tt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Av(t.arrayValue,e.arrayValue);case 10:return function(s,a){var d,g,_,m;const o=s.fields||{},l=a.fields||{},u=(d=o[hf])==null?void 0:d.arrayValue,f=(g=l[hf])==null?void 0:g.arrayValue,h=be(((_=u==null?void 0:u.values)==null?void 0:_.length)||0,((m=f==null?void 0:f.values)==null?void 0:m.length)||0);return h!==0?h:Av(u,f)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===sc.mapValue&&a===sc.mapValue)return 0;if(s===sc.mapValue)return 1;if(a===sc.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=Ld(l[h],f[h]);if(d!==0)return d;const g=uo(o[l[h]],u[f[h]]);if(g!==0)return g}return be(l.length,f.length)}(t.mapValue,e.mapValue);default:throw Ie(23264,{he:r})}}function Sv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const r=ts(t),n=ts(e),i=be(r.seconds,n.seconds);return i!==0?i:be(r.nanos,n.nanos)}function Av(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=uo(r[i],n[i]);if(s)return s}return be(r.length,n.length)}function co(t){return Md(t)}function Md(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ts(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return rs(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ae.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=Md(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Md(r.fields[a])}`;return i+"}"}(t.mapValue):Ie(61005,{value:t})}function Rc(t){switch(ns(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sh(t);return e?16+Rc(e):16;case 5:return 2*t.stringValue.length;case 6:return rs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+Rc(s),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Zs(n.fields,(s,a)=>{i+=s.length+Rc(a)}),i}(t.mapValue);default:throw Ie(13486,{value:t})}}function bd(t){return!!t&&"integerValue"in t}function dm(t){return!!t&&"arrayValue"in t}function kv(t){return!!t&&"nullValue"in t}function Iv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pc(t){return!!t&&"mapValue"in t}function jR(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[xE])==null?void 0:n.stringValue)===yE}function _l(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Zs(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=_l(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=_l(t.arrayValue.values[r]);return e}return{...t}}function zR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===UR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.value=e}static empty(){return new en({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Pc(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=_l(r)}setAll(e){let r=er.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=_l(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Pc(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return zn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Pc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Zs(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new en(_l(this.value))}}function EE(t){const e=[];return Zs(t.fields,(r,n)=>{const i=new er([r]);if(Pc(n)){const s=EE(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new pr(e,0,Pe.min(),Pe.min(),Pe.min(),en.empty(),0)}static newFoundDocument(e,r,n,i){return new pr(e,1,r,Pe.min(),n,i,0)}static newNoDocument(e,r){return new pr(e,2,r,Pe.min(),Pe.min(),en.empty(),0)}static newUnknownDocument(e,r){return new pr(e,3,r,Pe.min(),Pe.min(),en.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=en.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=en.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,r){this.position=e,this.inclusive=r}}function Cv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Ae.comparator(Ae.fromName(a.referenceValue),r.key):n=uo(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Rv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!zn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,r="asc"){this.field=e,this.dir=r}}function $R(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{}class bt extends wE{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new WR(e,r,n):r==="array-contains"?new qR(e,n):r==="in"?new XR(e,n):r==="not-in"?new QR(e,n):r==="array-contains-any"?new YR(e,n):new bt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new GR(e,n):new KR(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(uo(r,this.value)):r!==null&&ns(this.value)===ns(r)&&this.matchesComparison(uo(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $n extends wE{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new $n(e,r)}matches(e){return TE(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function TE(t){return t.op==="and"}function SE(t){return HR(t)&&TE(t)}function HR(t){for(const e of t.filters)if(e instanceof $n)return!1;return!0}function Vd(t){if(t instanceof bt)return t.field.canonicalString()+t.op.toString()+co(t.value);if(SE(t))return t.filters.map(e=>Vd(e)).join(",");{const e=t.filters.map(r=>Vd(r)).join(",");return`${t.op}(${e})`}}function AE(t,e){return t instanceof bt?function(n,i){return i instanceof bt&&n.op===i.op&&n.field.isEqual(i.field)&&zn(n.value,i.value)}(t,e):t instanceof $n?function(n,i){return i instanceof $n&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&AE(a,i.filters[o]),!0):!1}(t,e):void Ie(19439)}function kE(t){return t instanceof bt?function(r){return`${r.field.canonicalString()} ${r.op} ${co(r.value)}`}(t):t instanceof $n?function(r){return r.op.toString()+" {"+r.getFilters().map(kE).join(" ,")+"}"}(t):"Filter"}class WR extends bt{constructor(e,r,n){super(e,r,n),this.key=Ae.fromName(n.referenceValue)}matches(e){const r=Ae.comparator(e.key,this.key);return this.matchesComparison(r)}}class GR extends bt{constructor(e,r){super(e,"in",r),this.keys=IE("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class KR extends bt{constructor(e,r){super(e,"not-in",r),this.keys=IE("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function IE(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Ae.fromName(n.referenceValue))}class qR extends bt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return dm(r)&&Jl(r.arrayValue,this.value)}}class XR extends bt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Jl(this.value.arrayValue,r)}}class QR extends bt{constructor(e,r){super(e,"not-in",r)}matches(e){if(Jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Jl(this.value.arrayValue,r)}}class YR extends bt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!dm(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Jl(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function Pv(t,e=null,r=[],n=[],i=null,s=null,a=null){return new JR(t,e,r,n,i,s,a)}function pm(t){const e=Ne(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Vd(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ih(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>co(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>co(n)).join(",")),e.Te=r}return e.Te}function mm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!$R(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!AE(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Rv(t.startAt,e.startAt)&&Rv(t.endAt,e.endAt)}function Bd(t){return Ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ZR(t,e,r,n,i,s,a,o){return new ah(t,e,r,n,i,s,a,o)}function gm(t){return new ah(t)}function Nv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function eP(t){return t.collectionGroup!==null}function xl(t){const e=Ne(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ut(er.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new pf(s,n))}),r.has(er.keyField().canonicalString())||e.Ie.push(new pf(er.keyField(),n))}return e.Ie}function Vn(t){const e=Ne(t);return e.Ee||(e.Ee=tP(e,xl(t))),e.Ee}function tP(t,e){if(t.limitType==="F")return Pv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pf(i.field,s)});const r=t.endAt?new df(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new df(t.startAt.position,t.startAt.inclusive):null;return Pv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ud(t,e,r){return new ah(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function oh(t,e){return mm(Vn(t),Vn(e))&&t.limitType===e.limitType}function CE(t){return`${pm(Vn(t))}|lt:${t.limitType}`}function Sa(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>kE(i)).join(", ")}]`),ih(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>co(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>co(i)).join(",")),`Target(${n})`}(Vn(t))}; limitType=${t.limitType})`}function lh(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Ae.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of xl(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const u=Cv(a,o,l);return a.inclusive?u<=0:u<0}(n.startAt,xl(n),i)||n.endAt&&!function(a,o,l){const u=Cv(a,o,l);return a.inclusive?u>=0:u>0}(n.endAt,xl(n),i))}(t,e)}function rP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function RE(t){return(e,r)=>{let n=!1;for(const i of xl(t)){const s=nP(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function nP(t,e,r){const n=t.field.isKeyField()?Ae.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?uo(l,u):Ie(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ie(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zs(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return dE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=new _t(Ae.comparator);function fi(){return iP}const PE=new _t(Ae.comparator);function nl(...t){let e=PE;for(const r of t)e=e.insert(r.key,r);return e}function NE(t){let e=PE;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Fs(){return yl()}function FE(){return yl()}function yl(){return new ea(t=>t.toString(),(t,e)=>t.isEqual(e))}const sP=new _t(Ae.comparator),aP=new Ut(Ae.comparator);function Ve(...t){let e=aP;for(const r of t)e=e.add(r);return e}const oP=new Ut(be);function lP(){return oP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cf(e)?"-0":e}}function DE(t){return{integerValue:""+t}}function uP(t,e){return LR(e)?DE(e):vm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(){this._=void 0}}function cP(t,e,r){return t instanceof mf?function(i,s){const a={fields:{[gE]:{stringValue:mE},[_E]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&hm(s)&&(s=sh(s)),s&&(a.fields[vE]=s),{mapValue:a}}(r,e):t instanceof Zl?LE(t,e):t instanceof eu?ME(t,e):function(i,s){const a=OE(i,s),o=Fv(a)+Fv(i.Ae);return bd(a)&&bd(i.Ae)?DE(o):vm(i.serializer,o)}(t,e)}function fP(t,e,r){return t instanceof Zl?LE(t,e):t instanceof eu?ME(t,e):r}function OE(t,e){return t instanceof gf?function(n){return bd(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class mf extends uh{}class Zl extends uh{constructor(e){super(),this.elements=e}}function LE(t,e){const r=bE(e);for(const n of t.elements)r.some(i=>zn(i,n))||r.push(n);return{arrayValue:{values:r}}}class eu extends uh{constructor(e){super(),this.elements=e}}function ME(t,e){let r=bE(e);for(const n of t.elements)r=r.filter(i=>!zn(i,n));return{arrayValue:{values:r}}}class gf extends uh{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Fv(t){return Tt(t.integerValue||t.doubleValue)}function bE(t){return dm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function hP(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Zl&&i instanceof Zl||n instanceof eu&&i instanceof eu?lo(n.elements,i.elements,zn):n instanceof gf&&i instanceof gf?zn(n.Ae,i.Ae):n instanceof mf&&i instanceof mf}(t.transform,e.transform)}class dP{constructor(e,r){this.version=e,this.transformResults=r}}class ei{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ei}static exists(e){return new ei(void 0,e)}static updateTime(e){return new ei(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ch{}function VE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new UE(t.key,ei.none()):new vu(t.key,t.data,ei.none());{const r=t.data,n=en.empty();let i=new Ut(er.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ta(t.key,n,new xn(i.toArray()),ei.none())}}function pP(t,e,r){t instanceof vu?function(i,s,a){const o=i.value.clone(),l=Ov(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ta?function(i,s,a){if(!Nc(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=Ov(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(BE(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function El(t,e,r,n){return t instanceof vu?function(s,a,o,l){if(!Nc(s.precondition,a))return o;const u=s.value.clone(),f=Lv(s.fieldTransforms,l,a);return u.setAll(f),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof ta?function(s,a,o,l){if(!Nc(s.precondition,a))return o;const u=Lv(s.fieldTransforms,l,a),f=a.data;return f.setAll(BE(s)),f.setAll(u),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return Nc(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function mP(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=OE(n.transform,i||null);s!=null&&(r===null&&(r=en.empty()),r.set(n.field,s))}return r||null}function Dv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&lo(n,i,(s,a)=>hP(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class vu extends ch{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ta extends ch{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function BE(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Ov(t,e,r){const n=new Map;We(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,fP(a,o,r[i]))}return n}function Lv(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,cP(s,a,e))}return n}class UE extends ch{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gP extends ch{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&pP(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=El(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=El(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=FE();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=VE(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Pe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ve())}isEqual(e){return this.batchId===e.batchId&&lo(this.mutations,e.mutations,(r,n)=>Dv(r,n))&&lo(this.baseMutations,e.baseMutations,(r,n)=>Dv(r,n))}}class _m{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){We(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return sP}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new _m(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It,Be;function yP(t){switch(t){case ne.OK:return Ie(64938);case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return Ie(15467,{code:t})}}function jE(t){if(t===void 0)return ci("GRPC error has no .code"),ne.UNKNOWN;switch(t){case It.OK:return ne.OK;case It.CANCELLED:return ne.CANCELLED;case It.UNKNOWN:return ne.UNKNOWN;case It.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case It.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case It.INTERNAL:return ne.INTERNAL;case It.UNAVAILABLE:return ne.UNAVAILABLE;case It.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case It.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case It.NOT_FOUND:return ne.NOT_FOUND;case It.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case It.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case It.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case It.ABORTED:return ne.ABORTED;case It.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case It.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case It.DATA_LOSS:return ne.DATA_LOSS;default:return Ie(39323,{code:t})}}(Be=It||(It={}))[Be.OK=0]="OK",Be[Be.CANCELLED=1]="CANCELLED",Be[Be.UNKNOWN=2]="UNKNOWN",Be[Be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Be[Be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Be[Be.NOT_FOUND=5]="NOT_FOUND",Be[Be.ALREADY_EXISTS=6]="ALREADY_EXISTS",Be[Be.PERMISSION_DENIED=7]="PERMISSION_DENIED",Be[Be.UNAUTHENTICATED=16]="UNAUTHENTICATED",Be[Be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Be[Be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Be[Be.ABORTED=10]="ABORTED",Be[Be.OUT_OF_RANGE=11]="OUT_OF_RANGE",Be[Be.UNIMPLEMENTED=12]="UNIMPLEMENTED",Be[Be.INTERNAL=13]="INTERNAL",Be[Be.UNAVAILABLE=14]="UNAVAILABLE",Be[Be.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=new Xi([4294967295,4294967295],0);function Mv(t){const e=EP().encode(t),r=new rE;return r.update(e),new Uint8Array(r.digest())}function bv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Xi([r,n],0),new Xi([i,s],0)]}class xm{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new il(`Invalid padding: ${r}`);if(n<0)throw new il(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new il(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new il(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Xi.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Xi.fromNumber(n)));return i.compare(wP)===1&&(i=new Xi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Mv(e),[n,i]=bv(r);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,i,s);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new xm(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const r=Mv(e),[n,i]=bv(r);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,i,s);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class il extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,_u.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new fh(Pe.min(),i,new _t(be),fi(),Ve())}}class _u{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new _u(n,r,Ve(),Ve(),Ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class zE{constructor(e,r){this.targetId=e,this.Ce=r}}class $E{constructor(e,r,n=ar.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Vv{constructor(){this.ve=0,this.Fe=Bv(),this.Me=ar.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ve(),r=Ve(),n=Ve();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ie(38017,{changeType:s})}}),new _u(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Bv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,We(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class TP{constructor(e){this.Ge=e,this.ze=new Map,this.je=fi(),this.Je=ac(),this.He=ac(),this.Ye=new _t(be)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ie(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const s=i.target;if(Bd(s))if(n===0){const a=new Ae(s.path);this.et(r,a,pr.newNoDocument(a,Pe.min()))}else We(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=rs(n).toUint8Array()}catch(l){if(l instanceof pE)return oo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new xm(a,i,s)}catch(l){return oo(l instanceof il?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(r,s,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((s,a)=>{const o=this.ot(a);if(o){if(s.current&&Bd(o.target)){const l=new Ae(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,pr.newNoDocument(l,e))}s.Be&&(r.set(a,s.ke()),s.qe())}});let n=Ve();this.He.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const i=new fh(e,r,this.Ye,this.je,n);return this.je=fi(),this.Je=ac(),this.He=ac(),this.Ye=new _t(be),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Vv,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Ut(be),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Ut(be),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||ve("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vv),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function ac(){return new _t(Ae.comparator)}function Bv(){return new _t(Ae.comparator)}const SP={asc:"ASCENDING",desc:"DESCENDING"},AP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kP={and:"AND",or:"OR"};class IP{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function jd(t,e){return t.useProto3Json||ih(e)?e:{value:e}}function vf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function HE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function CP(t,e){return vf(t,e.toTimestamp())}function Bn(t){return We(!!t,49232),Pe.fromTimestamp(function(r){const n=ts(r);return new ut(n.seconds,n.nanos)}(t))}function ym(t,e){return zd(t,e).canonicalString()}function zd(t,e){const r=function(i){return new lt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function WE(t){const e=lt.fromString(t);return We(QE(e),10190,{key:e.toString()}),e}function $d(t,e){return ym(t.databaseId,e.path)}function y0(t,e){const r=WE(e);if(r.get(1)!==t.databaseId.projectId)throw new we(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new we(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ae(KE(r))}function GE(t,e){return ym(t.databaseId,e)}function RP(t){const e=WE(t);return e.length===4?lt.emptyPath():KE(e)}function Hd(t){return new lt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KE(t){return We(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Uv(t,e,r){return{name:$d(t,e),fields:r.value.mapValue.fields}}function PP(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ie(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,f){return u.useProto3Json?(We(f===void 0||typeof f=="string",58123),ar.fromBase64String(f||"")):(We(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),ar.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const f=u.code===void 0?ne.UNKNOWN:jE(u.code);return new we(f,u.message||"")}(a);r=new $E(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=y0(t,n.document.name),s=Bn(n.document.updateTime),a=n.document.createTime?Bn(n.document.createTime):Pe.min(),o=new en({mapValue:{fields:n.document.fields}}),l=pr.newFoundDocument(i,s,a,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new Fc(u,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=y0(t,n.document),s=n.readTime?Bn(n.readTime):Pe.min(),a=pr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Fc([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=y0(t,n.document),s=n.removedTargetIds||[];r=new Fc([],s,i,null)}else{if(!("filter"in e))return Ie(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new xP(i,s),o=n.targetId;r=new zE(o,a)}}return r}function NP(t,e){let r;if(e instanceof vu)r={update:Uv(t,e.key,e.value)};else if(e instanceof UE)r={delete:$d(t,e.key)};else if(e instanceof ta)r={update:Uv(t,e.key,e.data),updateMask:UP(e.fieldMask)};else{if(!(e instanceof gP))return Ie(16599,{Vt:e.type});r={verify:$d(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof mf)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Zl)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof eu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof gf)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Ie(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:CP(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ie(27497)}(t,e.precondition)),r}function FP(t,e){return t&&t.length>0?(We(e!==void 0,14353),t.map(r=>function(i,s){let a=i.updateTime?Bn(i.updateTime):Bn(s);return a.isEqual(Pe.min())&&(a=Bn(s)),new dP(a,i.transformResults||[])}(r,e))):[]}function DP(t,e){return{documents:[GE(t,e.path)]}}function OP(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=GE(t,i);const s=function(u){if(u.length!==0)return XE($n.create(u,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(f=>function(d){return{field:Aa(d.field),direction:bP(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=jd(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function LP(t){let e=RP(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){We(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=qE(h);return d instanceof $n&&SE(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(_){return new pf(ka(_.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,ih(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,g=h.values||[];return new df(g,d)}(r.startAt));let u=null;return r.endAt&&(u=function(h){const d=!h.before,g=h.values||[];return new df(g,d)}(r.endAt)),ZR(e,i,a,s,o,"F",l,u)}function MP(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function qE(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ka(r.unaryFilter.field);return bt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ka(r.unaryFilter.field);return bt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ka(r.unaryFilter.field);return bt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ka(r.unaryFilter.field);return bt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie(61313);default:return Ie(60726)}}(t):t.fieldFilter!==void 0?function(r){return bt.create(ka(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ie(58110);default:return Ie(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return $n.create(r.compositeFilter.filters.map(n=>qE(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ie(1026)}}(r.compositeFilter.op))}(t):Ie(30097,{filter:t})}function bP(t){return SP[t]}function VP(t){return AP[t]}function BP(t){return kP[t]}function Aa(t){return{fieldPath:t.canonicalString()}}function ka(t){return er.fromServerFormat(t.fieldPath)}function XE(t){return t instanceof bt?function(r){if(r.op==="=="){if(Iv(r.value))return{unaryFilter:{field:Aa(r.field),op:"IS_NAN"}};if(kv(r.value))return{unaryFilter:{field:Aa(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Iv(r.value))return{unaryFilter:{field:Aa(r.field),op:"IS_NOT_NAN"}};if(kv(r.value))return{unaryFilter:{field:Aa(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Aa(r.field),op:VP(r.op),value:r.value}}}(t):t instanceof $n?function(r){const n=r.getFilters().map(i=>XE(i));return n.length===1?n[0]:{compositeFilter:{op:BP(r.op),filters:n}}}(t):Ie(54877,{filter:t})}function UP(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function QE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,r,n,i,s=Pe.min(),a=Pe.min(),o=ar.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e){this.yt=e}}function zP(t){const e=LP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ud(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.Cn=new HP}addToCollectionParentIndex(e,r){return this.Cn.add(r),te.resolve()}getCollectionParents(e,r){return te.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return te.resolve()}deleteFieldIndex(e,r){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,r){return te.resolve()}getDocumentsMatchingTarget(e,r){return te.resolve(null)}getIndexType(e,r){return te.resolve(0)}getFieldIndexes(e,r){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,r){return te.resolve(es.min())}getMinOffsetFromCollectionGroup(e,r){return te.resolve(es.min())}updateCollectionGroup(e,r,n){return te.resolve()}updateIndexEntries(e,r){return te.resolve()}}class HP{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Ut(lt.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ut(lt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},YE=41943040;class kr{static withCacheSize(e){return new kr(e,kr.DEFAULT_COLLECTION_PERCENTILE,kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kr.DEFAULT_COLLECTION_PERCENTILE=10,kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kr.DEFAULT=new kr(YE,kr.DEFAULT_COLLECTION_PERCENTILE,kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kr.DISABLED=new kr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fo(0)}static cr(){return new fo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="LruGarbageCollector",WP=1048576;function $v([t,e],[r,n]){const i=be(t,r);return i===0?be(e,n):i}class GP{constructor(e){this.Ir=e,this.buffer=new Ut($v),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();$v(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class KP{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ve(zv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){wo(r)?ve(zv,"Ignoring IndexedDB error during garbage collection: ",r):await Eo(r)}await this.Vr(3e5)})}}class qP{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return te.resolve(nh.ce);const n=new GP(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(jv)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jv):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,s,a,o,l,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,a=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(u=Date.now(),Ta()<=Ue.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-f}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function XP(t,e){return new qP(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(){this.changes=new ea(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,pr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?te.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&El(n.mutation,i,xn.empty(),ut.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ve()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ve()){const i=Fs();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=nl();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Fs();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ve()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=fi();const a=yl(),o=function(){return yl()}();return r.forEach((l,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof ta)?s=s.insert(u.key,u):f!==void 0?(a.set(u.key,f.mutation.getFieldMask()),El(f.mutation,u,f.mutation.getFieldMask(),ut.now())):a.set(u.key,xn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,f)=>a.set(u,f)),r.forEach((u,f)=>o.set(u,new YP(f,a.get(u)??null))),o))}recalculateAndSaveOverlays(e,r){const n=yl();let i=new _t((a,o)=>a-o),s=Ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||xn.empty();f=o.applyToLocalView(u,f),n.set(l,f);const h=(i.get(o.batchId)||Ve()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,h=FE();f.forEach(d=>{if(!s.has(d)){const g=VE(r.get(d),n.get(d));g!==null&&h.set(d,g),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return te.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Ae.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):eP(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):te.resolve(Fs());let o=Xl,l=s;return a.next(u=>te.forEach(u,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?te.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Ve())).next(f=>({batchId:o,changes:NE(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ae(r)).next(n=>{let i=nl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=nl();return this.indexManager.getCollectionParents(e,s).next(o=>te.forEach(o,l=>{const u=function(h,d){return new ah(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,u)=>{const f=u.getKey();a.get(f)===null&&(a=a.insert(f,pr.newInvalidDocument(f)))});let o=nl();return a.forEach((l,u)=>{const f=s.get(l);f!==void 0&&El(f.mutation,u,xn.empty(),ut.now()),lh(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return te.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Bn(i.createTime)}}(r)),te.resolve()}getNamedQuery(e,r){return te.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:zP(i.bundledQuery),readTime:Bn(i.readTime)}}(r)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this.overlays=new _t(Ae.comparator),this.qr=new Map}getOverlay(e,r){return te.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Fs();return te.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.St(e,r,s)}),te.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(n)),te.resolve()}getOverlaysForCollection(e,r,n){const i=Fs(),s=r.length+1,a=new Ae(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return te.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new _t((u,f)=>u-f);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=s.get(u.largestBatchId);f===null&&(f=Fs(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Fs(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=i)););return te.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new _P(r,n));let s=this.qr.get(r);s===void 0&&(s=Ve(),this.qr.set(r,s)),this.qr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(){this.sessionToken=ar.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(){this.Qr=new Ut(zt.$r),this.Ur=new Ut(zt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new zt(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new zt(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Ae(new lt([])),n=new zt(r,e),i=new zt(r,e+1),s=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Ae(new lt([])),n=new zt(r,e),i=new zt(r,e+1);let s=Ve();return this.Ur.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new zt(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class zt{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Ae.comparator(e.key,r.key)||be(e.Yr,r.Yr)}static Kr(e,r){return be(e.Yr,r.Yr)||Ae.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Ut(zt.$r)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new vP(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new zt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return te.resolve(a)}lookupMutationBatch(e,r){return te.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),s=i<0?0:i;return te.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?fm:this.tr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new zt(r,0),i=new zt(r,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,i],a=>{const o=this.Xr(a.Yr);s.push(o)}),te.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ut(be);return r.forEach(i=>{const s=new zt(i,0),a=new zt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],o=>{n=n.add(o.Yr)})}),te.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Ae.isDocumentKey(s)||(s=s.child(""));const a=new zt(new Ae(s),0);let o=new Ut(be);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)},a),te.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){We(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return te.forEach(r.mutations,i=>{const s=new zt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new zt(r,0),i=this.Zr.firstAfterOrEqual(n);return te.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e){this.ri=e,this.docs=function(){return new _t(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return te.resolve(n?n.document.mutableCopy():pr.newInvalidDocument(r))}getEntries(e,r){let n=fi();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():pr.newInvalidDocument(i))}),te.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=fi();const a=r.path,o=new Ae(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||NR(PR(f),n)<=0||(i.has(f.key)||lh(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return te.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Ie(9500)}ii(e,r){return te.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new iN(this)}getSize(e){return te.resolve(this.size)}}class iN extends QP{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),te.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e){this.persistence=e,this.si=new ea(r=>pm(r),mm),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new Em,this.targetCount=0,this.ai=fo.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),te.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new fo(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,te.resolve()}updateTargetData(e,r){return this.Pr(r),te.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),te.waitFor(s).next(()=>i)}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return te.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),te.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),te.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),te.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return te.resolve(n)}containsKey(e,r){return te.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,r){this.ui={},this.overlays={},this.ci=new nh(0),this.li=!1,this.li=!0,this.hi=new tN,this.referenceDelegate=e(this),this.Pi=new sN(this),this.indexManager=new $P,this.remoteDocumentCache=function(i){return new nN(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new jP(r),this.Ii=new ZP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new eN,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new rN(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){ve("MemoryPersistence","Starting transaction:",e);const i=new aN(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,r){return te.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class aN extends DR{constructor(e){super(),this.currentSequenceNumber=e}}class wm{constructor(e){this.persistence=e,this.Ri=new Em,this.Vi=null}static mi(e){return new wm(e)}get fi(){if(this.Vi)return this.Vi;throw Ie(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),te.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),te.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),te.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.fi,n=>{const i=Ae.fromPath(n);return this.gi(e,i).next(s=>{s||r.removeEntry(i,Pe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return te.or([()=>te.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class _f{constructor(e,r){this.persistence=e,this.pi=new ea(n=>MR(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=XP(this,r)}static mi(e,r){return new _f(e,r)}Ei(){}di(e){return te.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return te.forEach(this.pi,(n,i)=>this.br(e,n,i).next(s=>s?te.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(o=>{o||(n++,s.removeEntry(a,Pe.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),te.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),te.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),te.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Rc(e.data.value)),r}br(e,r,n){return te.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return te.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ve(),i=Ve();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Tm(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return DI()?8:OR(PI())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.ys(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new oN;return this.Ss(e,r,a).next(o=>{if(s.result=o,this.Vs)return this.bs(e,r,a,o.size)})}).next(()=>s.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(Ta()<=Ue.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Sa(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),te.resolve()):(Ta()<=Ue.DEBUG&&ve("QueryEngine","Query:",Sa(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Ta()<=Ue.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Sa(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(r))):te.resolve())}ys(e,r){if(Nv(r))return te.resolve(null);let n=Vn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Ud(r,null,"F"),n=Vn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Ve(...s);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.Ds(r,o);return this.Cs(r,u,a,l.readTime)?this.ys(e,Ud(r,null,"F")):this.vs(e,u,r,l)}))})))}ws(e,r,n,i){return Nv(r)||i.isEqual(Pe.min())?te.resolve(null):this.ps.getDocuments(e,n).next(s=>{const a=this.Ds(r,s);return this.Cs(r,a,n,i)?te.resolve(null):(Ta()<=Ue.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Sa(r)),this.vs(e,a,r,RR(i,Xl)).next(o=>o))})}Ds(e,r){let n=new Ut(RE(e));return r.forEach((i,s)=>{lh(e,s)&&(n=n.add(s))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,r,n){return Ta()<=Ue.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Sa(r)),this.ps.getDocumentsMatchingQuery(e,r,es.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="LocalStore",uN=3e8;class cN{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new _t(be),this.xs=new ea(s=>pm(s),mm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function fN(t,e,r,n){return new cN(t,e,r,n)}async function ZE(t,e){const r=Ne(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Ve();for(const u of i){a.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of s){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:o}))})})}function hN(t,e){const r=Ne(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const h=u.batch,d=h.keys();let g=te.resolve();return d.forEach(_=>{g=g.next(()=>f.getEntry(l,_)).next(m=>{const y=u.docVersions.get(_);We(y!==null,48541),m.version.compareTo(y)<0&&(h.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),f.addEntry(m)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Ve();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function ew(t){const e=Ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function dN(t,e){const r=Ne(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Pi.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(s,f.addedDocuments,h)));let g=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(ar.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):f.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(f.resumeToken,n)),i=i.insert(h,g),function(m,y,w){return m.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=uN?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(d,g,f)&&o.push(r.Pi.updateTargetData(s,g))});let l=fi(),u=Ve();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(pN(s,a,e.documentUpdates).next(f=>{l=f.ks,u=f.qs})),!n.isEqual(Pe.min())){const f=r.Pi.getLastRemoteSnapshotVersion(s).next(h=>r.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return te.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(r.Ms=i,s))}function pN(t,e,r){let n=Ve(),i=Ve();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=fi();return r.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Pe.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):ve(Sm,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{ks:a,qs:i}})}function mN(t,e){const r=Ne(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=fm),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function gN(t,e){const r=Ne(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(s=>s?(i=s,te.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new Li(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function Wd(t,e,r){const n=Ne(t),i=n.Ms.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!wo(a))throw a;ve(Sm,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Hv(t,e,r){const n=Ne(t);let i=Pe.min(),s=Ve();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,f){const h=Ne(l),d=h.xs.get(f);return d!==void 0?te.resolve(h.Ms.get(d)):h.Pi.getTargetData(u,f)}(n,a,Vn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:Pe.min(),r?s:Ve())).next(o=>(vN(n,rP(e),o),{documents:o,Qs:s})))}function vN(t,e,r){let n=t.Os.get(e)||Pe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.Os.set(e,n)}class Wv{constructor(){this.activeTargetIds=lP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _N{constructor(){this.Mo=new Wv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Wv,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="ConnectivityMonitor";class Kv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ve(Gv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ve(Gv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oc=null;function Gd(){return oc===null?oc=function(){return 268435456+Math.round(2147483648*Math.random())}():oc++,"0x"+oc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="RestConnection",yN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class EN{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===ff?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,s){const a=Gd(),o=this.zo(e,r.toUriEncodedString());ve(E0,`Sending RPC '${e}' ${a}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),f=em(u);return this.Jo(e,o,l,n,f).then(h=>(ve(E0,`Received RPC '${e}' ${a}: `,h),h),h=>{throw oo(E0,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,s,a){return this.Go(e,r,n,i,s)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}zo(e,r){const n=yN[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr="WebChannelConnection";class TN extends EN{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,s){const a=Gd();return new Promise((o,l)=>{const u=new nE;u.setWithCredentials(!0),u.listenOnce(iE.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Cc.NO_ERROR:const h=u.getResponseJson();ve(fr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case Cc.TIMEOUT:ve(fr,`RPC '${e}' ${a} timed out`),l(new we(ne.DEADLINE_EXCEEDED,"Request time out"));break;case Cc.HTTP_ERROR:const d=u.getStatus();if(ve(fr,`RPC '${e}' ${a} failed with status:`,d,"response text:",u.getResponseText()),d>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const m=function(w){const x=w.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(x)>=0?x:ne.UNKNOWN}(_.status);l(new we(m,_.message))}else l(new we(ne.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new we(ne.UNAVAILABLE,"Connection failed."));break;default:Ie(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{ve(fr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);ve(fr,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",f,n,15)})}T_(e,r,n){const i=Gd(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=oE(),o=aE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");ve(fr,`Creating RPC '${e}' stream ${i}: ${f}`,l);const h=a.createWebChannel(f,l);this.I_(h);let d=!1,g=!1;const _=new wN({Yo:y=>{g?ve(fr,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(d||(ve(fr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),ve(fr,`RPC '${e}' stream ${i} sending:`,y),h.send(y))},Zo:()=>h.close()}),m=(y,w,x)=>{y.listen(w,T=>{try{x(T)}catch(O){setTimeout(()=>{throw O},0)}})};return m(h,rl.EventType.OPEN,()=>{g||(ve(fr,`RPC '${e}' stream ${i} transport opened.`),_.o_())}),m(h,rl.EventType.CLOSE,()=>{g||(g=!0,ve(fr,`RPC '${e}' stream ${i} transport closed`),_.a_(),this.E_(h))}),m(h,rl.EventType.ERROR,y=>{g||(g=!0,oo(fr,`RPC '${e}' stream ${i} transport errored. Name:`,y.name,"Message:",y.message),_.a_(new we(ne.UNAVAILABLE,"The operation could not be completed")))}),m(h,rl.EventType.MESSAGE,y=>{var w;if(!g){const x=y.data[0];We(!!x,16349);const T=x,O=(T==null?void 0:T.error)||((w=T[0])==null?void 0:w.error);if(O){ve(fr,`RPC '${e}' stream ${i} received error:`,O);const U=O.status;let W=function(A){const I=It[A];if(I!==void 0)return jE(I)}(U),E=O.message;W===void 0&&(W=ne.INTERNAL,E="Unknown error status: "+U+" with message "+O.message),g=!0,_.a_(new we(W,E)),h.close()}else ve(fr,`RPC '${e}' stream ${i} received:`,x),_.u_(x)}}),m(o,sE.STAT_EVENT,y=>{y.stat===Od.PROXY?ve(fr,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===Od.NOPROXY&&ve(fr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.__()},0),_}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function w0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(t){return new IP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,r,n=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="PersistentStream";class rw{constructor(e,r,n,i,s,a,o,l){this.Mi=e,this.S_=n,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new tw(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ne.RESOURCE_EXHAUSTED?(ci(r.toString()),ci("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new we(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ve(qv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(ve(qv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class SN extends rw{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=PP(this.serializer,e),n=function(s){if(!("targetChange"in s))return Pe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Pe.min():a.readTime?Bn(a.readTime):Pe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Hd(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=Bd(l)?{documents:DP(s,l)}:{query:OP(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=HE(s,a.resumeToken);const u=jd(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Pe.min())>0){o.readTime=vf(s,a.snapshotVersion.toTimestamp());const u=jd(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=MP(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Hd(this.serializer),r.removeTarget=e,this.q_(r)}}class AN extends rw{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return We(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,We(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){We(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=FP(e.writeResults,e.commitTime),n=Bn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Hd(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>NP(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{}class IN extends kN{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new we(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,zd(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new we(ne.UNKNOWN,s.toString())})}Ho(e,r,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,zd(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new we(ne.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class CN{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ci(r),this.aa=!1):ve("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="RemoteStore";class RN{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{ra(this)&&(ve(Ks,"Restarting streams for network reachability change."),await async function(l){const u=Ne(l);u.Ea.add(4),await xu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await dh(u)}(this))})}),this.Ra=new CN(n,i)}}async function dh(t){if(ra(t))for(const e of t.da)await e(!0)}async function xu(t){for(const e of t.da)await e(!1)}function nw(t,e){const r=Ne(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Cm(r)?Im(r):To(r).O_()&&km(r,e))}function Am(t,e){const r=Ne(t),n=To(r);r.Ia.delete(e),n.O_()&&iw(r,e),r.Ia.size===0&&(n.O_()?n.L_():ra(r)&&r.Ra.set("Unknown"))}function km(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}To(t).Y_(e)}function iw(t,e){t.Va.Ue(e),To(t).Z_(e)}function Im(t){t.Va=new TP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),To(t).start(),t.Ra.ua()}function Cm(t){return ra(t)&&!To(t).x_()&&t.Ia.size>0}function ra(t){return Ne(t).Ea.size===0}function sw(t){t.Va=void 0}async function PN(t){t.Ra.set("Online")}async function NN(t){t.Ia.forEach((e,r)=>{km(t,e)})}async function FN(t,e){sw(t),Cm(t)?(t.Ra.ha(e),Im(t)):t.Ra.set("Unknown")}async function DN(t,e,r){if(t.Ra.set("Online"),e instanceof $E&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){ve(Ks,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await xf(t,n)}else if(e instanceof Fc?t.Va.Ze(e):e instanceof zE?t.Va.st(e):t.Va.tt(e),!r.isEqual(Pe.min()))try{const n=await ew(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(u);f&&s.Ia.set(u,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(ar.EMPTY_BYTE_STRING,f.snapshotVersion)),iw(s,l);const h=new Li(f.target,l,u,f.sequenceNumber);km(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){ve(Ks,"Failed to raise snapshot:",n),await xf(t,n)}}async function xf(t,e,r){if(!wo(e))throw e;t.Ea.add(1),await xu(t),t.Ra.set("Offline"),r||(r=()=>ew(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ve(Ks,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await dh(t)})}function aw(t,e){return e().catch(r=>xf(t,r,e))}async function ph(t){const e=Ne(t),r=is(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fm;for(;ON(e);)try{const i=await mN(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,LN(e,i)}catch(i){await xf(e,i)}ow(e)&&lw(e)}function ON(t){return ra(t)&&t.Ta.length<10}function LN(t,e){t.Ta.push(e);const r=is(t);r.O_()&&r.X_&&r.ea(e.mutations)}function ow(t){return ra(t)&&!is(t).x_()&&t.Ta.length>0}function lw(t){is(t).start()}async function MN(t){is(t).ra()}async function bN(t){const e=is(t);for(const r of t.Ta)e.ea(r.mutations)}async function VN(t,e,r){const n=t.Ta.shift(),i=_m.from(n,e,r);await aw(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await ph(t)}async function BN(t,e){e&&is(t).X_&&await async function(n,i){if(function(a){return yP(a)&&a!==ne.ABORTED}(i.code)){const s=n.Ta.shift();is(n).B_(),await aw(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await ph(n)}}(t,e),ow(t)&&lw(t)}async function Xv(t,e){const r=Ne(t);r.asyncQueue.verifyOperationInProgress(),ve(Ks,"RemoteStore received new credentials");const n=ra(r);r.Ea.add(3),await xu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await dh(r)}async function UN(t,e){const r=Ne(t);e?(r.Ea.delete(2),await dh(r)):e||(r.Ea.add(2),await xu(r),r.Ra.set("Unknown"))}function To(t){return t.ma||(t.ma=function(r,n,i){const s=Ne(r);return s.sa(),new SN(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:PN.bind(null,t),t_:NN.bind(null,t),r_:FN.bind(null,t),H_:DN.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Cm(t)?Im(t):t.Ra.set("Unknown")):(await t.ma.stop(),sw(t))})),t.ma}function is(t){return t.fa||(t.fa=function(r,n,i){const s=Ne(r);return s.sa(),new AN(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:MN.bind(null,t),r_:BN.bind(null,t),ta:bN.bind(null,t),na:VN.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await ph(t)):(await t.fa.stop(),t.Ta.length>0&&(ve(Ks,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Rm(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pm(t,e){if(ci("AsyncQueue",`${e}: ${t}`),wo(t))return new we(ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{static emptySet(e){return new qa(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ae.comparator(r.key,n.key):(r,n)=>Ae.comparator(r.key,n.key),this.keyedMap=nl(),this.sortedSet=new _t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof qa)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new qa;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(){this.ga=new _t(Ae.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ie(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class ho{constructor(e,r,n,i,s,a,o,l,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new ho(e,r,qa.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class zN{constructor(){this.queries=Yv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=Ne(r),s=i.queries;i.queries=Yv(),s.forEach((a,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new we(ne.ABORTED,"Firestore shutting down"))}}function Yv(){return new ea(t=>CE(t),oh)}async function uw(t,e){const r=Ne(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.ba()&&e.Da()&&(n=2):(s=new jN,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await r.onListen(i,!0);break;case 1:s.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Pm(a,`Initialization of query '${Sa(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.Sa.push(e),e.va(r.onlineState),s.wa&&e.Fa(s.wa)&&Nm(r)}async function cw(t,e){const r=Ne(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function $N(t,e){const r=Ne(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(n=!0);a.wa=i}}n&&Nm(r)}function HN(t,e,r){const n=Ne(t),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(r);n.queries.delete(e)}function Nm(t){t.Ca.forEach(e=>{e.next()})}var Kd,Jv;(Jv=Kd||(Kd={})).Ma="default",Jv.Cache="cache";class fw{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ho(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=ho.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Kd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e){this.key=e}}class dw{constructor(e){this.key=e}}class WN{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ve(),this.mutatedKeys=Ve(),this.eu=RE(e),this.tu=new qa(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Qv,i=r?r.tu:this.tu;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),g=lh(this.query,h)?h:null,_=!!d&&this.mutatedKeys.has(d.key),m=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let y=!1;d&&g?d.data.isEqual(g.data)?_!==m&&(n.track({type:3,doc:g}),y=!0):this.su(d,g)||(n.track({type:2,doc:g}),y=!0,(l&&this.eu(g,l)>0||u&&this.eu(g,u)<0)&&(o=!0)):!d&&g?(n.track({type:0,doc:g}),y=!0):d&&!g&&(n.track({type:1,doc:d}),y=!0,(l||u)&&(o=!0)),y&&(g?(a=a.add(g),s=m?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:o,mutatedKeys:s}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,h)=>function(g,_){const m=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie(20277,{Rt:y})}};return m(g)-m(_)}(f.type,h.type)||this.eu(f.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new ho(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Qv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ve(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new dw(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new hw(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ve();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return ho.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fm="SyncEngine";class GN{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class KN{constructor(e){this.key=e,this.hu=!1}}class qN{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new ea(o=>CE(o),oh),this.Iu=new Map,this.Eu=new Set,this.du=new _t(Ae.comparator),this.Au=new Map,this.Ru=new Em,this.Vu={},this.mu=new Map,this.fu=fo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function XN(t,e,r=!0){const n=xw(t);let i;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await pw(n,e,r,!0),i}async function QN(t,e){const r=xw(t);await pw(r,e,!0,!1)}async function pw(t,e,r,n){const i=await gN(t.localStore,Vn(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await YN(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&nw(t.remoteStore,i),o}async function YN(t,e,r,n,i){t.pu=(h,d,g)=>async function(m,y,w,x){let T=y.view.ru(w);T.Cs&&(T=await Hv(m.localStore,y.query,!1).then(({documents:E})=>y.view.ru(E,T)));const O=x&&x.targetChanges.get(y.targetId),U=x&&x.targetMismatches.get(y.targetId)!=null,W=y.view.applyChanges(T,m.isPrimaryClient,O,U);return e_(m,y.targetId,W.au),W.snapshot}(t,h,d,g);const s=await Hv(t.localStore,e,!0),a=new WN(e,s.Qs),o=a.ru(s.documents),l=_u.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=a.applyChanges(o,t.isPrimaryClient,l);e_(t,r,u.au);const f=new GN(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function JN(t,e,r){const n=Ne(t),i=n.Tu.get(e),s=n.Iu.get(i.targetId);if(s.length>1)return n.Iu.set(i.targetId,s.filter(a=>!oh(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Wd(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Am(n.remoteStore,i.targetId),qd(n,i.targetId)}).catch(Eo)):(qd(n,i.targetId),await Wd(n.localStore,i.targetId,!0))}async function ZN(t,e){const r=Ne(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Am(r.remoteStore,n.targetId))}async function e6(t,e,r){const n=o6(t);try{const i=await function(a,o){const l=Ne(a),u=ut.now(),f=o.reduce((g,_)=>g.add(_.key),Ve());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let _=fi(),m=Ve();return l.Ns.getEntries(g,f).next(y=>{_=y,_.forEach((w,x)=>{x.isValidDocument()||(m=m.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,_)).next(y=>{h=y;const w=[];for(const x of o){const T=mP(x,h.get(x.key).overlayedDocument);T!=null&&w.push(new ta(x.key,T,EE(T.value.mapValue),ei.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,w,o)}).next(y=>{d=y;const w=y.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(g,y.batchId,w)})}).then(()=>({batchId:d.batchId,changes:NE(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new _t(be)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u}(n,i.batchId,r),await yu(n,i.changes),await ph(n.remoteStore)}catch(i){const s=Pm(i,"Failed to persist write");r.reject(s)}}async function mw(t,e){const r=Ne(t);try{const n=await dN(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Au.get(s);a&&(We(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?We(a.hu,14607):i.removedDocuments.size>0&&(We(a.hu,42227),a.hu=!1))}),await yu(r,n,e)}catch(n){await Eo(n)}}function Zv(t,e,r){const n=Ne(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Ne(a);l.onlineState=o;let u=!1;l.queries.forEach((f,h)=>{for(const d of h.Sa)d.va(o)&&(u=!0)}),u&&Nm(l)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function t6(t,e,r){const n=Ne(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),s=i&&i.key;if(s){let a=new _t(Ae.comparator);a=a.insert(s,pr.newNoDocument(s,Pe.min()));const o=Ve().add(s),l=new fh(Pe.min(),new Map,new _t(be),a,o);await mw(n,l),n.du=n.du.remove(s),n.Au.delete(e),Dm(n)}else await Wd(n.localStore,e,!1).then(()=>qd(n,e,r)).catch(Eo)}async function r6(t,e){const r=Ne(t),n=e.batch.batchId;try{const i=await hN(r.localStore,e);vw(r,n,null),gw(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await yu(r,i)}catch(i){await Eo(i)}}async function n6(t,e,r){const n=Ne(t);try{const i=await function(a,o){const l=Ne(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(h=>(We(h!==null,37113),f=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,e);vw(n,e,r),gw(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await yu(n,i)}catch(i){await Eo(i)}}function gw(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function vw(t,e,r){const n=Ne(t);let i=n.Vu[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function qd(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||_w(t,n)})}function _w(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Am(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Dm(t))}function e_(t,e,r){for(const n of r)n instanceof hw?(t.Ru.addReference(n.key,e),i6(t,n)):n instanceof dw?(ve(Fm,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||_w(t,n.key)):Ie(19791,{wu:n})}function i6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(ve(Fm,"New document in limbo: "+r),t.Eu.add(n),Dm(t))}function Dm(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Ae(lt.fromString(e)),n=t.fu.next();t.Au.set(n,new KN(r)),t.du=t.du.insert(r,n),nw(t.remoteStore,new Li(Vn(gm(r.path)),n,"TargetPurposeLimboResolution",nh.ce))}}async function yu(t,e,r){const n=Ne(t),i=[],s=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{a.push(n.pu(l,e,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=Tm.As(l.targetId,u);s.push(h)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(l,u){const f=Ne(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>te.forEach(u,d=>te.forEach(d.Es,g=>f.persistence.referenceDelegate.addReference(h,d.targetId,g)).next(()=>te.forEach(d.ds,g=>f.persistence.referenceDelegate.removeReference(h,d.targetId,g)))))}catch(h){if(!wo(h))throw h;ve(Sm,"Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const g=f.Ms.get(d),_=g.snapshotVersion,m=g.withLastLimboFreeSnapshotVersion(_);f.Ms=f.Ms.insert(d,m)}}}(n.localStore,s))}async function s6(t,e){const r=Ne(t);if(!r.currentUser.isEqual(e)){ve(Fm,"User change. New user:",e.toKey());const n=await ZE(r.localStore,e);r.currentUser=e,function(s,a){s.mu.forEach(o=>{o.forEach(l=>{l.reject(new we(ne.CANCELLED,a))})}),s.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await yu(r,n.Ls)}}function a6(t,e){const r=Ne(t),n=r.Au.get(e);if(n&&n.hu)return Ve().add(n.key);{let i=Ve();const s=r.Iu.get(e);if(!s)return i;for(const a of s){const o=r.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function xw(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=mw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=a6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=t6.bind(null,e),e.Pu.H_=$N.bind(null,e.eventManager),e.Pu.yu=HN.bind(null,e.eventManager),e}function o6(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=r6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n6.bind(null,e),e}class yf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return fN(this.persistence,new lN,e.initialUser,this.serializer)}Cu(e){return new JE(wm.mi,this.serializer)}Du(e){return new _N}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yf.provider={build:()=>new yf};class l6 extends yf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){We(this.persistence.referenceDelegate instanceof _f,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new KP(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?kr.withCacheSize(this.cacheSizeBytes):kr.DEFAULT;return new JE(n=>_f.mi(n,r),this.serializer)}}class Xd{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Zv(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=s6.bind(null,this.syncEngine),await UN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new zN}()}createDatastore(e){const r=hh(e.databaseInfo.databaseId),n=function(s){return new TN(s)}(e.databaseInfo);return function(s,a,o,l){return new IN(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new RN(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>Zv(this.syncEngine,r,0),function(){return Kv.v()?new Kv:new xN}())}createSyncEngine(e,r){return function(i,s,a,o,l,u,f){const h=new qN(i,s,a,o,l,u);return f&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=Ne(i);ve(Ks,"RemoteStore shutting down."),s.Ea.add(5),await xu(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}Xd.provider={build:()=>new Xd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ci("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="FirestoreClient";class u6{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=hr.UNAUTHENTICATED,this.clientId=um.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{ve(ss,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(ve(ss,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Pm(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function T0(t,e){t.asyncQueue.verifyOperationInProgress(),ve(ss,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await ZE(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function t_(t,e){t.asyncQueue.verifyOperationInProgress();const r=await c6(t);ve(ss,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Xv(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Xv(e.remoteStore,i)),t._onlineComponents=e}async function c6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ve(ss,"Using user provided OfflineComponentProvider");try{await T0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ne.FAILED_PRECONDITION||i.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;oo("Error using user provided cache. Falling back to memory cache: "+r),await T0(t,new yf)}}else ve(ss,"Using default OfflineComponentProvider"),await T0(t,new l6(void 0));return t._offlineComponents}async function Ew(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ve(ss,"Using user provided OnlineComponentProvider"),await t_(t,t._uninitializedComponentsProvider._online)):(ve(ss,"Using default OnlineComponentProvider"),await t_(t,new Xd))),t._onlineComponents}function f6(t){return Ew(t).then(e=>e.syncEngine)}async function ww(t){const e=await Ew(t),r=e.eventManager;return r.onListen=XN.bind(null,e.syncEngine),r.onUnlisten=JN.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=QN.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=ZN.bind(null,e.syncEngine),r}function h6(t,e,r={}){const n=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new yw({next:d=>{f.Nu(),a.enqueueAndForget(()=>cw(s,h));const g=d.docs.has(o);!g&&d.fromCache?u.reject(new we(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&d.fromCache&&l&&l.source==="server"?u.reject(new we(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new fw(gm(o.path),f,{includeMetadataChanges:!0,qa:!0});return uw(s,h)}(await ww(t),t.asyncQueue,e,r,n)),n.promise}function d6(t,e,r={}){const n=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const f=new yw({next:d=>{f.Nu(),a.enqueueAndForget(()=>cw(s,h)),d.fromCache&&l.source==="server"?u.reject(new we(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new fw(o,f,{includeMetadataChanges:!0,qa:!0});return uw(s,h)}(await ww(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw="firestore.googleapis.com",n_=!0;class i_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Sw,this.ssl=n_}else this.host=e.host,this.ssl=e.ssl??n_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=YE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WP)throw new we(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Tw(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new we(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mh{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new _R;switch(n.type){case"firstParty":return new wR(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new we(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=r_.get(r);n&&(ve("ComponentProvider","Removing Datastore"),r_.delete(r),n.terminate())}(this),Promise.resolve()}}function p6(t,e,r,n={}){var u;t=Gs(t,mh);const i=em(e),s=t._getSettings(),a={...s,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(AI(`https://${o}`),RI("Firestore",!0)),s.host!==Sw&&s.host!==o&&oo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:n};if(!Kl(l,a)&&(t._setSettings(l),n.mockUserToken)){let f,h;if(typeof n.mockUserToken=="string")f=n.mockUserToken,h=hr.MOCK_USER;else{f=kI(n.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new we(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new hr(d)}t._authCredentials=new xR(new uE(f,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new gh(this.firestore,e,this._query)}}class Bt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Bt(this.firestore,e,this._key)}toJSON(){return{type:Bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(gu(r,Bt._jsonSchema))return new Bt(e,n||null,new Ae(lt.fromString(r.referencePath)))}}Bt._jsonSchemaVersion="firestore/documentReference/1.0",Bt._jsonSchema={type:Rt("string",Bt._jsonSchemaVersion),referencePath:Rt("string")};class Qi extends gh{constructor(e,r,n){super(e,r,gm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Bt(this.firestore,null,new Ae(e))}withConverter(e){return new Qi(this.firestore,e,this._path)}}function m6(t,e,...r){if(t=zs(t),cE("collection","path",e),t instanceof mh){const n=lt.fromString(e,...r);return _v(n),new Qi(t,null,n)}{if(!(t instanceof Bt||t instanceof Qi))throw new we(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(lt.fromString(e,...r));return _v(n),new Qi(t.firestore,null,n)}}function s_(t,e,...r){if(t=zs(t),arguments.length===1&&(e=um.newId()),cE("doc","path",e),t instanceof mh){const n=lt.fromString(e,...r);return vv(n),new Bt(t,null,new Ae(n))}{if(!(t instanceof Bt||t instanceof Qi))throw new we(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(lt.fromString(e,...r));return vv(n),new Bt(t.firestore,t instanceof Qi?t.converter:null,new Ae(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="AsyncQueue";class o_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tw(this,"async_queue_retry"),this._c=()=>{const n=w0();n&&ve(a_,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=w0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=w0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Zn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!wo(e))throw e;ve(a_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,ci("INTERNAL UNHANDLED ERROR: ",l_(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Rm.createAndSchedule(this,e,r,n,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Ie(47125,{Pc:l_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function l_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class vh extends mh{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new o_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new o_(e),this._firestoreClient=void 0,await e}}}function g6(t,e){const r=typeof t=="object"?t:N2(),n=typeof t=="string"?t:ff,i=mu(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=TI("firestore");s&&p6(i,...s)}return i}function Om(t){if(t._terminated)throw new we(ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||v6(t),t._firestoreClient}function v6(t){var n,i,s;const e=t._freezeSettings(),r=function(o,l,u,f){return new BR(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,Tw(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new u6(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tn(ar.fromBase64String(e))}catch(r){throw new we(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new tn(ar.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:tn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gu(e,tn._jsonSchema))return tn.fromBase64String(e.bytes)}}tn._jsonSchemaVersion="firestore/bytes/1.0",tn._jsonSchema={type:Rt("string",tn._jsonSchemaVersion),bytes:Rt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new we(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new we(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new we(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Un._jsonSchemaVersion}}static fromJSON(e){if(gu(e,Un._jsonSchema))return new Un(e.latitude,e.longitude)}}Un._jsonSchemaVersion="firestore/geoPoint/1.0",Un._jsonSchema={type:Rt("string",Un._jsonSchemaVersion),latitude:Rt("number"),longitude:Rt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gu(e,jn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new jn(e.vectorValues);throw new we(ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jn._jsonSchemaVersion="firestore/vectorValue/1.0",jn._jsonSchema={type:Rt("string",jn._jsonSchemaVersion),vectorValues:Rt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=/^__.*__$/;class x6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ta(e,this.data,this.fieldMask,r,this.fieldTransforms):new vu(e,this.data,r,this.fieldTransforms)}}function kw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie(40011,{Ac:t})}}class Mm{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Mm({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const r=(i=this.path)==null?void 0:i.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var i;const r=(i=this.path)==null?void 0:i.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ef(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(kw(this.Ac)&&_6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class y6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||hh(e)}Cc(e,r,n,i=!1){return new Mm({Ac:e,methodName:r,Dc:n,path:er.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function E6(t){const e=t._freezeSettings(),r=hh(t._databaseId);return new y6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function w6(t,e,r,n,i,s={}){const a=t.Cc(s.merge||s.mergeFields?2:0,e,r,i);Pw("Data must be an object, but it was:",a,n);const o=Cw(n,a);let l,u;if(s.merge)l=new xn(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=T6(e,h,r);if(!a.contains(d))throw new we(ne.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);A6(f,d)||f.push(d)}l=new xn(f),u=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=a.fieldTransforms;return new x6(new en(o),l,u)}function Iw(t,e){if(Rw(t=zs(t)))return Pw("Unsupported field value:",e,t),Cw(t,e);if(t instanceof Aw)return function(n,i){if(!kw(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Iw(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=zs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return uP(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ut.fromDate(n);return{timestampValue:vf(i.serializer,s)}}if(n instanceof ut){const s=new ut(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:vf(i.serializer,s)}}if(n instanceof Un)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof tn)return{bytesValue:HE(i.serializer,n._byteString)};if(n instanceof Bt){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ym(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof jn)return function(a,o){return{mapValue:{fields:{[xE]:{stringValue:yE},[hf]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return vm(o.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${cm(n)}`)}(t,e)}function Cw(t,e){const r={};return dE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zs(t,(n,i)=>{const s=Iw(i,e.mc(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function Rw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ut||t instanceof Un||t instanceof tn||t instanceof Bt||t instanceof Aw||t instanceof jn)}function Pw(t,e,r){if(!Rw(r)||!fE(r)){const n=cm(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function T6(t,e,r){if((e=zs(e))instanceof Lm)return e._internalPath;if(typeof e=="string")return Nw(t,e);throw Ef("Field path arguments must be of type string or ",t,!1,void 0,r)}const S6=new RegExp("[~\\*/\\[\\]]");function Nw(t,e,r){if(e.search(S6)>=0)throw Ef(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Lm(...e.split("."))._internalPath}catch{throw Ef(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ef(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new we(ne.INVALID_ARGUMENT,o+t+l)}function A6(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new k6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Dw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class k6 extends Fw{data(){return super.data()}}function Dw(t,e){return typeof e=="string"?Nw(t,e):e instanceof Lm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class C6{convertValue(e,r="none"){switch(ns(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Tt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(rs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Zs(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var n,i,s;const r=(s=(i=(n=e.fields)==null?void 0:n[hf].arrayValue)==null?void 0:i.values)==null?void 0:s.map(a=>Tt(a.doubleValue));return new jn(r)}convertGeoPoint(e){return new Un(Tt(e.latitude),Tt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=sh(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ql(e));default:return null}}convertTimestamp(e){const r=ts(e);return new ut(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=lt.fromString(e);We(QE(n),9688,{name:e});const i=new Yl(n.get(1),n.get(3)),s=new Ae(n.popFirst(5));return i.isEqual(r)||ci(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class sl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ls extends Fw{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Dc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Dw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Ls._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Ls._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ls._jsonSchema={type:Rt("string",Ls._jsonSchemaVersion),bundleSource:Rt("string","DocumentSnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class Dc extends Ls{data(e={}){return super.data(e)}}class Xa{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new sl(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Dc(this._firestore,this._userDataWriter,n.key,n,new sl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new we(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new Dc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new sl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new Dc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new sl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:P6(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xa._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=um.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(r.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function P6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N6(t){t=Gs(t,Bt);const e=Gs(t.firestore,vh);return h6(Om(e),t._key).then(r=>L6(e,t,r))}Xa._jsonSchemaVersion="firestore/querySnapshot/1.0",Xa._jsonSchema={type:Rt("string",Xa._jsonSchemaVersion),bundleSource:Rt("string","QuerySnapshot"),bundleName:Rt("string"),bundle:Rt("string")};class Ow extends C6{constructor(e){super(),this.firestore=e}convertBytes(e){return new tn(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Bt(this.firestore,null,r)}}function F6(t){t=Gs(t,gh);const e=Gs(t.firestore,vh),r=Om(e),n=new Ow(e);return I6(t._query),d6(r,t._query).then(i=>new Xa(e,n,t,i))}function D6(t,e,r){t=Gs(t,Bt);const n=Gs(t.firestore,vh),i=R6(t.converter,e,r);return O6(n,[w6(E6(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,ei.none())])}function O6(t,e){return function(n,i){const s=new Zn;return n.asyncQueue.enqueueAndForget(async()=>e6(await f6(n),i,s)),s.promise}(Om(t),e)}function L6(t,e,r){const n=r.docs.get(e._key),i=new Ow(t);return new Ls(t,i,e._key,n,new sl(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){yo=i})(UC),Zi(new li("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new vh(new yR(n.getProvider("auth-internal")),new TR(a,n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new we(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yl(u.options.projectId,f)}(a,i),a);return s={useFetchStreams:r,...s},o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),bn(dv,pv,e),bn(dv,pv,"esm2020")})();const M6={apiKey:"AIzaSyCjCIZpt5rCwQx5L6uBqM-Y0d2tsD9GWr8",authDomain:"adiwiyata-adventure.firebaseapp.com",projectId:"adiwiyata-adventure",storageBucket:"adiwiyata-adventure.firebasestorage.app",messagingSenderId:"978062184018",appId:"1:978062184018:web:b21bf906ba7a1a8b45d98b",measurementId:"G-WXVNRN2RQM"},Lw=P2(M6);pR(Lw);const Qd=g6(Lw),Xt=[];for(let t=0;t<256;++t)Xt.push((t+256).toString(16).slice(1));function b6(t,e=0){return(Xt[t[e+0]]+Xt[t[e+1]]+Xt[t[e+2]]+Xt[t[e+3]]+"-"+Xt[t[e+4]]+Xt[t[e+5]]+"-"+Xt[t[e+6]]+Xt[t[e+7]]+"-"+Xt[t[e+8]]+Xt[t[e+9]]+"-"+Xt[t[e+10]]+Xt[t[e+11]]+Xt[t[e+12]]+Xt[t[e+13]]+Xt[t[e+14]]+Xt[t[e+15]]).toLowerCase()}let S0;const V6=new Uint8Array(16);function B6(){if(!S0){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");S0=crypto.getRandomValues.bind(crypto)}return S0(V6)}const U6=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),u_={randomUUID:U6};function j6(t,e,r){var i;t=t||{};const n=t.random??((i=t.rng)==null?void 0:i.call(t))??B6();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,b6(n)}function c_(t,e,r){return u_.randomUUID&&!t?u_.randomUUID():j6(t)}const f_=7,Xo={id:"",name:"",className:"",currentStage:0,scores:[0,0,0,0,0,0,0],totalScore:0,isRegistered:!1,isCompleted:!1},Mw=oe.createContext(void 0),z6=({children:t})=>{const[e,r]=oe.useState(Xo),[n,i]=oe.useState(!0),[s,a]=oe.useState(!1),o=_=>_>=f_,l=async _=>{if(!_.id){console.error("Cannot save user data: ID is missing.");return}const m=s_(Qd,"users",_.id);try{a(!0);const y={name:_.name,className:_.className,currentStage:_.currentStage,scores:_.scores,totalScore:_.totalScore,isRegistered:_.isRegistered,isCompleted:_.isCompleted,lastUpdated:new Date};await D6(m,y,{merge:!0}),console.log("User data saved to Firestore successfully.")}catch(y){console.error("Error saving user data to Firestore:",y)}finally{a(!1)}};oe.useEffect(()=>{(async()=>{let m=localStorage.getItem("adiwiyataUserId");m||(m=c_(),localStorage.setItem("adiwiyataUserId",m));const y=s_(Qd,"users",m);try{const w=await N6(y);if(w.exists()){const x=w.data();r({...Xo,...x,id:m})}else{const x={...Xo,id:m};r(x)}}catch(w){console.error("Error loading user data:",w);const x={...Xo,id:m};r(x)}finally{i(!1)}})()},[]);const u=(_,m)=>{e.id||(e.id=c_());const y={...e,name:_,className:m,isRegistered:!0};r(y),console.log("User registered locally. Will save to Firestore upon completion.")},f=(_,m)=>{r(y=>{const w=[...y.scores];w[_]=m;const x=w.reduce((O,U)=>O+U,0);return{...y,scores:w,totalScore:x}})},h=async()=>{const _=e;if(_.currentStage>=f_){console.warn("All stages already completed.");return}const m=_.currentStage+1,y=o(m),w={..._,currentStage:m,isCompleted:y};r(w),y?(console.log("All stages completed! Saving to Firestore..."),await l(w)):console.log(`Advanced to stage ${m}. Progress saved locally.`)},d=()=>{const _={...Xo};r(_),localStorage.removeItem("adiwiyataUserId"),console.log("Progress reset. Starting fresh locally.")},g=o(e.currentStage);return n?M.jsx("div",{children:"Loading..."}):M.jsx(Mw.Provider,{value:{user:e,register:u,updateScore:f,advanceStage:h,resetProgress:d,isSaving:s,isAllStagesCompleted:g},children:t})},_h=()=>{const t=oe.useContext(Mw);if(t===void 0)throw new Error("useUser must be used within a UserProvider");return t};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),H6=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),h_=t=>{const e=H6(t);return e.charAt(0).toUpperCase()+e.slice(1)},bw=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),W6=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var G6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=oe.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:a,...o},l)=>oe.createElement("svg",{ref:l,...G6,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:bw("lucide",i),...!s&&!W6(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,f])=>oe.createElement(u,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=(t,e)=>{const r=oe.forwardRef(({className:n,...i},s)=>oe.createElement(K6,{ref:s,iconNode:e,className:bw(`lucide-${$6(h_(t))}`,`lucide-${t}`,n),...i}));return r.displayName=h_(t),r};/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],X6=lr("book",q6);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Y6=lr("chevron-down",Q6);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Z6=lr("chevron-right",J6);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Vw=lr("circle-check-big",eF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Bw=lr("circle-x",tF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],nF=lr("download",rF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],sF=lr("droplets",iF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],oF=lr("file-spreadsheet",aF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],uF=lr("file-text",lF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Uw=lr("house",cF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],Ua=lr("leaf",fF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],dF=lr("lightbulb",hF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]],mF=lr("recycle",pF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],vF=lr("refresh-cw",gF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],xF=lr("sun",_F);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]],EF=lr("tree-pine",yF);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],TF=lr("trophy",wF),SF=()=>M.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-transparent p-4",children:[M.jsxs("div",{className:"max-w-3xl w-full bg-white rounded-xl shadow-lg overflow-hidden",children:[M.jsxs("div",{className:"bg-green-600 p-6 text-white text-center",children:[M.jsx("div",{className:"flex justify-center mb-4",children:M.jsx("div",{className:"bg-white rounded-full p-3",children:M.jsx(Ua,{className:"w-12 h-12 text-green-600"})})}),M.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"Adiwiyata Adventure"}),M.jsx("p",{className:"mt-2 text-green-100",children:"Pelajari tentang pelestarian lingkungan dan jadilah petualang Adiwiyata!"})]}),M.jsxs("div",{className:"p-6 md:p-8",children:[M.jsxs("div",{className:"space-y-4 mb-6",children:[M.jsxs("div",{className:"flex items-start",children:[M.jsx("div",{className:"bg-green-100 rounded-full p-2 mr-3",children:M.jsx(Ua,{className:"w-5 h-5 text-green-600"})}),M.jsxs("div",{children:[M.jsx("h3",{className:"font-medium text-green-800",children:"7 Tahap Pembelajaran"}),M.jsx("p",{className:"text-sm text-gray-600",children:"Jelajahi 7 tahap tentang Adiwiyata dan ke enam aspeknya!"})]})]}),M.jsxs("div",{className:"flex items-start",children:[M.jsx("div",{className:"bg-green-100 rounded-full p-2 mr-3",children:M.jsx(Ua,{className:"w-5 h-5 text-green-600"})}),M.jsxs("div",{children:[M.jsx("h3",{className:"font-medium text-green-800",children:"Jawab Kuis"}),M.jsx("p",{className:"text-sm text-gray-600",children:"Uji pengetahuanmu dengan kuis di setiap tahap!"})]})]}),M.jsxs("div",{className:"flex items-start",children:[M.jsx("div",{className:"bg-green-100 rounded-full p-2 mr-3",children:M.jsx(Ua,{className:"w-5 h-5 text-green-600"})}),M.jsxs("div",{children:[M.jsx("h3",{className:"font-medium text-green-800",children:"Leaderboard"}),M.jsx("p",{className:"text-sm text-gray-600",children:"Lihat peringkatmu dibandingkan dengan siswa lain!"})]})]})]}),M.jsx(fI,{to:"/register",className:"block w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg text-center transition-colors duration-300",children:"Mulai Petualanganmu!"})]})]}),M.jsx("p",{className:"mt-6 text-sm text-green-800",children:"Adiwiyata Adventure - SMP Negeri 1 Gedangan"})]}),AF=()=>{const[t,e]=oe.useState(""),[r,n]=oe.useState(""),[i,s]=oe.useState(""),{register:a,resetProgress:o}=_h(),l=pu(),u=f=>{if(f.preventDefault(),!t.trim()){s("Masukkan namamu terlebih dahulu");return}if(!r.trim()){s("Masukkan kelasmu terlebih dahulu");return}o(),a(t,r),l("/stage/0")};return M.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-green-50 to-green-100 p-4",children:M.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg overflow-hidden",children:[M.jsxs("div",{className:"bg-green-600 p-6 text-white text-center",children:[M.jsx("div",{className:"flex justify-center mb-4",children:M.jsx("div",{className:"bg-white rounded-full p-3",children:M.jsx(Ua,{className:"w-10 h-10 text-green-600"})})}),M.jsx("h1",{className:"text-2xl font-bold",children:"Bergabunglah dalam Petualangan!"}),M.jsx("p",{className:"mt-1 text-green-100",children:"Daftar untuk mulai menjelajahi Adiwiyata"})]}),M.jsx("div",{className:"p-6",children:M.jsxs("form",{onSubmit:u,children:[i&&M.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg mb-4 text-sm",children:i}),M.jsxs("div",{className:"mb-4",children:[M.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Masukkan Namamu!"}),M.jsx("input",{type:"text",id:"name",value:t,onChange:f=>e(f.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-colors",placeholder:"Masukkan nama lengkapmu"})]}),M.jsxs("div",{className:"mb-6",children:[M.jsx("label",{htmlFor:"class",className:"block text-sm font-medium text-gray-700 mb-1",children:"Masukkan Kelasmu!"}),M.jsx("input",{type:"text",id:"class",value:r,onChange:f=>n(f.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-colors",placeholder:"Contoh: 7A, 8B, 9C"})]}),M.jsx("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg text-center transition-colors duration-300",children:"Mulai Petualangan!"})]})})]})})},Ts=[{id:0,title:"Pembahasan Adiwiyata",icon:M.jsx(X6,{className:"w-6 h-6 text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Kalian tau ga sih apa itu adiwiyata?"}),M.jsx("p",{className:"mb-4 text-lg",children:"Jadi adiwiyata adalah penghargaan untuk sekolah yang peduli dengan lingkungan. Pada dasarnya, adiwiyata merupakan program yang ditujukan untuk mengatasi berbagai masalah terkait pencemaran lingkungan, adiwiyata mengajarkan kita untuk mencintai lingkungan hidup. Contohnya pengelolaan sampah (pemilahan, daur ulang, pembuatan kompos.), penghijaun (penanaman pohon, pembuatan taman.), penyediaan fasilitas (tong sampah, dan cuci tangan)."}),M.jsx("p",{className:"mb-4 text-lg",children:"Kira-kira kalian udah tau belum kalau spensaged memiliki banyak pokja (kelompok kerja) yaitu pokja sanitasi, pokja inovasi, pokja konservasi energi, pokja konsevasi air, pokja UKS, pokja PJAS/kantin sehat, nah spensaged mendapatkan penghargaan juara 1 lomba PJAS aman Tingkat nasional. Bangga ga sih kalian jadi warga spensaged yang sudah memenangkan PJAS Tingkat nasional."})]}),questions:[{id:1,text:"Program adiwiyata merupakan Program yang di tujukan untuk?",options:["Untuk mencitai lingkungan sekitar","Untuk mencintai lingkungan hidup","Untuk mencintai alam"],correctAnswer:1},{id:2,text:"Spensaged memenangkan penghargaan dalam pokja apa?",options:["Konservasi energi","Inovasi","pangan jajan anak sekolah"],correctAnswer:2},{id:3,text:"Contoh kegiatan adiwiyata yang ada di sekolah?",options:["Pembuatan kompos","Pembasmian serangga","Penyediaan trash bag di area sekolah"],correctAnswer:0}]},{id:1,title:"Aspek 1: Kebersihan dan Fungsi Sanitasi",icon:M.jsx(Ua,{className:"w-6 h-6 text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Nah disini kalian pernah mendengar/tidak mengenai aspek yang ada dalam adiwiyata. Jadi didalam adiwiyata terdapat 6 aspek."}),M.jsxs("p",{className:"mb-4 text-lg",children:["Aspek yang pertama ",M.jsx("b",{children:"kebersihan dan fungsi sanitasi"}),". Sanitasi merupakan upaya menjaga kebersihan lingkungan dan kesehatan masyarakat melalui pengawasan terhadap faktor lingkungan. Fungi sanitasi sendiri mencegah penyakit dan meningkatkan kesehatan masyarakat dengan cara mengelola lingkungan hidup secara bersih dan sehat melalui pengelolaan air, limbah, sampah, serta kebiasaan hidup bersih dan sehat. Di dalam aspek yang pertama ini meliputi upaya menjaga kebersihan sekolah secara menyeluruh, termasuk menjaga kebersihan toilet, tidak membuang sampah di area dekat sekolah, menjaga kebersihan masjid, dan menjaga lingkungan hutan sekolah agar sekolah menjadi lebih asri, dan pemeliharaan drainase secara rutin."]})]}),questions:[{id:1,text:"Apa fungsi sanitasi di area sekolah",options:["Membuang sampah pada tempatnya","Mengotori area masjid","Mematahkan ranting pohon sembarangan"],correctAnswer:0},{id:2,text:"Dalam bacaan disebutkan bahwa fungsi sanitasi dalah mencegah penyakit dengan cara mengelola lingkungan hidup yang sehat. Jika sekolah sudah memiliki salura drainase yang baik, namun siswa masih sering membuang sampah sembarangan, dampak apa yang paling mungkin terjadi?",options:["Sekolah tetap bersih karena drainase sudah memadai","Air hujan akan membawa sampah sehingga menimbulkan banjir dan penyakit","Sampah tidak berpengaruh pada kesehatan warga sekolah"],correctAnswer:1},{id:3,text:"Bacaan menyebutkan bahwa menjaga kebersihan sekolah mencakup area masjid, hutan sekolah, dan saluran air. Jika suatu sekolah hanya focus membersihakn area masjid tetapi mengabaikan hutan sekolah, nilai karakter apa yang paling tidak tercermin dalam upaya tersebut?",options:["Tanggung jawab terhadap lingkungan","Disiplin menjaga fasilitas sekolah","Kepedulian terhadap Kesehatan"],correctAnswer:1}]},{id:2,title:"Aspek 2: Pengelolaan Sampah",icon:M.jsx(mF,{className:"w-6 h-6  text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Kamu tau nggak kenapa tong sampah ada 3 jenisnya?"}),M.jsx("p",{className:"text-lg",children:"Ternyata itu karena jenis sampah berbeda beda dan harus dikelompokkan masing masing. Disekolah kita ada 3 jenis tong sampah yaitu:"}),M.jsxs("ol",{className:"mt-4 list-decimal ml-8 text-lg",children:[M.jsxs("li",{children:[M.jsx("b",{children:"Tong sampah hijau:"})," Fungsinya adalah menampung sampah organik, seperti sisa plastik, daun dan ranting."]}),M.jsxs("li",{children:[M.jsx("b",{children:"Tong sampah kuning:"})," Fungsinya adalah menampung sampah anorganik, seperti sisa plastik, styrofom dan kaleng."]}),M.jsxs("li",{children:[M.jsx("b",{children:"Tong sampah merah:"})," Fungsinya adalah menampung limbah  B3(berbahayadanberacun) Contoh:baterai,komponen elektronik,dan limba medis."]})]}),M.jsx("p",{className:"mt-4 text-lg",children:"Sebenarnya kalau sampah dikelola dengan benar, sampah bisa bermanfaat lho. Misalnya:"}),M.jsxs("ul",{className:"mt-4 list-disc ml-8 text-lg",children:[M.jsxs("li",{children:[M.jsx("b",{children:"Sampah organik"})," (daun, sisa makanan) bisa dijadikan kompos buat pupuk tanaman sekolah."]}),M.jsxs("li",{children:[M.jsx("b",{children:"Sampah anorganik"})," (plastik, botol, kertas) bisa dipilah, terus didaur ulang atau dijual."]})]}),M.jsx("p",{className:"mt-4 text-lg",children:"Intinya: Mengelola sampah bukan cuma bikin sekolah bersih, tapi juga melatih kita buat lebih peduli sama lingkungan. Jadi, daripada buang sampah sembarangan, mending kita kelola dengan cerdas dan kreatif."})]}),questions:[{id:1,text:"Jika sekolah ingin mengurangi jumlah sampah plastic, sebagai siswa, sikap apa yang kita ambil untuk membantu sekolah?",options:["Membawa masuk jajanan dari luar sekolah yang menggunakan kemasan plastic","Tidak membawa kemasan plastik kedalam sekolah","Membuang sampah pada tempatnya"],correctAnswer:1},{id:2,text:"Disekolah ada 3 jenis sampah tong sampah, saat siswa ingin membuang limbah bekas komponen elektronik ke sampah hijau, padahal fungsi tong sampah hijau untuk limbah organic, apa dampak yang mungkin terjadi?",options:["Mengurangi jumlah sampah B3 yang menumpuk","Mempermudah pemilahan sampah","Mendukung penghijaun sekolah"],correctAnswer:1},{id:3,text:"Sampah organik seperti daun daun sisa bisa, dijadikan pupuk kompos, jika kegiatan ini dilakukan secara rutin disekolah, manfaat yang akan dirasakan adalah?",options:["Mempercapat proses daur ulang sampah plastic","Mengurangi jumlah samapah B3","Mendukung penghijauan sekolah dengan pupuk alami dari sampah kita sendiri"],correctAnswer:2}]},{id:3,title:"Aspek 3: Penanaman dan Pemeliharaan Pohon",icon:M.jsx(EF,{className:"w-6 h-6  text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Kalian tau gak nih aspek ketiga dalam adiwiyata adalah penanaman pohon dan pemeliharaan pohon atau tanaman di lingkungan sekolah?"}),M.jsx("p",{className:"mb-4 text-lg",children:"Kegiatan ini bermanfaat bukan sekedar untuk membuat sekolah terlihat hijau, tapi juga menjaga kualitas udara, mencegah banjir lewat resapan air, serta mengurangi populasi debu, jenis tanaman yang ditanam di lingkungan sekolah biasanya menyesuaikan kebutuhan dan lahan di sekolah."}),M.jsxs("p",{className:"mb-4 text-lg",children:["Contoh jenis tanaman yang ada di spensaged adalah ",M.jsx("b",{children:"tanaman pule "}),"yang banyak terletak di sekeliling lapangan basket. Tanaman pule ini ditanam bertujuan untuk menyerap polusi, mengingat di daerah kita sering macet yang mengakibatkan banyak kendaraan yang melepaskan karbon monoksida yang mencemari udara."]}),M.jsx("p",{className:"mb-4 text-lg",children:"Jadi aspek ketiga mengajarkan pentingnya menanam dan merawat berbagai jenis tanaman di sekolah untuk manfaat bagi diri kita sendiri maupun lingkungan sekitar kita."})]}),questions:[{id:1,text:"Salah satu tujuan penanaman pohon di sekolah adalah mencegah banjir melalui resapan air. Tapi jika sekolah hanya menanam tanaman hias kecil dipot tanpa ada pohon besar, apa dampak yang mungkin terjadi?",options:["Sekolah tetap aman dari banjir karena ada tanaman hias","Fungsi dari resapan air berkurang sehingga risiko banjir jadi lebih besar","Udara di sekolah otomatis tetap segar meskipun tidak ada pohon besar"],correctAnswer:1},{id:2,text:"Di teks dijelaskan bahwa tanaman pule banyak ditanam di sekitar lapangan basket sekolah. Mengapa pilihan ini dianggap tepat?",options:["Karena pule sebagai tanaman hias","Karena pule mampu menyerap polusi dan mengurangi karbon monoksida dari kendaraan","Karena pule membutuhkan sedikit perawatan dan bisa tumbuh tanpa air"],correctAnswer:1},{id:3,text:"Aspek ketiga adiwiyata menekankan pentingnya merawat tanaman, bukan hanya menanamnya. Jika siswa hanya menanam tanpa merawat, apa akibatnya?",options:["Tanaman tetap tumbuh subur karena tetap tumbuh di tanah","Tanaman bisa mati atau tidak berkembang sehingga tujuan limgkungan sehat tidak tercapai","Tanaman tetap memberi oksigen meskipun tidak dirawat"],correctAnswer:1}]},{id:4,title:"Aspek 4: Konservasi Air",icon:M.jsx(sF,{className:"w-6 h-6  text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Gimana sih Konservasi Air itu?"}),M.jsx("p",{className:"mb-4 text-lg",children:"Konservasi Air pada dasarnya mengajarkan kita untuk lebih bijak dalam menggunakan air, karena air adalah sumber kehidupan yang tidak bisa tergantikan. Konservasi air adalah perilaku yang disengaja dengan tujuan mengurangi penggunaan air, melalui metode teknologi atau perilaku sosial."}),M.jsx("p",{className:"mb-4 text-lg",children:"Di dalam sekolah kita bisa melakukan hal hal sederhana untuk konservasi air, contohnya : menutup keran air setelah di pakai, menggunakan air secukupnya saat mencuci tangan. Jadi siswa bisa menerapkan sistem hemat air agar terbiasa, sekolah tidak hanya menjadi tempat belajar, tetapi juga contoh nyata bagaimana menjaga bumi."}),M.jsx("p",{className:"mb-4 text-lg",children:"Kebiasaan ini juga menanamkan rasa peduli lingkungan sejak dini. Jadi konservasi air bukan hanya soal mengurangi pemakaian, tapi juga memanfaatkan air dengan cerdas."})]}),questions:[{id:1,text:"Jika siswa terbiasa menutup keran dengan benar setelah dipakai, dampak positif jangka panjang yang paling nyata adalah",options:["Mengurangi pemborosan air dan melatih kebiasaan hemat sejak dini","Air akan selalu tersedia tanpa batas di sekolah","Sekolah tidak perlu membayar biaya air bulanan"],correctAnswer:0},{id:2,text:"Salah satu bentuk konservasi Air adalah menggunakan air secukupnya saat mencuci tangan. Jika siswa justru membuka keran terlalu besar, apa konsekuensi yang mungkin terjadi?",options:["Proses mencuci tangan lebih cepat dan lebih bersih","Air terbuang sia-sia sehingga berlawanan dengan prinsip konservasi","Tidak ada dampak karena air akan kembali ke tanah"],correctAnswer:1},{id:3,text:"Konservasi air di sekolah bukan hanya soal mengurangi pemakaian, tapi jugsa memanfaatkan air dengan cerdas. Contoh penerapan sikap ini adalah",options:["Menggunakan air bekas wudhu untuk menyiram tanaman sekolah.","Membiarkan air hujan mengalir begitu saja di selokan.","Membuka semua keran saat membersihkan kelas agar pekerjaan lebih cepat selesai"],correctAnswer:0}]},{id:5,title:"Aspek 5: Konservasi Energi",icon:M.jsx(xF,{className:"w-6 h-6  text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Apakah kalian tahu? aspek kelima dalam adiwiyata adalah konservasi energi."}),M.jsx("p",{className:"mb-4 text-lg",children:"Konservasi energi yaitu bagaimana cara kita menggunakan energi dengan bijak supaya tidak boros."}),M.jsx("p",{className:"mb-4 text-lg",children:"Energi itu bukan hanya listrik di sekolah, tapi juga bensin untuk kendaran atau bahkan cahaya matahari yang bisa dimanfaatkan."}),M.jsx("p",{className:"mb-4 text-lg",children:"Di sekolah, kita bisa mulai dari hal-hal kecil, misalnya mematikan lampu di siang hari, mencabut charger setelah dipakai, atau lebih memilih naik sepeda/berjalan kaki dari pada motor kalau jarak dari rumah dekat."}),M.jsx("p",{className:"mb-4 text-lg",children:"Kebiasaan kecil ini ternyata berdampak besar lho, karena selain menghemat biaya sekolah, juga membantu mengurangi polusi dan pemanasan global."}),M.jsx("p",{className:"mb-4 text-lg",children:"Jadi, intinya konservasi energi adalah tindakan mengurangi jumlah energi, menghemat energi berarti menggunakan energi listrik bukan untuk suatu hal yang tidak berguna."})]}),questions:[{id:1,text:"Jika sekolah memanfaatkan cahaya alami di siang hari, dampak jangka Panjang yang paling tepat adalah",options:["Ruangan jadi lebih panas karena sinar matahari langsung","Konsumsi listrik berkurang sehingga biaya dan emisi energi lebih rendah","Siswa tidak perlu lagi menggunakan listrik untuk kegiatan lain"],correctAnswer:1},{id:2,text:"Seorang siswa memilih naik sepeda ke sekolah daripada di jemput motor. Hal ini termasuk konservasi energi karena",options:["Membuat tubuh lebih sehat dan kuat","Menambah jumlah kendaraan ramah lingkungan di sekolah","Mengurangi ketergantungan pada bahan bakar fosil yang menghasilkan polusi"],correctAnswer:2},{id:3,text:"Mematikan kipas angin saat kelas kosong adalah contoh konservasi energi karena",options:["Menghindari pemborosan listrik dengan cara sederhana yang bisa dilakukan semua siswa","Membuat ruangan lebih dingin sehingga nyaman saat dipakai","Mengurangi ketergantungan pada cahaya alami"],correctAnswer:0}]},{id:6,title:"Aspek 6: Inovasi Ramah Lingkungan",icon:M.jsx(dF,{className:"w-6 h-6  text-green-600"}),content:M.jsxs("div",{children:[M.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4",children:"Gimana kita bisa ciptakan inovasi ramah lingkungan?"}),M.jsx("p",{className:"mb-4 text-lg",children:"Pada aspek keenam dalam adiwiyata adalah inovasi ramah lingkungan, inovasi ramah lingkungan adalah segala jenis pengembangan produk, proses, atau model yang dirancang untuk meminimalkan dampak negatif terhadap lingkungan dan mendukug pembangunan berkelanjutan, dengan cara mengurangi konsumsi sumber daya energi, limbah, dan polusi, serta memanfaatkan bahan yang dapat di daur ulang."}),M.jsx("p",{className:"mb-4 text-lg",children:"Di sekolah, inovasi ini bisa berupa hal sederhana tapi bermanfaat, misalnya membuat ecobrick dari botol plastik berisi sampah organik, ecobrick adalah botol plastik yang telah dipadatkan untuk membuat sejenis blok yang dapat digunakan kembali, konsep dibalik ecobrick adalah untuk menggunakan dan mendaur ulang plastik bekas konsumsi, membuatnya jadi ramah lingkungan dan bermanfaat."}),M.jsx("p",{className:"mb-4 text-lg",children:"Bahkan, ide-ide kecil seperti memanfaatkan sampah bekas gelas plastik menjadi hiasan itu juga termasuk inovasi lho! Intinya, kita kita diajak untuk nggak cuma mengikuti aturan, tapi juga berpikir kreaif dan solutif supaya sekolah makin hijau, sehat, dan jadi contoh keren bagi lingkungan sekitar."})]}),questions:[{id:1,text:"Dari bacaan diatas, apa alasan utama eco-brick dianggap sebagai inovasi ramah lingkungan?",options:["Karena mampu mengurangi jumlah sampah plastic yang sulit terurai sambil menghasilkan produk yang bermanfaat","Karena menjadikan botol plastik lebih menarik secara estetika","Karena lebih cepat dibuat dibandingkan dengan daur ulang biasa"],correctAnswer:0},{id:2,text:"Pada bacaan di jelaskan konsep di balik ecobrick, dari konsep tersebut apa yang ada di sekolahmu?",options:["Membuat pupuk kompos","Menanam tanaman hidroponik","Membuat hiasan kelas dengan menggunakan botol bekas"],correctAnswer:2},{id:3,text:"Sebuah kelas ingin ikut lomba adiwiyata. Mereka punya banyak kertas bekas ujian. Agar sesuai dengan semangat kreatif sekaligus ramah lingkungan, langah terbaik yang bisa mereka lakukan adalah",options:["Membakar kertas bekas supaya cepat habis","Mengubah kertas bekas menjadi kerajinan tangan bernilai guna","Membuang semua kertas ke tempat sampah tanpa dipilah"],correctAnswer:1}]}],kF=()=>{const t=localStorage.getItem("adiwiyataLeaderboard");return t?JSON.parse(t):[]},IF=t=>{const e=kF(),r=e.findIndex(n=>n.name===t.name&&n.className===t.className);return r>=0?t.totalScore>e[r].totalScore&&(e[r].totalScore=t.totalScore):e.push({name:t.name,className:t.className,totalScore:t.totalScore}),e.sort((n,i)=>i.totalScore-n.totalScore),localStorage.setItem("adiwiyataLeaderboard",JSON.stringify(e)),e},CF=({questions:t,onComplete:e})=>{const[r,n]=oe.useState({}),[i,s]=oe.useState(!1),a=(u,f)=>{i||n(h=>({...h,[u]:f}))},o=()=>{s(!0);let u=0;const f=[];t.forEach((d,g)=>{const _=r[g],m=_===d.correctAnswer;m&&u++,f.push({question:d.text,userAnswer:_!==null?d.options[_]:"Tidak dijawab",correctAnswer:d.options[d.correctAnswer],isCorrect:m})});const h=u*10;e(h,f)},l=t.every((u,f)=>r[f]!==null);return M.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:M.jsxs("form",{onSubmit:u=>{u.preventDefault(),o()},className:"space-y-8",children:[t.map((u,f)=>{const h=r[f],d=i?h===u.correctAnswer:null;return M.jsxs("div",{children:[M.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:[f+1,". ",u.text]}),M.jsx("div",{className:"space-y-2",children:u.options.map((g,_)=>{let m="w-full text-left p-3 rounded-lg border transition-colors";return i?_===u.correctAnswer?m+=" bg-green-100 border-green-500 font-medium text-green-800":h===_?m+=" bg-red-100 border-red-500 font-medium text-red-800":m+=" border-gray-200":h===_?m+=" bg-blue-50 border-blue-500":m+=" border-gray-200 hover:bg-gray-50",M.jsxs("button",{type:"button",onClick:()=>a(f,_),className:m,disabled:i,children:[M.jsxs("div",{className:"flex items-center",children:[M.jsx("div",{className:`w-6 h-6 flex items-center justify-center rounded-full mr-3 ${h===_&&!i?"bg-blue-500 text-white":"bg-gray-100"}`,children:String.fromCharCode(65+_)}),M.jsx("span",{children:g})]}),i&&h===_&&(d?M.jsx(Vw,{className:"w-5 h-5 text-green-600 ml-auto"}):M.jsx(Bw,{className:"w-5 h-5 text-red-600 ml-auto"}))]},_)})}),i&&M.jsx("div",{className:`mt-3 p-2 rounded-md font-medium text-sm ${d?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:d?"BENAR":`SALAH. Jawaban benar: ${u.options[u.correctAnswer]}`})]},f)}),!i&&M.jsx("button",{type:"submit",disabled:!l,className:`w-full py-3 rounded-lg font-medium transition-colors ${l?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"Submit Jawaban"})]})})},RF=()=>{const{stageId:t}=Bk(),e=parseInt(t||"0"),{user:r,updateScore:n,advanceStage:i,resetProgress:s,isSaving:a}=_h(),o=pu(),[l,u]=oe.useState(!1),[f,h]=oe.useState(null),d=Ts[e],g=r.scores[e]||0;oe.useEffect(()=>{g>0?u(!0):(u(!1),h(null))},[e,g]);const _=(w,x)=>{u(!0),h(x),n(e,w),e===Ts.length-1&&IF({name:r.name,className:r.className,totalScore:r.totalScore+w})},m=async()=>{await i(),e<Ts.length-1?o(`/stage/${e+1}`):o("/leaderboard")},y=()=>f?M.jsxs("div",{className:"mt-6 border-t pt-4 border-gray-200",children:[M.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Hasil Jawaban"}),M.jsx("div",{className:"space-y-4",children:f.map((w,x)=>M.jsxs("div",{className:`text-left p-4 rounded-lg shadow-sm ${w.isCorrect?"bg-green-100 border-l-4 border-green-500":"bg-red-100 border-l-4 border-red-500"}`,children:[M.jsxs("div",{className:"flex items-center mb-2",children:[w.isCorrect?M.jsx(Vw,{className:"w-5 h-5 text-green-600 mr-2"}):M.jsx(Bw,{className:"w-5 h-5 text-red-600 mr-2"}),M.jsxs("span",{className:"font-semibold text-gray-800",children:["Pertanyaan ",x+1,": ",w.isCorrect?"BENAR":"SALAH"]}),w.isCorrect?M.jsx("span",{className:"font-semibold text-green-800 ml-1",children:"(+10)"}):M.jsx("span",{className:"font-semibold text-red-800 ml-1",children:"(0)"})]}),M.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[M.jsx("b",{children:"Pertanyaan:"})," ",w.question]}),M.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[M.jsx("b",{children:"Jawabanmu: "}),w.userAnswer==w.correctAnswer?M.jsx("span",{className:"font-bold text-green-700",children:w.userAnswer}):M.jsx("span",{className:"font-bold text-red-700",children:w.userAnswer})]}),!w.isCorrect&&M.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[M.jsx("b",{children:"Jawaban Benar:"})," ",M.jsx("span",{className:"font-bold text-green-700",children:w.correctAnswer})]})]},x))})]}):null;return M.jsx("div",{className:"min-h-screen bg-green-50 py-8 px-4",children:M.jsxs("div",{className:"max-w-4xl mx-auto",children:[M.jsxs("div",{className:"flex justify-between items-center mb-6",children:[M.jsxs("button",{onClick:()=>{s(),o("/")},className:"flex items-center text-green-700 hover:text-green-900",children:[M.jsx(Uw,{className:"w-5 h-5 mr-1"}),M.jsx("span",{children:"Halaman Awal"})]}),M.jsxs("div",{className:"text-sm text-green-700 text-right",children:[M.jsx("span",{className:"font-semibold",children:r.name})," | Kelas:"," ",r.className,M.jsxs("div",{className:"font-bold text-base text-green-800",children:["Total Skor: ",r.totalScore]})]})]}),M.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-6",children:M.jsx("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:`${(e+1)/Ts.length*100}%`}})}),M.jsxs("div",{className:"flex justify-between items-center mb-4",children:[M.jsxs("span",{className:"text-sm font-medium text-green-800",children:["Stage ",e+1," dari ",Ts.length]}),l?M.jsx("button",{onClick:m,className:"flex items-center text-green-700 hover:text-green-900 disabled:text-gray-400 disabled:cursor-not-allowed",disabled:a,children:a?M.jsx(M.Fragment,{children:"Menyimpan..."}):M.jsxs(M.Fragment,{children:[e<Ts.length-1?"Lanjut ke Stage Berikutnya":"Lihat Leaderboard",M.jsx(Z6,{className:"w-5 h-5 ml-1"})]})}):M.jsx("div",{className:"w-24"})]}),M.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[M.jsx("div",{className:"bg-green-600 p-4 md:p-6 text-white",children:M.jsxs("div",{className:"flex items-center",children:[M.jsx("div",{className:"bg-white rounded-full p-2 mr-3",children:d.icon}),M.jsx("div",{children:M.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:d.title})})]})}),M.jsxs("div",{className:"p-4 md:p-6",children:[M.jsx("div",{className:"prose max-w-none text-gray-700 mb-8",children:d.content}),M.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[M.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Kuis: ",d.title]}),M.jsx("p",{className:"mb-4",children:"Petunjuk: kerjakan soal ini sesuai yang sudah kalian baca !!"}),l?M.jsxs("div",{className:"mt-6 text-center",children:[M.jsxs("div",{className:"text-2xl text-green-700",children:["Skormu untuk Stage ini: ",g]}),M.jsxs("div",{className:"text-2xl font-bold text-green-700 mb-4",children:["Skor total sementara: ",r.totalScore]}),y(),M.jsx("button",{onClick:m,className:"bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-300 mt-6",disabled:a,children:a?"Menyimpan...":e<Ts.length-1?"Lanjut ke Stage Berikutnya":"Lihat Leaderboard"})]}):M.jsx(CF,{questions:d.questions,onComplete:(w,x)=>_(w,x||[])})]})]})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var wf={};wf.version="0.18.5";var jw=1252,PF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zw=function(t){PF.indexOf(t)!=-1&&(jw=t)};function NF(){zw(1252)}var tu=function(t){zw(t)};function FF(){tu(1200),NF()}var lc=function(e){return String.fromCharCode(e)},d_=function(e){return String.fromCharCode(e)},Tf,Mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ru(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Mi.charAt(s)+Mi.charAt(a)+Mi.charAt(o)+Mi.charAt(l);return e}function hi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Mi.indexOf(t.charAt(u++)),a=Mi.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Mi.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Mi.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var He=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gi=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function qs(t){return He?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function p_(t){return He?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var _n=function(e){return He?gi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function xh(t){if(typeof ArrayBuffer>"u")return _n(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Eu(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function DF(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var tr=He?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:gi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function OF(t){for(var e=[],r=0,n=t.length+250,i=qs(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=qs(65535),n=65530)}return e.push(i.slice(0,r)),tr(e)}var wl=/\u0000/g,uc=/[\u0001-\u0006]/g;function Qa(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function yn(t,e){var r=""+t;return r.length>=e?r:Et("0",e-r.length)+r}function bm(t,e){var r=""+t;return r.length>=e?r:Et(" ",e-r.length)+r}function Sf(t,e){var r=""+t;return r.length>=e?r:r+Et(" ",e-r.length)}function LF(t,e){var r=""+Math.round(t);return r.length>=e?r:Et("0",e-r.length)+r}function MF(t,e){var r=""+t;return r.length>=e?r:Et("0",e-r.length)+r}var m_=Math.pow(2,32);function xa(t,e){if(t>m_||t<-m_)return LF(t,e);var r=Math.round(t);return MF(r,e)}function Af(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var g_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],A0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bF(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},v_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},VF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function kf(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,f=0,h=Math.floor(i);u<e&&(h=Math.floor(i),o=h*a+s,f=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=u,u=f;if(f>e&&(u>e?(f=l,o=s):(f=u,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function cc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=WF(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var $w=new Date(1899,11,31,0,0,0),BF=$w.getTime(),UF=new Date(1900,2,1,0,0,0);function Hw(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=UF&&(r+=24*60*60*1e3),(r-(BF+(t.getTimezoneOffset()-$w.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Vm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jF(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zF(t){var e=t<0?12:11,r=Vm(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function $F(t){var e=Vm(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function HF(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=zF(t):e===10?r=t.toFixed(10).substr(0,12):r=$F(t),Vm(jF(r.toUpperCase()))}function Yd(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):HF(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return as(14,Hw(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function WF(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function GF(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return A0[r.m-1][1];case 5:return A0[r.m-1][0];default:return A0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return g_[r.q][0];default:return g_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?yn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=yn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?yn(l,u):"";return f}function bi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Ww=/%/g;function KF(t,e,r){var n=e.replace(Ww,""),i=e.length-n.length;return ti(t,n,r*Math.pow(10,2*i))+Et("%",i)}function qF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ti(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Gw(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Gw(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Kw=/# (\?+)( ?)\/( ?)(\d+)/;function XF(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Et(" ",t[1].length+1+t[4].length):bm(a,t[1].length)+t[2]+"/"+t[3]+yn(o,t[4].length))}function QF(t,e,r){return r+(e===0?"":""+e)+Et(" ",t[1].length+2+t[4].length)}var qw=/^#*0*\.([0#]+)/,Xw=/\).*[0#]/,Qw=/\(###\) ###\\?-####/;function yr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function __(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function x_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function YF(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function JF(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Qr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Xw)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qr("n",n,r):"("+Qr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return qF(t,e,r);if(e.indexOf("%")!==-1)return KF(t,e,r);if(e.indexOf("E")!==-1)return Gw(e,r);if(e.charCodeAt(0)===36)return"$"+Qr(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+xa(l,e.length);if(e.match(/^[#?]+$/))return i=xa(r,0),i==="0"&&(i=""),i.length>e.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(Kw))return XF(s,l,u);if(e.match(/^#+0+$/))return u+xa(l,e.length-e.indexOf("0"));if(s=e.match(qw))return i=__(r,s[1].length).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])).replace(/\.(\d*)$/,function(_,m){return"."+m+Et("0",yr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+__(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+bi(xa(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qr(t,e,-r):bi(""+(Math.floor(r)+YF(r,s[1].length)))+"."+yn(x_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Qr(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qa(Qr(t,e.replace(/[\\-]/g,""),r)),a=0,Qa(Qa(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<i.length?i.charAt(a++):_==="0"?"0":""}));if(e.match(Qw))return i=Qr(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=kf(l,Math.pow(10,a)-1,!1),i=""+u,f=ti("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Sf(o[2],a),f.length<s[4].length&&(f=yr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=kf(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bm(o[1],a)+s[2]+"/"+s[3]+Sf(o[2],a):Et(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=xa(r,0),e.length<=i.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return yr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=x_(r,s[1].length),r<0?"-"+Qr(t,e,-r):bi(JF(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?yn(0,3-_.length):"")+_})+"."+yn(a,s[1].length);switch(e){case"###,##0.00":return Qr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=bi(xa(l,0));return g!=="0"?u+g:"";case"###,###.00":return Qr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Qr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function ZF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ti(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function eD(t,e,r){var n=e.replace(Ww,""),i=e.length-n.length;return ti(t,n,r*Math.pow(10,2*i))+Et("%",i)}function Yw(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Yw(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Xw)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pn("n",n,r):"("+Pn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ZF(t,e,r);if(e.indexOf("%")!==-1)return eD(t,e,r);if(e.indexOf("E")!==-1)return Yw(e,r);if(e.charCodeAt(0)===36)return"$"+Pn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+yn(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(Kw))return QF(s,l,u);if(e.match(/^#+0+$/))return u+yn(l,e.length-e.indexOf("0"));if(s=e.match(qw))return i=(""+r).replace(/^([^\.]+)$/,"$1."+yr(s[1])).replace(/\.$/,"."+yr(s[1])),i=i.replace(/\.(\d*)$/,function(_,m){return"."+m+Et("0",yr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+bi(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pn(t,e,-r):bi(""+r)+"."+Et("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Pn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qa(Pn(t,e.replace(/[\\-]/g,""),r)),a=0,Qa(Qa(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<i.length?i.charAt(a++):_==="0"?"0":""}));if(e.match(Qw))return i=Pn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=kf(l,Math.pow(10,a)-1,!1),i=""+u,f=ti("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Sf(o[2],a),f.length<s[4].length&&(f=yr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=kf(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?bm(o[1],a)+s[2]+"/"+s[3]+Sf(o[2],a):Et(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:yr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return yr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pn(t,e,-r):bi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?yn(0,3-_.length):"")+_})+"."+yn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=bi(""+l);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return Pn(t,e.slice(0,e.lastIndexOf(".")),r)+yr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ti(t,e,r){return(r|0)===r?Pn(t,e,r):Qr(t,e,r)}function tD(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Jw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Zw(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Af(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Jw))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function rD(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Af(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),_=g==="("||g===")"?g:"t";i[i.length]={t:_,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=cc(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=cc(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=cc(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",a+=5,d="h"):(m.t="t",++a),u==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Jw)){if(u==null&&(u=cc(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Zw(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var y=0,w=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",y<1&&(y=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(w=Math.max(w,x[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[a].v.match(/[Hh]/)&&(y=1),y<2&&i[a].v.match(/[Mm]/)&&(y=2),y<3&&i[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var T="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=GF(i[a].t.charCodeAt(0),i[a].v,u,w),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;T+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=Yd(e,r);break}var U="",W,E;if(T.length>0){T.charCodeAt(0)==40?(W=e<0&&T.charCodeAt(0)===45?-e:e,E=ti("n",T,W)):(W=e<0&&n>1?-e:e,E=ti("n",T,W),W<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),O=E.length-1;var S=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){S=a;break}var A=i.length;if(S===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=E.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=E.substr(0,O+1),O=-1),i[a].t="t",A=a);O>=0&&A<i.length&&(i[A].v=E.substr(0,O+1)+i[A].v)}else if(S!==i.length&&E.indexOf("E")===-1){for(O=E.indexOf(".")-1,a=S;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===S?i[a].v.indexOf(".")-1:i[a].v.length-1,U=i[a].v.substr(f+1);f>=0;--f)O>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(U=E.charAt(O--)+U);i[a].v=U,i[a].t="t",A=a}for(O>=0&&A<i.length&&(i[A].v=E.substr(0,O+1)+i[A].v),O=E.indexOf(".")+1,a=S;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==S)){for(f=i[a].v.indexOf(".")>-1&&a===S?i[a].v.indexOf(".")+1:0,U=i[a].v.substr(0,f);f<i[a].v.length;++f)O<E.length&&(U+=E.charAt(O++));i[a].v=U,i[a].t="t",A=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(W=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=ti(i[a].t,i[a].v,W),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var y_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function E_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function nD(t,e){var r=tD(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(y_),o=r[1].match(y_);return E_(e,a)?[n,r[0]]:E_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function as(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:wt)[t],n==null&&(n=r.table&&r.table[v_[t]]||wt[v_[t]]),n==null&&(n=VF[t]||"General");break}if(Af(n,0))return Yd(e,r);e instanceof Date&&(e=Hw(e,r.date1904));var i=nD(n,e);if(Af(i[1]))return Yd(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return rD(i[1],e,r,i[0])}function eT(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(wt[r]==null){e<0&&(e=r);continue}if(wt[r]==t){e=r;break}}e<0&&(e=391)}return wt[e]=t,e}function yh(t){for(var e=0;e!=392;++e)t[e]!==void 0&&eT(t[e],e)}function Eh(){wt=bF()}var tT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iD(t){var e=typeof t=="number"?wt[t]:t;return e=e.replace(tT,"(\\d+)"),new RegExp("^"+e+"$")}function sD(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(tT)||[]).forEach(function(h,d){var g=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:i=g;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var aD=function(){var t={};t.version="1.2.0";function e(){for(var E=0,S=new Array(256),A=0;A!=256;++A)E=A,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,S[A]=E;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(E){var S=0,A=0,I=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)P[I]=E[I];for(I=0;I!=256;++I)for(A=E[I],S=256+I;S<4096;S+=256)A=P[S]=A>>>8^E[A&255];var V=[];for(I=1;I!=16;++I)V[I-1]=typeof Int32Array<"u"?P.subarray(I*256,I*256+256):P.slice(I*256,I*256+256);return V}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],f=i[5],h=i[6],d=i[7],g=i[8],_=i[9],m=i[10],y=i[11],w=i[12],x=i[13],T=i[14];function O(E,S){for(var A=S^-1,I=0,P=E.length;I<P;)A=A>>>8^r[(A^E.charCodeAt(I++))&255];return~A}function U(E,S){for(var A=S^-1,I=E.length-15,P=0;P<I;)A=T[E[P++]^A&255]^x[E[P++]^A>>8&255]^w[E[P++]^A>>16&255]^y[E[P++]^A>>>24]^m[E[P++]]^_[E[P++]]^g[E[P++]]^d[E[P++]]^h[E[P++]]^f[E[P++]]^u[E[P++]]^l[E[P++]]^o[E[P++]]^a[E[P++]]^s[E[P++]]^r[E[P++]];for(I+=15;P<I;)A=A>>>8^r[(A^E[P++])&255];return~A}function W(E,S){for(var A=S^-1,I=0,P=E.length,V=0,N=0;I<P;)V=E.charCodeAt(I++),V<128?A=A>>>8^r[(A^V)&255]:V<2048?(A=A>>>8^r[(A^(192|V>>6&31))&255],A=A>>>8^r[(A^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,N=E.charCodeAt(I++)&1023,A=A>>>8^r[(A^(240|V>>8&7))&255],A=A>>>8^r[(A^(128|V>>2&63))&255],A=A>>>8^r[(A^(128|N>>6&15|(V&3)<<4))&255],A=A>>>8^r[(A^(128|N&63))&255]):(A=A>>>8^r[(A^(224|V>>12&15))&255],A=A>>>8^r[(A^(128|V>>6&63))&255],A=A>>>8^r[(A^(128|V&63))&255]);return~A}return t.table=r,t.bstr=O,t.buf=U,t.str=W,t}(),Je=function(){var e={};e.version="1.2.1";function r(k,D){for(var R=k.split("/"),F=D.split("/"),L=0,b=0,K=Math.min(R.length,F.length);L<K;++L){if(b=R[L].length-F[L].length)return b;if(R[L]!=F[L])return R[L]<F[L]?-1:1}return R.length-F.length}function n(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:n(k.slice(0,-1));var D=k.lastIndexOf("/");return D===-1?k:k.slice(0,D+1)}function i(k){if(k.charAt(k.length-1)=="/")return i(k.slice(0,-1));var D=k.lastIndexOf("/");return D===-1?k:k.slice(D+1)}function s(k,D){typeof D=="string"&&(D=new Date(D));var R=D.getHours();R=R<<6|D.getMinutes(),R=R<<5|D.getSeconds()>>>1,k.write_shift(2,R);var F=D.getFullYear()-1980;F=F<<4|D.getMonth()+1,F=F<<5|D.getDate(),k.write_shift(2,F)}function a(k){var D=k.read_shift(2)&65535,R=k.read_shift(2)&65535,F=new Date,L=R&31;R>>>=5;var b=R&15;R>>>=4,F.setMilliseconds(0),F.setFullYear(R+1980),F.setMonth(b-1),F.setDate(L);var K=D&31;D>>>=5;var Z=D&63;return D>>>=6,F.setHours(D),F.setMinutes(Z),F.setSeconds(K<<1),F}function o(k){Br(k,0);for(var D={},R=0;k.l<=k.length-4;){var F=k.read_shift(2),L=k.read_shift(2),b=k.l+L,K={};switch(F){case 21589:R=k.read_shift(1),R&1&&(K.mtime=k.read_shift(4)),L>5&&(R&2&&(K.atime=k.read_shift(4)),R&4&&(K.ctime=k.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}k.l=b,D[F]=K}return D}var l;function u(){return l||(l={})}function f(k,D){if(k[0]==80&&k[1]==75)return _i(k,D);if((k[0]|32)==109&&(k[1]|32)==105)return Ph(k,D);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var R=3,F=512,L=0,b=0,K=0,Z=0,G=0,q=[],X=k.slice(0,512);Br(X,0);var ie=h(X);switch(R=ie[0],R){case 3:F=512;break;case 4:F=4096;break;case 0:if(ie[1]==0)return _i(k,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}F!==512&&(X=k.slice(0,F),Br(X,28));var ce=k.slice(0,F);d(X,R);var me=X.read_shift(4,"i");if(R===3&&me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+me);X.l+=4,K=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Z=X.read_shift(4,"i"),L=X.read_shift(4,"i"),G=X.read_shift(4,"i"),b=X.read_shift(4,"i");for(var se=-1,pe=0;pe<109&&(se=X.read_shift(4,"i"),!(se<0));++pe)q[pe]=se;var Re=g(k,F);y(G,b,Re,F,q);var nt=x(Re,K,q,F);nt[K].name="!Directory",L>0&&Z!==N&&(nt[Z].name="!MiniFAT"),nt[q[0]].name="!FAT",nt.fat_addrs=q,nt.ssz=F;var it={},Dt=[],Gn=[],Kn=[];T(K,nt,Re,Dt,L,it,Gn,Z),_(Gn,Kn,Dt),Dt.shift();var yi={FileIndex:Gn,FullPaths:Kn};return D&&D.raw&&(yi.raw={header:ce,sectors:Re}),yi}function h(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(Ce,"Header Signature: "),k.l+=16;var D=k.read_shift(2,"u");return[k.read_shift(2,"u"),D]}function d(k,D){var R=9;switch(k.l+=2,R=k.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function g(k,D){for(var R=Math.ceil(k.length/D)-1,F=[],L=1;L<R;++L)F[L-1]=k.slice(L*D,(L+1)*D);return F[R-1]=k.slice(R*D),F}function _(k,D,R){for(var F=0,L=0,b=0,K=0,Z=0,G=R.length,q=[],X=[];F<G;++F)q[F]=X[F]=F,D[F]=R[F];for(;Z<X.length;++Z)F=X[Z],L=k[F].L,b=k[F].R,K=k[F].C,q[F]===F&&(L!==-1&&q[L]!==L&&(q[F]=q[L]),b!==-1&&q[b]!==b&&(q[F]=q[b])),K!==-1&&(q[K]=F),L!==-1&&F!=q[F]&&(q[L]=q[F],X.lastIndexOf(L)<Z&&X.push(L)),b!==-1&&F!=q[F]&&(q[b]=q[F],X.lastIndexOf(b)<Z&&X.push(b));for(F=1;F<G;++F)q[F]===F&&(b!==-1&&q[b]!==b?q[F]=q[b]:L!==-1&&q[L]!==L&&(q[F]=q[L]));for(F=1;F<G;++F)if(k[F].type!==0){if(Z=F,Z!=q[Z])do Z=q[Z],D[F]=D[Z]+"/"+D[F];while(Z!==0&&q[Z]!==-1&&Z!=q[Z]);q[F]=-1}for(D[0]+="/",F=1;F<G;++F)k[F].type!==2&&(D[F]+="/")}function m(k,D,R){for(var F=k.start,L=k.size,b=[],K=F;R&&L>0&&K>=0;)b.push(D.slice(K*V,K*V+V)),L-=V,K=Is(R,K*4);return b.length===0?J(0):tr(b).slice(0,k.size)}function y(k,D,R,F,L){var b=N;if(k===N){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var K=R[k],Z=(F>>>2)-1;if(!K)return;for(var G=0;G<Z&&(b=Is(K,G*4))!==N;++G)L.push(b);y(Is(K,F-4),D-1,R,F,L)}}function w(k,D,R,F,L){var b=[],K=[];L||(L=[]);var Z=F-1,G=0,q=0;for(G=D;G>=0;){L[G]=!0,b[b.length]=G,K.push(k[G]);var X=R[Math.floor(G*4/F)];if(q=G*4&Z,F<4+q)throw new Error("FAT boundary crossed: "+G+" 4 "+F);if(!k[X])break;G=Is(k[X],q)}return{nodes:b,data:R_([K])}}function x(k,D,R,F){var L=k.length,b=[],K=[],Z=[],G=[],q=F-1,X=0,ie=0,ce=0,me=0;for(X=0;X<L;++X)if(Z=[],ce=X+D,ce>=L&&(ce-=L),!K[ce]){G=[];var se=[];for(ie=ce;ie>=0;){se[ie]=!0,K[ie]=!0,Z[Z.length]=ie,G.push(k[ie]);var pe=R[Math.floor(ie*4/F)];if(me=ie*4&q,F<4+me)throw new Error("FAT boundary crossed: "+ie+" 4 "+F);if(!k[pe]||(ie=Is(k[pe],me),se[ie]))break}b[ce]={nodes:Z,data:R_([G])}}return b}function T(k,D,R,F,L,b,K,Z){for(var G=0,q=F.length?2:0,X=D[k].data,ie=0,ce=0,me;ie<X.length;ie+=128){var se=X.slice(ie,ie+128);Br(se,64),ce=se.read_shift(2),me=$m(se,0,ce-q),F.push(me);var pe={name:me,type:se.read_shift(1),color:se.read_shift(1),L:se.read_shift(4,"i"),R:se.read_shift(4,"i"),C:se.read_shift(4,"i"),clsid:se.read_shift(16),state:se.read_shift(4,"i"),start:0,size:0},Re=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);Re!==0&&(pe.ct=O(se,se.l-8));var nt=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);nt!==0&&(pe.mt=O(se,se.l-8)),pe.start=se.read_shift(4,"i"),pe.size=se.read_shift(4,"i"),pe.size<0&&pe.start<0&&(pe.size=pe.type=0,pe.start=N,pe.name=""),pe.type===5?(G=pe.start,L>0&&G!==N&&(D[G].name="!StreamData")):pe.size>=4096?(pe.storage="fat",D[pe.start]===void 0&&(D[pe.start]=w(R,pe.start,D.fat_addrs,D.ssz)),D[pe.start].name=pe.name,pe.content=D[pe.start].data.slice(0,pe.size)):(pe.storage="minifat",pe.size<0?pe.size=0:G!==N&&pe.start!==N&&D[G]&&(pe.content=m(pe,D[G].data,(D[Z]||{}).data))),pe.content&&Br(pe.content,0),b[me]=pe,K.push(pe)}}function O(k,D){return new Date((jr(k,D+4)/1e7*Math.pow(2,32)+jr(k,D)/1e7-11644473600)*1e3)}function U(k,D){return u(),f(l.readFileSync(k),D)}function W(k,D){var R=D&&D.type;switch(R||He&&Buffer.isBuffer(k)&&(R="buffer"),R||"base64"){case"file":return U(k,D);case"base64":return f(_n(hi(k)),D);case"binary":return f(_n(k),D)}return f(k,D)}function E(k,D){var R=D||{},F=R.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=F+"/",k.FileIndex[0]={name:F,type:5}),R.CLSID&&(k.FileIndex[0].clsid=R.CLSID),S(k)}function S(k){var D="Sh33tJ5";if(!Je.find(k,"/"+D)){var R=J(4);R[0]=55,R[1]=R[3]=50,R[2]=54,k.FileIndex.push({name:D,type:2,content:R,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+D),A(k)}}function A(k,D){E(k);for(var R=!1,F=!1,L=k.FullPaths.length-1;L>=0;--L){var b=k.FileIndex[L];switch(b.type){case 0:F?R=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(b.R*b.L*b.C)&&(R=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!D)){var K=new Date(1987,1,19),Z=0,G=Object.create?Object.create(null):{},q=[];for(L=0;L<k.FullPaths.length;++L)G[k.FullPaths[L]]=!0,k.FileIndex[L].type!==0&&q.push([k.FullPaths[L],k.FileIndex[L]]);for(L=0;L<q.length;++L){var X=n(q[L][0]);F=G[X],F||(q.push([X,{name:i(X).replace("/",""),type:1,clsid:dt,ct:K,mt:K,content:null}]),G[X]=!0)}for(q.sort(function(me,se){return r(me[0],se[0])}),k.FullPaths=[],k.FileIndex=[],L=0;L<q.length;++L)k.FullPaths[L]=q[L][0],k.FileIndex[L]=q[L][1];for(L=0;L<q.length;++L){var ie=k.FileIndex[L],ce=k.FullPaths[L];if(ie.name=i(ce).replace("/",""),ie.L=ie.R=ie.C=-(ie.color=1),ie.size=ie.content?ie.content.length:0,ie.start=0,ie.clsid=ie.clsid||dt,L===0)ie.C=q.length>1?1:-1,ie.size=0,ie.type=5;else if(ce.slice(-1)=="/"){for(Z=L+1;Z<q.length&&n(k.FullPaths[Z])!=ce;++Z);for(ie.C=Z>=q.length?-1:Z,Z=L+1;Z<q.length&&n(k.FullPaths[Z])!=n(ce);++Z);ie.R=Z>=q.length?-1:Z,ie.type=1}else n(k.FullPaths[L+1]||"")==n(ce)&&(ie.R=L+1),ie.type=2}}}function I(k,D){var R=D||{};if(R.fileType=="mad")return Nh(k,R);switch(A(k),R.fileType){case"zip":return qt(k,R)}var F=function(me){for(var se=0,pe=0,Re=0;Re<me.FileIndex.length;++Re){var nt=me.FileIndex[Re];if(nt.content){var it=nt.content.length;it>0&&(it<4096?se+=it+63>>6:pe+=it+511>>9)}}for(var Dt=me.FullPaths.length+3>>2,Gn=se+7>>3,Kn=se+127>>7,yi=Gn+pe+Dt+Kn,kn=yi+127>>7,ma=kn<=109?0:Math.ceil((kn-109)/127);yi+kn+ma+127>>7>kn;)ma=++kn<=109?0:Math.ceil((kn-109)/127);var fn=[1,ma,kn,Kn,Dt,pe,se,0];return me.FileIndex[0].size=se<<6,fn[7]=(me.FileIndex[0].start=fn[0]+fn[1]+fn[2]+fn[3]+fn[4]+fn[5])+(fn[6]+7>>3),fn}(k),L=J(F[7]<<9),b=0,K=0;{for(b=0;b<8;++b)L.write_shift(1,ke[b]);for(b=0;b<8;++b)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),b=0;b<3;++b)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:N),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:N),L.write_shift(4,F[1]),b=0;b<109;++b)L.write_shift(-4,b<F[2]?F[1]+b:-1)}if(F[1])for(K=0;K<F[1];++K){for(;b<236+K*127;++b)L.write_shift(-4,b<F[2]?F[1]+b:-1);L.write_shift(-4,K===F[1]-1?N:K+1)}var Z=function(me){for(K+=me;b<K-1;++b)L.write_shift(-4,b+1);me&&(++b,L.write_shift(-4,N))};for(K=b=0,K+=F[1];b<K;++b)L.write_shift(-4,Ze.DIFSECT);for(K+=F[2];b<K;++b)L.write_shift(-4,Ze.FATSECT);Z(F[3]),Z(F[4]);for(var G=0,q=0,X=k.FileIndex[0];G<k.FileIndex.length;++G)X=k.FileIndex[G],X.content&&(q=X.content.length,!(q<4096)&&(X.start=K,Z(q+511>>9)));for(Z(F[6]+7>>3);L.l&511;)L.write_shift(-4,Ze.ENDOFCHAIN);for(K=b=0,G=0;G<k.FileIndex.length;++G)X=k.FileIndex[G],X.content&&(q=X.content.length,!(!q||q>=4096)&&(X.start=K,Z(q+63>>6)));for(;L.l&511;)L.write_shift(-4,Ze.ENDOFCHAIN);for(b=0;b<F[4]<<2;++b){var ie=k.FullPaths[b];if(!ie||ie.length===0){for(G=0;G<17;++G)L.write_shift(4,0);for(G=0;G<3;++G)L.write_shift(4,-1);for(G=0;G<12;++G)L.write_shift(4,0);continue}X=k.FileIndex[b],b===0&&(X.start=X.size?X.start-1:N);var ce=b===0&&R.root||X.name;if(q=2*(ce.length+1),L.write_shift(64,ce,"utf16le"),L.write_shift(2,q),L.write_shift(1,X.type),L.write_shift(1,X.color),L.write_shift(-4,X.L),L.write_shift(-4,X.R),L.write_shift(-4,X.C),X.clsid)L.write_shift(16,X.clsid,"hex");else for(G=0;G<4;++G)L.write_shift(4,0);L.write_shift(4,X.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,X.start),L.write_shift(4,X.size),L.write_shift(4,0)}for(b=1;b<k.FileIndex.length;++b)if(X=k.FileIndex[b],X.size>=4096)if(L.l=X.start+1<<9,He&&Buffer.isBuffer(X.content))X.content.copy(L,L.l,0,X.size),L.l+=X.size+511&-512;else{for(G=0;G<X.size;++G)L.write_shift(1,X.content[G]);for(;G&511;++G)L.write_shift(1,0)}for(b=1;b<k.FileIndex.length;++b)if(X=k.FileIndex[b],X.size>0&&X.size<4096)if(He&&Buffer.isBuffer(X.content))X.content.copy(L,L.l,0,X.size),L.l+=X.size+63&-64;else{for(G=0;G<X.size;++G)L.write_shift(1,X.content[G]);for(;G&63;++G)L.write_shift(1,0)}if(He)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function P(k,D){var R=k.FullPaths.map(function(G){return G.toUpperCase()}),F=R.map(function(G){var q=G.split("/");return q[q.length-(G.slice(-1)=="/"?2:1)]}),L=!1;D.charCodeAt(0)===47?(L=!0,D=R[0].slice(0,-1)+D):L=D.indexOf("/")!==-1;var b=D.toUpperCase(),K=L===!0?R.indexOf(b):F.indexOf(b);if(K!==-1)return k.FileIndex[K];var Z=!b.match(uc);for(b=b.replace(wl,""),Z&&(b=b.replace(uc,"!")),K=0;K<R.length;++K)if((Z?R[K].replace(uc,"!"):R[K]).replace(wl,"")==b||(Z?F[K].replace(uc,"!"):F[K]).replace(wl,"")==b)return k.FileIndex[K];return null}var V=64,N=-2,Ce="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],dt="00000000000000000000000000000000",Ze={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:dt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(k,D,R){u();var F=I(k,R);l.writeFileSync(D,F)}function ye(k){for(var D=new Array(k.length),R=0;R<k.length;++R)D[R]=String.fromCharCode(k[R]);return D.join("")}function Se(k,D){var R=I(k,D);switch(D&&D.type||"buffer"){case"file":return u(),l.writeFileSync(D.filename,R),R;case"binary":return typeof R=="string"?R:ye(R);case"base64":return ru(typeof R=="string"?R:ye(R));case"buffer":if(He)return Buffer.isBuffer(R)?R:gi(R);case"array":return typeof R=="string"?_n(R):R}return R}var Oe;function B(k){try{var D=k.InflateRaw,R=new D;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)Oe=k;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function Q(k,D){if(!Oe)return ms(k,D);var R=Oe.InflateRaw,F=new R,L=F._processChunk(k.slice(k.l),F._finishFlushFlag);return k.l+=F.bytesRead,L}function z(k){return Oe?Oe.deflateRawSync(k):Cu(k)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(k){var D=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(D>>16|D>>8|D)&255}for(var Ee=typeof Uint8Array<"u",de=Ee?new Uint8Array(256):[],Ge=0;Ge<256;++Ge)de[Ge]=Te(Ge);function Me(k,D){var R=de[k&255];return D<=8?R>>>8-D:(R=R<<8|de[k>>8&255],D<=16?R>>>16-D:(R=R<<8|de[k>>16&255],R>>>24-D))}function Ft(k,D){var R=D&7,F=D>>>3;return(k[F]|(R<=6?0:k[F+1]<<8))>>>R&3}function je(k,D){var R=D&7,F=D>>>3;return(k[F]|(R<=5?0:k[F+1]<<8))>>>R&7}function ln(k,D){var R=D&7,F=D>>>3;return(k[F]|(R<=4?0:k[F+1]<<8))>>>R&15}function tt(k,D){var R=D&7,F=D>>>3;return(k[F]|(R<=3?0:k[F+1]<<8))>>>R&31}function _e(k,D){var R=D&7,F=D>>>3;return(k[F]|(R<=1?0:k[F+1]<<8))>>>R&127}function _r(k,D,R){var F=D&7,L=D>>>3,b=(1<<R)-1,K=k[L]>>>F;return R<8-F||(K|=k[L+1]<<8-F,R<16-F)||(K|=k[L+2]<<16-F,R<24-F)||(K|=k[L+3]<<24-F),K&b}function rt(k,D,R){var F=D&7,L=D>>>3;return F<=5?k[L]|=(R&7)<<F:(k[L]|=R<<F&255,k[L+1]=(R&7)>>8-F),D+3}function pt(k,D,R){var F=D&7,L=D>>>3;return R=(R&1)<<F,k[L]|=R,D+1}function un(k,D,R){var F=D&7,L=D>>>3;return R<<=F,k[L]|=R&255,R>>>=8,k[L+1]=R,D+8}function Iu(k,D,R){var F=D&7,L=D>>>3;return R<<=F,k[L]|=R&255,R>>>=8,k[L+1]=R&255,k[L+2]=R>>>8,D+16}function la(k,D){var R=k.length,F=2*R>D?2*R:D+5,L=0;if(R>=D)return k;if(He){var b=p_(F);if(k.copy)k.copy(b);else for(;L<k.length;++L)b[L]=k[L];return b}else if(Ee){var K=new Uint8Array(F);if(K.set)K.set(k);else for(;L<R;++L)K[L]=k[L];return K}return k.length=F,k}function Xr(k){for(var D=new Array(k),R=0;R<k;++R)D[R]=0;return D}function An(k,D,R){var F=1,L=0,b=0,K=0,Z=0,G=k.length,q=Ee?new Uint16Array(32):Xr(32);for(b=0;b<32;++b)q[b]=0;for(b=G;b<R;++b)k[b]=0;G=k.length;var X=Ee?new Uint16Array(G):Xr(G);for(b=0;b<G;++b)q[L=k[b]]++,F<L&&(F=L),X[b]=0;for(q[0]=0,b=1;b<=F;++b)q[b+16]=Z=Z+q[b-1]<<1;for(b=0;b<G;++b)Z=k[b],Z!=0&&(X[b]=q[Z+16]++);var ie=0;for(b=0;b<G;++b)if(ie=k[b],ie!=0)for(Z=Me(X[b],F)>>F-ie,K=(1<<F+4-ie)-1;K>=0;--K)D[Z|K<<ie]=ie&15|b<<4;return F}var ua=Ee?new Uint16Array(512):Xr(512),ca=Ee?new Uint16Array(32):Xr(32);if(!Ee){for(var cn=0;cn<512;++cn)ua[cn]=0;for(cn=0;cn<32;++cn)ca[cn]=0}(function(){for(var k=[],D=0;D<32;D++)k.push(5);An(k,ca,32);var R=[];for(D=0;D<=143;D++)R.push(8);for(;D<=255;D++)R.push(9);for(;D<=279;D++)R.push(7);for(;D<=287;D++)R.push(8);An(R,ua,288)})();var Ih=function(){for(var D=Ee?new Uint8Array(32768):[],R=0,F=0;R<ge.length-1;++R)for(;F<ge[R+1];++F)D[F]=R;for(;F<32768;++F)D[F]=29;var L=Ee?new Uint8Array(259):[];for(R=0,F=0;R<ee.length-1;++R)for(;F<ee[R+1];++F)L[F]=R;function b(Z,G){for(var q=0;q<Z.length;){var X=Math.min(65535,Z.length-q),ie=q+X==Z.length;for(G.write_shift(1,+ie),G.write_shift(2,X),G.write_shift(2,~X&65535);X-- >0;)G[G.l++]=Z[q++]}return G.l}function K(Z,G){for(var q=0,X=0,ie=Ee?new Uint16Array(32768):[];X<Z.length;){var ce=Math.min(65535,Z.length-X);if(ce<10){for(q=rt(G,q,+(X+ce==Z.length)),q&7&&(q+=8-(q&7)),G.l=q/8|0,G.write_shift(2,ce),G.write_shift(2,~ce&65535);ce-- >0;)G[G.l++]=Z[X++];q=G.l*8;continue}q=rt(G,q,+(X+ce==Z.length)+2);for(var me=0;ce-- >0;){var se=Z[X];me=(me<<5^se)&32767;var pe=-1,Re=0;if((pe=ie[me])&&(pe|=X&-32768,pe>X&&(pe-=32768),pe<X))for(;Z[pe+Re]==Z[X+Re]&&Re<250;)++Re;if(Re>2){se=L[Re],se<=22?q=un(G,q,de[se+1]>>1)-1:(un(G,q,3),q+=5,un(G,q,de[se-23]>>5),q+=3);var nt=se<8?0:se-4>>2;nt>0&&(Iu(G,q,Re-ee[se]),q+=nt),se=D[X-pe],q=un(G,q,de[se]>>3),q-=3;var it=se<4?0:se-2>>1;it>0&&(Iu(G,q,X-pe-ge[se]),q+=it);for(var Dt=0;Dt<Re;++Dt)ie[me]=X&32767,me=(me<<5^Z[X])&32767,++X;ce-=Re-1}else se<=143?se=se+48:q=pt(G,q,1),q=un(G,q,de[se]),ie[me]=X&32767,++X}q=un(G,q,0)-1}return G.l=(q+7)/8|0,G.l}return function(G,q){return G.length<8?b(G,q):K(G,q)}}();function Cu(k){var D=J(50+Math.floor(k.length*1.1)),R=Ih(k,D);return D.slice(0,R)}var Co=Ee?new Uint16Array(32768):Xr(32768),Ro=Ee?new Uint16Array(32768):Xr(32768),vi=Ee?new Uint16Array(128):Xr(128),fa=1,ha=1;function Wn(k,D){var R=tt(k,D)+257;D+=5;var F=tt(k,D)+1;D+=5;var L=ln(k,D)+4;D+=4;for(var b=0,K=Ee?new Uint8Array(19):Xr(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],G=1,q=Ee?new Uint8Array(8):Xr(8),X=Ee?new Uint8Array(8):Xr(8),ie=K.length,ce=0;ce<L;++ce)K[j[ce]]=b=je(k,D),G<b&&(G=b),q[b]++,D+=3;var me=0;for(q[0]=0,ce=1;ce<=G;++ce)X[ce]=me=me+q[ce-1]<<1;for(ce=0;ce<ie;++ce)(me=K[ce])!=0&&(Z[ce]=X[me]++);var se=0;for(ce=0;ce<ie;++ce)if(se=K[ce],se!=0){me=de[Z[ce]]>>8-se;for(var pe=(1<<7-se)-1;pe>=0;--pe)vi[me|pe<<se]=se&7|ce<<3}var Re=[];for(G=1;Re.length<R+F;)switch(me=vi[_e(k,D)],D+=me&7,me>>>=3){case 16:for(b=3+Ft(k,D),D+=2,me=Re[Re.length-1];b-- >0;)Re.push(me);break;case 17:for(b=3+je(k,D),D+=3;b-- >0;)Re.push(0);break;case 18:for(b=11+_e(k,D),D+=7;b-- >0;)Re.push(0);break;default:Re.push(me),G<me&&(G=me);break}var nt=Re.slice(0,R),it=Re.slice(R);for(ce=R;ce<286;++ce)nt[ce]=0;for(ce=F;ce<30;++ce)it[ce]=0;return fa=An(nt,Co,286),ha=An(it,Ro,30),D}function Ru(k,D){if(k[0]==3&&!(k[1]&3))return[qs(D),2];for(var R=0,F=0,L=p_(D||1<<18),b=0,K=L.length>>>0,Z=0,G=0;!(F&1);){if(F=je(k,R),R+=3,F>>>1)F>>1==1?(Z=9,G=5):(R=Wn(k,R),Z=fa,G=ha);else{R&7&&(R+=8-(R&7));var q=k[R>>>3]|k[(R>>>3)+1]<<8;if(R+=32,q>0)for(!D&&K<b+q&&(L=la(L,b+q),K=L.length);q-- >0;)L[b++]=k[R>>>3],R+=8;continue}for(;;){!D&&K<b+32767&&(L=la(L,b+32767),K=L.length);var X=_r(k,R,Z),ie=F>>>1==1?ua[X]:Co[X];if(R+=ie&15,ie>>>=4,!(ie>>>8&255))L[b++]=ie;else{if(ie==256)break;ie-=257;var ce=ie<8?0:ie-4>>2;ce>5&&(ce=0);var me=b+ee[ie];ce>0&&(me+=_r(k,R,ce),R+=ce),X=_r(k,R,G),ie=F>>>1==1?ca[X]:Ro[X],R+=ie&15,ie>>>=4;var se=ie<4?0:ie-2>>1,pe=ge[ie];for(se>0&&(pe+=_r(k,R,se),R+=se),!D&&K<me&&(L=la(L,me+100),K=L.length);b<me;)L[b]=L[b-pe],++b}}}return D?[L,R+7>>>3]:[L.slice(0,b),R+7>>>3]}function ms(k,D){var R=k.slice(k.l||0),F=Ru(R,D);return k.l+=F[1],F[0]}function Po(k,D){if(k)typeof console<"u"&&console.error(D);else throw new Error(D)}function _i(k,D){var R=k;Br(R,0);var F=[],L=[],b={FileIndex:F,FullPaths:L};E(b,{root:D.root});for(var K=R.length-4;(R[K]!=80||R[K+1]!=75||R[K+2]!=5||R[K+3]!=6)&&K>=0;)--K;R.l=K+4,R.l+=4;var Z=R.read_shift(2);R.l+=6;var G=R.read_shift(4);for(R.l=G,K=0;K<Z;++K){R.l+=20;var q=R.read_shift(4),X=R.read_shift(4),ie=R.read_shift(2),ce=R.read_shift(2),me=R.read_shift(2);R.l+=8;var se=R.read_shift(4),pe=o(R.slice(R.l+ie,R.l+ie+ce));R.l+=ie+ce+me;var Re=R.l;R.l=se+4,Pu(R,q,X,b,pe),R.l=Re}return b}function Pu(k,D,R,F,L){k.l+=2;var b=k.read_shift(2),K=k.read_shift(2),Z=a(k);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var G=k.read_shift(4),q=k.read_shift(4),X=k.read_shift(4),ie=k.read_shift(2),ce=k.read_shift(2),me="",se=0;se<ie;++se)me+=String.fromCharCode(k[k.l++]);if(ce){var pe=o(k.slice(k.l,k.l+ce));(pe[21589]||{}).mt&&(Z=pe[21589].mt),((L||{})[21589]||{}).mt&&(Z=L[21589].mt)}k.l+=ce;var Re=k.slice(k.l,k.l+q);switch(K){case 8:Re=Q(k,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var nt=!1;b&8&&(G=k.read_shift(4),G==134695760&&(G=k.read_shift(4),nt=!0),q=k.read_shift(4),X=k.read_shift(4)),q!=D&&Po(nt,"Bad compressed size: "+D+" != "+q),X!=R&&Po(nt,"Bad uncompressed size: "+R+" != "+X),pa(F,me,Re,{unsafe:!0,mt:Z})}function qt(k,D){var R=D||{},F=[],L=[],b=J(1),K=R.compression?8:0,Z=0,G=0,q=0,X=0,ie=0,ce=k.FullPaths[0],me=ce,se=k.FileIndex[0],pe=[],Re=0;for(G=1;G<k.FullPaths.length;++G)if(me=k.FullPaths[G].slice(ce.length),se=k.FileIndex[G],!(!se.size||!se.content||me=="Sh33tJ5")){var nt=X,it=J(me.length);for(q=0;q<me.length;++q)it.write_shift(1,me.charCodeAt(q)&127);it=it.slice(0,it.l),pe[ie]=aD.buf(se.content,0);var Dt=se.content;K==8&&(Dt=z(Dt)),b=J(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,Z),b.write_shift(2,K),se.mt?s(b,se.mt):b.write_shift(4,0),b.write_shift(-4,pe[ie]),b.write_shift(4,Dt.length),b.write_shift(4,se.content.length),b.write_shift(2,it.length),b.write_shift(2,0),X+=b.length,F.push(b),X+=it.length,F.push(it),X+=Dt.length,F.push(Dt),b=J(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,Z),b.write_shift(2,K),b.write_shift(4,0),b.write_shift(-4,pe[ie]),b.write_shift(4,Dt.length),b.write_shift(4,se.content.length),b.write_shift(2,it.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,nt),Re+=b.l,L.push(b),Re+=it.length,L.push(it),++ie}return b=J(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,ie),b.write_shift(2,ie),b.write_shift(4,Re),b.write_shift(4,X),b.write_shift(2,0),tr([tr(F),tr(L),b])}var gs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vs(k,D){if(k.ctype)return k.ctype;var R=k.name||"",F=R.match(/\.([^\.]+)$/);return F&&gs[F[1]]||D&&(F=(R=D).match(/[\.\\]([^\.\\])+$/),F&&gs[F[1]])?gs[F[1]]:"application/octet-stream"}function _s(k){for(var D=ru(k),R=[],F=0;F<D.length;F+=76)R.push(D.slice(F,F+76));return R.join(`\r
`)+`\r
`}function Ch(k){var D=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var X=q.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],F=D.split(`\r
`),L=0;L<F.length;++L){var b=F[L];if(b.length==0){R.push("");continue}for(var K=0;K<b.length;){var Z=76,G=b.slice(K,K+Z);G.charAt(Z-1)=="="?Z--:G.charAt(Z-2)=="="?Z-=2:G.charAt(Z-3)=="="&&(Z-=3),G=b.slice(K,K+Z),K+=Z,K<b.length&&(G+="="),R.push(G)}}return R.join(`\r
`)}function Rh(k){for(var D=[],R=0;R<k.length;++R){for(var F=k[R];R<=k.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+k[++R];D.push(F)}for(var L=0;L<D.length;++L)D[L]=D[L].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return _n(D.join(`\r
`))}function xi(k,D,R){for(var F="",L="",b="",K,Z=0;Z<10;++Z){var G=D[Z];if(!G||G.match(/^\s*$/))break;var q=G.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":F=q[2].trim();break;case"content-type":b=q[2].trim();break;case"content-transfer-encoding":L=q[2].trim();break}}switch(++Z,L.toLowerCase()){case"base64":K=_n(hi(D.slice(Z).join("")));break;case"quoted-printable":K=Rh(D.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var X=pa(k,F.slice(R.length),K,{unsafe:!0});b&&(X.ctype=b)}function Ph(k,D){if(ye(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=D&&D.root||"",F=(He&&Buffer.isBuffer(k)?k.toString("binary"):ye(k)).split(`\r
`),L=0,b="";for(L=0;L<F.length;++L)if(b=F[L],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),R||(R=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),b.slice(0,R.length)!=R););var K=(F[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var Z="--"+(K[1]||""),G=[],q=[],X={FileIndex:G,FullPaths:q};E(X);var ie,ce=0;for(L=0;L<F.length;++L){var me=F[L];me!==Z&&me!==Z+"--"||(ce++&&xi(X,F.slice(ie,L),R),ie=L)}return X}function Nh(k,D){var R=D||{},F=R.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],b=k.FullPaths[0],K=b,Z=k.FileIndex[0],G=1;G<k.FullPaths.length;++G)if(K=k.FullPaths[G].slice(b.length),Z=k.FileIndex[G],!(!Z.size||!Z.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Re){return"_x"+Re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Re){return"_u"+Re.charCodeAt(0).toString(16)+"_"});for(var q=Z.content,X=He&&Buffer.isBuffer(q)?q.toString("binary"):ye(q),ie=0,ce=Math.min(1024,X.length),me=0,se=0;se<=ce;++se)(me=X.charCodeAt(se))>=32&&me<128&&++ie;var pe=ie>=ce*4/5;L.push(F),L.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+K),L.push("Content-Transfer-Encoding: "+(pe?"quoted-printable":"base64")),L.push("Content-Type: "+vs(Z,K)),L.push(""),L.push(pe?Ch(X):_s(X))}return L.push(F+`--\r
`),L.join(`\r
`)}function da(k){var D={};return E(D,k),D}function pa(k,D,R,F){var L=F&&F.unsafe;L||E(k);var b=!L&&Je.find(k,D);if(!b){var K=k.FullPaths[0];D.slice(0,K.length)==K?K=D:(K.slice(-1)!="/"&&(K+="/"),K=(K+D).replace("//","/")),b={name:i(D),type:2},k.FileIndex.push(b),k.FullPaths.push(K),L||Je.utils.cfb_gc(k)}return b.content=R,b.size=R?R.length:0,F&&(F.CLSID&&(b.clsid=F.CLSID),F.mt&&(b.mt=F.mt),F.ct&&(b.ct=F.ct)),b}function Nu(k,D){E(k);var R=Je.find(k,D);if(R){for(var F=0;F<k.FileIndex.length;++F)if(k.FileIndex[F]==R)return k.FileIndex.splice(F,1),k.FullPaths.splice(F,1),!0}return!1}function No(k,D,R){E(k);var F=Je.find(k,D);if(F){for(var L=0;L<k.FileIndex.length;++L)if(k.FileIndex[L]==F)return k.FileIndex[L].name=i(R),k.FullPaths[L]=R,!0}return!1}function xs(k){A(k,!0)}return e.find=P,e.read=W,e.parse=f,e.write=Se,e.writeFile=fe,e.utils={cfb_new:da,cfb_add:pa,cfb_del:Nu,cfb_mov:No,cfb_gc:xs,ReadShift:Sl,CheckField:xT,prep_blob:Br,bconcat:tr,use_zlib:B,_deflateRaw:Cu,_inflateRaw:ms,consts:Ze},e}();function oD(t){return typeof t=="string"?xh(t):Array.isArray(t)?DF(t):t}function wu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=xh(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?iu(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([oD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Eu(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function or(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function w_(t,e){for(var r=[],n=or(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Bm(t){for(var e=[],r=or(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function wh(t){for(var e=[],r=or(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function lD(t){for(var e=[],r=or(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var If=new Date(1899,11,30,0,0,0);function Or(t,e){var r=t.getTime(),n=If.getTime()+(t.getTimezoneOffset()-If.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var rT=new Date,uD=If.getTime()+(rT.getTimezoneOffset()-If.getTimezoneOffset())*6e4,T_=rT.getTimezoneOffset();function nT(t){var e=new Date;return e.setTime(t*24*60*60*1e3+uD),e.getTimezoneOffset()!==T_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-T_)*6e4),e}var S_=new Date("2017-02-19T19:06:09.000Z"),iT=isNaN(S_.getFullYear())?new Date("2/19/17"):S_,cD=iT.getFullYear()==2017;function Tr(t,e){var r=new Date(t);if(cD)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(iT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Th(t,e){if(He&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Lr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Lr(t[r]));return e}function Et(t,e){for(var r="";r.length<e;)r+=t;return r}function ri(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var fD=["january","february","march","april","may","june","july","august","september","october","november","december"];function nu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&fD.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function De(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return He?n=gi(r):n=OF(r),Je.utils.cfb_add(t,e,n)}Je.utils.cfb_add(t,e,r)}else t.file(e,r)}function Um(){return Je.utils.cfb_new()}var Nt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,hD={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jm=Bm(hD),zm=/[&<>'"]/g,dD=/[\u0000-\u0008\u000b-\u001f]/g;function Xe(t){var e=t+"";return e.replace(zm,function(r){return jm[r]}).replace(dD,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function A_(t){return Xe(t).replace(/ /g,"_x0020_")}var sT=/[\u0000-\u001f]/g;function pD(t){var e=t+"";return e.replace(zm,function(r){return jm[r]}).replace(/\n/g,"<br/>").replace(sT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mD(t){var e=t+"";return e.replace(zm,function(r){return jm[r]}).replace(sT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function gD(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function vD(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function k0(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function k_(t){var e=qs(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function I_(t){return gi(t,"binary").toString("utf8")}var fc="foo bar baz",Tl=He&&(I_(fc)==k0(fc)&&I_||k_(fc)==k0(fc)&&k_)||k0,iu=He?function(t){return gi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},_D=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),aT=/(^\s|\s$|\n)/;function rr(t,e){return"<"+t+(e.match(aT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function su(t){return or(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function le(t,e,r){return"<"+t+(r!=null?su(r):"")+(e!=null?(e.match(aT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Jd(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function xD(t,e){switch(typeof t){case"string":var r=le("vt:lpwstr",Xe(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return le((t|0)==t?"vt:i4":"vt:r8",Xe(String(t)));case"boolean":return le("vt:bool",t?"true":"false")}if(t instanceof Date)return le("vt:filetime",Jd(t));throw new Error("Unable to serialize "+t)}var Ht={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},So=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ur={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yD(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function ED(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var C_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},R_=He?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:gi(e)})):C_(t)}:C_,P_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(al(t,i)));return n.join("").replace(wl,"")},$m=He?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(wl,""):P_(t,e,r)}:P_,N_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},oT=He?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):N_(t,e,r)}:N_,F_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Ia(t,i)));return n.join("")},Tu=He?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):F_(e,r,n)}:F_,lT=function(t,e){var r=jr(t,e);return r>0?Tu(t,e+4,e+4+r-1):""},uT=lT,cT=function(t,e){var r=jr(t,e);return r>0?Tu(t,e+4,e+4+r-1):""},fT=cT,hT=function(t,e){var r=2*jr(t,e);return r>0?Tu(t,e+4,e+4+r-1):""},dT=hT,pT=function(e,r){var n=jr(e,r);return n>0?$m(e,r+4,r+4+n):""},mT=pT,gT=function(t,e){var r=jr(t,e);return r>0?Tu(t,e+4,e+4+r):""},vT=gT,_T=function(t,e){return yD(t,e)},Cf=_T,Hm=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};He&&(uT=function(e,r){if(!Buffer.isBuffer(e))return lT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},fT=function(e,r){if(!Buffer.isBuffer(e))return cT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},dT=function(e,r){if(!Buffer.isBuffer(e))return hT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},mT=function(e,r){if(!Buffer.isBuffer(e))return pT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},vT=function(e,r){if(!Buffer.isBuffer(e))return gT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Cf=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):_T(e,r)},Hm=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ia=function(t,e){return t[e]},al=function(t,e){return t[e+1]*256+t[e]},wD=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},jr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Is=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},TD=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Sl(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,He&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(al(this,u)),u+=2;t*=2;break;case"utf8":r=Tu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=$m(this,this.l,this.l+t);break;case"wstr":return Sl.call(this,t,"dbcs");case"lpstr-ansi":r=uT(this,this.l),t=4+jr(this,this.l);break;case"lpstr-cp":r=fT(this,this.l),t=4+jr(this,this.l);break;case"lpwstr":r=dT(this,this.l),t=4+2*jr(this,this.l);break;case"lpp4":t=4+jr(this,this.l),r=mT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+jr(this,this.l),r=vT(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Ia(this,this.l+t++))!==0;)s.push(lc(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=al(this,this.l+t))!==0;)s.push(lc(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ia(this,u),this.l=u+1,o=Sl.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(lc(al(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Ia(this,u),this.l=u+1,o=Sl.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(lc(Ia(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Ia(this,this.l),this.l++,n;case 2:return n=(e==="i"?wD:al)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Is:TD)(this,this.l),this.l+=4,n):(i=jr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Cf(this,this.l):i=Cf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=oT(this,this.l,t);break}}return this.l+=t,r}var SD=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},AD=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},kD=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function ID(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)kD(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,SD(this,e,this.l);break;case 8:if(n=8,r==="f"){ED(this,e,this.l);break}case 16:break;case-4:n=4,AD(this,e,this.l);break}return this.l+=n,this}function xT(t,e){var r=oT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Br(t,e){t.l=e,t.read_shift=Sl,t.chk=xT,t.write_shift=ID}function Hn(t,e){t.l+=e}function J(t){var e=qs(t);return Br(e,0),e}function Dr(){var t=[],e=He?256:2048,r=function(u){var f=J(u);return Br(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),tr(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function re(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=yM[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Hm(r)&&t.push(r)}}function Al(t,e,r){var n=Lr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function D_(t,e,r){var n=Lr(t);return n.s=Al(n.s,e.s,r),n.e=Al(n.e,e.s,r),n}function kl(t,e){if(t.cRel&&t.c<0)for(t=Lr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Lr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ye(t);return!t.cRel&&t.cRel!=null&&(r=PD(r)),!t.rRel&&t.rRel!=null&&(r=CD(r)),r}function I0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+mr(t.s.c)+":"+(t.e.cRel?"":"$")+mr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ir(t.s.r)+":"+(t.e.rRel?"":"$")+ir(t.e.r):kl(t.s,e.biff)+":"+kl(t.e,e.biff)}function Wm(t){return parseInt(RD(t),10)-1}function ir(t){return""+(t+1)}function CD(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function RD(t){return t.replace(/\$(\d+)$/,"$1")}function Gm(t){for(var e=ND(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function mr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function PD(t){return t.replace(/^([A-Z])/,"$$$1")}function ND(t){return t.replace(/^\$([A-Z])/,"$1")}function FD(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Ye(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Gr(t){var e=t.indexOf(":");return e==-1?{s:Wt(t),e:Wt(t)}:{s:Wt(t.slice(0,e)),e:Wt(t.slice(e+1))}}function Pt(t,e){return typeof e>"u"||typeof e=="number"?Pt(t.s,t.e):(typeof t!="string"&&(t=Ye(t)),typeof e!="string"&&(e=Ye(e)),t==e?t:t+":"+e)}function ft(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function O_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=as(t.z,r?Or(e):e)}catch{}try{return t.w=as((t.XF||{}).numFmtId||(r?14:0),r?Or(e):e)}catch{return""+e}}function di(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Su[t.v]||t.v:e==null?O_(t,t.v):O_(t,e))}function na(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function yT(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Wt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ft(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(u.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var g={v:e[h][d]},_=a+h,m=o+d;if(u.s.r>_&&(u.s.r=_),u.s.c>m&&(u.s.c=m),u.e.r<_&&(u.e.r=_),u.e.c<m&&(u.e.c=m),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))g=e[h][d];else if(Array.isArray(g.v)&&(g.f=e[h][d][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||wt[14],n.cellDates?(g.t="d",g.w=as(g.z,Or(g.v))):(g.t="n",g.v=Or(g.v),g.w=as(g.z,g.v))):g.t="s";if(i)s[_]||(s[_]=[]),s[_][m]&&s[_][m].z&&(g.z=s[_][m].z),s[_][m]=g;else{var y=Ye({c:m,r:_});s[y]&&s[y].z&&(g.z=s[y].z),s[y]=g}}}return u.s.c<1e7&&(s["!ref"]=Pt(u)),s}function Ao(t,e){return yT(null,t,e)}function DD(t){return t.read_shift(4,"i")}function Tn(t,e){return e||(e=J(4)),e.write_shift(4,t),e}function gr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Gt(t,e){var r=!1;return e==null&&(r=!0,e=J(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function OD(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function LD(t,e){return e||(e=J(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Km(t,e){var r=t.l,n=t.read_shift(1),i=gr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(OD(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function MD(t,e){var r=!1;return e==null&&(r=!0,e=J(15+4*t.t.length)),e.write_shift(1,0),Gt(t.t,e),r?e.slice(0,e.l):e}var bD=Km;function VD(t,e){var r=!1;return e==null&&(r=!0,e=J(23+4*t.t.length)),e.write_shift(1,1),Gt(t.t,e),e.write_shift(4,1),LD({},e),r?e.slice(0,e.l):e}function on(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ia(t,e){return e==null&&(e=J(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function sa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function aa(t,e){return e==null&&(e=J(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var BD=gr,ET=Gt;function qm(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Rf(t,e){var r=!1;return e==null&&(r=!0,e=J(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var UD=gr,Zd=qm,Xm=Rf;function wT(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Cf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Is(e,0)>>2;return r?i/100:i}function TT(t,e){e==null&&(e=J(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function ST(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function jD(t,e){return e||(e=J(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var oa=ST,ko=jD;function Io(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Xs(t,e){return(e||J(8)).write_shift(8,t,"f")}function zD(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=YD[i];u&&(e.rgb=W_(u));break;case 2:e.rgb=W_([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Pf(t,e){if(e||(e=J(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function $D(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function HD(t,e){e||(e=J(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var AT=2,br=3,hc=11,Nf=19,dc=64,WD=65,GD=71,KD=4108,qD=4126,Jt=80,L_={1:{n:"CodePage",t:AT},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:br},5:{n:"LineCount",t:br},6:{n:"ParagraphCount",t:br},7:{n:"SlideCount",t:br},8:{n:"NoteCount",t:br},9:{n:"HiddenCount",t:br},10:{n:"MultimediaClipCount",t:br},11:{n:"ScaleCrop",t:hc},12:{n:"HeadingPairs",t:KD},13:{n:"TitlesOfParts",t:qD},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:hc},17:{n:"CharacterCount",t:br},19:{n:"SharedDoc",t:hc},22:{n:"HyperlinksChanged",t:hc},23:{n:"AppVersion",t:br,p:"version"},24:{n:"DigSig",t:WD},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:Nf},2147483651:{n:"Behavior",t:Nf},1919054434:{}},M_={1:{n:"CodePage",t:AT},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:dc},11:{n:"LastPrinted",t:dc},12:{n:"CreatedDate",t:dc},13:{n:"ModifiedDate",t:dc},14:{n:"PageCount",t:br},15:{n:"WordCount",t:br},16:{n:"CharCount",t:br},17:{n:"Thumbnail",t:GD},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:br},255:{},2147483648:{n:"Locale",t:Nf},2147483651:{n:"Behavior",t:Nf},1919054434:{}};function XD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var QD=XD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),YD=Lr(QD),Su={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JD={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function kT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IT(t,e){var r=lD(JD),n=[],i;n[n.length]=Nt,n[n.length]=le("Types",null,{xmlns:Ht.CT,"xmlns:xsd":Ht.xsd,"xmlns:xsi":Ht.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return le("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=le("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:pc[l][e.bookType]||pc[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:pc[l][e.bookType]||pc[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=le("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $e={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function CT(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ya(t){var e=[Nt,le("Relationships",null,{xmlns:Ht.RELS})];return or(t["!id"]).forEach(function(r){e[e.length]=le("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function qe(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[$e.HLINK,$e.XPATH,$e.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function ZD(t){var e=[Nt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function b_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function eO(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function tO(t){var e=[Nt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(b_(t[r][0],t[r][1])),e.push(eO("",t[r][0]));return e.push(b_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function RT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+wf.version+"</meta:generator></office:meta></office:document-meta>"}var Ms=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function C0(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Xe(e),n[n.length]=r?le(t,e,r):rr(t,e))}function PT(t,e){var r=e||{},n=[Nt,le("cp:coreProperties",null,{"xmlns:cp":Ht.CORE_PROPS,"xmlns:dc":Ht.dc,"xmlns:dcterms":Ht.dcterms,"xmlns:dcmitype":Ht.dcmitype,"xmlns:xsi":Ht.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&C0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Jd(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&C0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Jd(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ms.length;++s){var a=Ms[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&C0(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ja=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],NT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function FT(t){var e=[],r=le;return t||(t={}),t.Application="SheetJS",e[e.length]=Nt,e[e.length]=le("Properties",null,{xmlns:Ht.EXT_PROPS,"xmlns:vt":Ht.vt}),Ja.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Xe(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Xe(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function DT(t){var e=[Nt,le("Properties",null,{xmlns:Ht.CUST_PROPS,"xmlns:vt":Ht.vt})];if(!t)return e.join("");var r=1;return or(t).forEach(function(i){++r,e[e.length]=le("property",xD(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xe(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var V_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rO(t,e){var r=[];return or(V_).map(function(n){for(var i=0;i<Ms.length;++i)if(Ms[i][1]==n)return Ms[i];for(i=0;i<Ja.length;++i)if(Ja[i][1]==n)return Ja[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(rr(V_[n[1]]||n[1],i))}}),le("DocumentProperties",r.join(""),{xmlns:Ur.o})}function nO(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&or(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ms.length;++a)if(s==Ms[a][1])return;for(a=0;a<Ja.length;++a)if(s==Ja[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(le(A_(s),o,{"dt:dt":l}))}}),e&&or(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(le(A_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Ur.o+'">'+i.join("")+"</"+n+">"}function iO(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=J(8);return a.write_shift(4,n),a.write_shift(4,i),a}function B_(t,e){var r=J(4),n=J(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=J(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=iO(e);break;case 31:case 80:for(n=J(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return tr([r,n])}var OT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function sO(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function U_(t,e,r){var n=J(8),i=[],s=[],a=8,o=0,l=J(8),u=J(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!e){u=J(8),u.write_shift(4,0),i.unshift(u);var f=[J(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=J(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=tr(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(OT.indexOf(t[o][0])>-1||NT.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],g=0;if(e){g=+e[t[o][0]];var _=r[g];if(_.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=B_(_.t,d)}else{var y=sO(d);y==-1&&(y=31,d=String(d)),l=B_(y,d)}s.push(l),u=J(8),u.write_shift(4,e?g:2+o),i.push(u),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),tr([n].concat(i).concat(s))}function j_(t,e,r,n,i,s){var a=J(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Je.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=U_(t,r,n);if(o.push(l),i){var u=U_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return tr(o)}function aO(t,e){e||(e=J(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function oO(t,e){return t.read_shift(e)===1}function Er(t,e){return e||(e=J(2)),e.write_shift(2,+!!t),e}function LT(t){return t.read_shift(2,"u")}function Yr(t,e){return e||(e=J(2)),e.write_shift(2,t),e}function MT(t,e,r){return r||(r=J(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function bT(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function lO(t){var e=t.t||"",r=J(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=J(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return tr(i)}function uO(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function cO(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):uO(t,n,r)}function fO(t,e,r){if(r.biff>5)return cO(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function VT(t,e,r){return r||(r=J(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function z_(t,e){e||(e=J(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function hO(t){var e=J(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),z_(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&z_(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Qs(t,e,r,n){return n||(n=J(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function dO(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function pO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function BT(t,e){return e||(e=J(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Qm(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=J(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function mO(t,e){var r=!e||e.biff==8,n=J(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function gO(t,e){var r=!e||e.biff>=8?2:1,n=J(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function vO(t,e){var r=J(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=lO(t[i]);var s=tr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function _O(){var t=J(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function xO(t){var e=J(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function yO(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=J(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function EO(t,e,r,n){var i=J(10);return Qs(t,e,n,i),i.write_shift(4,r),i}function wO(t,e,r,n,i){var s=!i||i.biff==8,a=J(8+ +s+(1+s)*r.length);return Qs(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function TO(t,e,r,n){var i=r&&r.biff==5;n||(n=J(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function SO(t,e){var r=e.biff==8||!e.biff?4:2,n=J(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function $_(t,e,r,n){var i=r&&r.biff==5;n||(n=J(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function AO(t){var e=J(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function kO(t,e,r,n,i,s){var a=J(8);return Qs(t,e,n,a),MT(r,s,a),a}function IO(t,e,r,n){var i=J(14);return Qs(t,e,n,i),Xs(r,i),i}function CO(t,e,r){if(r.biff<8)return RO(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(dO(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function RO(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=bT(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function PO(t){var e=J(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)BT(t[r],e);return e}function NO(t){var e=J(24),r=Wt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return tr([e,hO(t[1])])}function FO(t){var e=t[1].Tooltip,r=J(10+2*(e.length+1));r.write_shift(2,2048);var n=Wt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function DO(t){return t||(t=J(4)),t.write_shift(2,1),t.write_shift(2,1),t}function OO(t,e,r){if(!r.cellStyles)return Hn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function LO(t,e){var r=J(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function MO(t){for(var e=J(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function bO(t,e,r){var n=J(15);return ku(n,t,e),n.write_shift(8,r,"f"),n}function VO(t,e,r){var n=J(9);return ku(n,t,e),n.write_shift(2,r),n}var BO=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Bm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=qs(1);switch(l.type){case"base64":f=_n(hi(o));break;case"binary":f=_n(o);break;case"buffer":case"array":f=o;break}Br(f,0);var h=f.read_shift(1),d=!!(h&136),g=!1,_=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,d=!0;break;case 49:g=!0,d=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,y=521;h==2&&(m=f.read_shift(2)),f.l+=3,h!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(y=f.read_shift(2));var w=f.read_shift(2),x=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(x=t[f[f.l]]),f.l+=1,f.l+=2),_&&(f.l+=36);for(var T=[],O={},U=Math.min(f.length,h==2?521:y-10-(g?264:0)),W=_?32:11;f.l<U&&f[f.l]!=13;)switch(O={},O.name=Tf.utils.decode(x,f.slice(f.l,f.l+W)).replace(/[\u0000\r\n].*$/g,""),f.l+=W,O.type=String.fromCharCode(f.read_shift(1)),h!=2&&!_&&(O.offset=f.read_shift(4)),O.len=f.read_shift(1),h==2&&(O.offset=f.read_shift(2)),O.dec=f.read_shift(1),O.name.length&&T.push(O),h!=2&&(f.l+=_?13:14),O.type){case"B":(!g||O.len!=8)&&l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var E=0,S=0;for(u[0]=[],S=0;S!=T.length;++S)u[0][S]=T[S].name;for(;m-- >0;){if(f[f.l]===42){f.l+=w;continue}for(++f.l,u[++E]=[],S=0,S=0;S!=T.length;++S){var A=f.slice(f.l,f.l+T[S].len);f.l+=T[S].len,Br(A,0);var I=Tf.utils.decode(x,A);switch(T[S].type){case"C":I.trim().length&&(u[E][S]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[E][S]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[E][S]=I;break;case"F":u[E][S]=parseFloat(I.trim());break;case"+":case"I":u[E][S]=_?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[E][S]=!0;break;case"N":case"F":u[E][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[E][S]="##MEMO##"+(_?parseInt(I.trim(),10):A.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[E][S]=+I||0);break;case"@":u[E][S]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[E][S]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[E][S]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][S]=-A.read_shift(-8,"f");break;case"B":if(g&&T[S].len==8){u[E][S]=A.read_shift(8,"f");break}case"G":case"P":A.l+=T[S].len;break;case"0":if(T[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[S].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=T,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ao(r(o,u),u);return f["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,f}function i(o,l){try{return na(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&tu(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Dr(),h=Mf(o,{header:1,raw:!0,cellDates:!0}),d=h[0],g=h.slice(1),_=o["!cols"]||[],m=0,y=0,w=0,x=1;for(m=0;m<d.length;++m){if(((_[m]||{}).DBF||{}).name){d[m]=_[m].DBF.name,++w;continue}if(d[m]!=null){if(++w,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(y=0;y<1024;++y)if(d.indexOf(d[m]+"_"+y)==-1){d[m]+="_"+y;break}}}}var T=ft(o["!ref"]),O=[],U=[],W=[];for(m=0;m<=T.e.c-T.s.c;++m){var E="",S="",A=0,I=[];for(y=0;y<g.length;++y)g[y][m]!=null&&I.push(g[y][m]);if(I.length==0||d[m]==null){O[m]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=I[y]instanceof Date?"D":"C";break;default:S="C"}A=Math.max(A,String(I[y]).length),E=E&&E!=S?"C":S}A>250&&(A=250),S=((_[m]||{}).DBF||{}).type,S=="C"&&_[m].DBF.len>A&&(A=_[m].DBF.len),E=="B"&&S=="N"&&(E="N",W[m]=_[m].DBF.dec,A=_[m].DBF.len),U[m]=E=="C"||S=="N"?A:s[E]||0,x+=U[m],O[m]=E}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,g.length),P.write_shift(2,296+32*w),P.write_shift(2,x),m=0;m<4;++m)P.write_shift(4,0);for(P.write_shift(4,0|(+e[jw]||3)<<8),m=0,y=0;m<d.length;++m)if(d[m]!=null){var V=f.next(32),N=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,N,"sbcs"),V.write_shift(1,O[m]=="?"?"C":O[m],"sbcs"),V.write_shift(4,y),V.write_shift(1,U[m]||s[O[m]]||0),V.write_shift(1,W[m]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),y+=U[m]||s[O[m]]||0}var Ce=f.next(264);for(Ce.write_shift(4,13),m=0;m<65;++m)Ce.write_shift(4,0);for(m=0;m<g.length;++m){var ke=f.next(x);for(ke.write_shift(1,0),y=0;y<d.length;++y)if(d[y]!=null)switch(O[y]){case"L":ke.write_shift(1,g[m][y]==null?63:g[m][y]?84:70);break;case"B":ke.write_shift(8,g[m][y]||0,"f");break;case"N":var dt="0";for(typeof g[m][y]=="number"&&(dt=g[m][y].toFixed(W[y]||0)),w=0;w<U[y]-dt.length;++w)ke.write_shift(1,32);ke.write_shift(1,dt,"sbcs");break;case"D":g[m][y]?(ke.write_shift(4,("0000"+g[m][y].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(g[m][y].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+g[m][y].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Ze=String(g[m][y]!=null?g[m][y]:"").slice(0,U[y]);for(ke.write_shift(1,Ze,"sbcs"),w=0;w<U[y]-Ze.length;++w)ke.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),UO=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+or(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,g){var _=t[g];return typeof _=="number"?d_(_):_},n=function(d,g,_){var m=g.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return m==59?d:d_(m)};t["|"]=254;function i(d,g){switch(g.type){case"base64":return s(hi(d),g);case"binary":return s(d,g);case"buffer":return s(He&&Buffer.isBuffer(d)?d.toString("binary"):Eu(d),g);case"array":return s(Th(d),g)}throw new Error("Unrecognized type "+g.type)}function s(d,g){var _=d.split(/[\n\r]+/),m=-1,y=-1,w=0,x=0,T=[],O=[],U=null,W={},E=[],S=[],A=[],I=0,P;for(+g.codepage>=0&&tu(+g.codepage);w!==_.length;++w){I=0;var V=_[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),N=V.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),Ce=N[0],ke;if(V.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&O.push(V.slice(3).replace(/;;/g,";"));break;case"C":var dt=!1,Ze=!1,fe=!1,ye=!1,Se=-1,Oe=-1;for(x=1;x<N.length;++x)switch(N[x].charAt(0)){case"A":break;case"X":y=parseInt(N[x].slice(1))-1,Ze=!0;break;case"Y":for(m=parseInt(N[x].slice(1))-1,Ze||(y=0),P=T.length;P<=m;++P)T[P]=[];break;case"K":ke=N[x].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(ri(ke))?isNaN(nu(ke).getDate())||(ke=Tr(ke)):(ke=ri(ke),U!==null&&Zw(U)&&(ke=nT(ke))),dt=!0;break;case"E":ye=!0;var B=V5(N[x].slice(1),{r:m,c:y});T[m][y]=[T[m][y],B];break;case"S":fe=!0,T[m][y]=[T[m][y],"S5S"];break;case"G":break;case"R":Se=parseInt(N[x].slice(1))-1;break;case"C":Oe=parseInt(N[x].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+V)}if(dt&&(T[m][y]&&T[m][y].length==2?T[m][y][0]=ke:T[m][y]=ke,U=null),fe){if(ye)throw new Error("SYLK shared formula cannot have own formula");var Q=Se>-1&&T[Se][Oe];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");T[m][y][1]=B5(Q[1],{r:m-Se,c:y-Oe})}break;case"F":var z=0;for(x=1;x<N.length;++x)switch(N[x].charAt(0)){case"X":y=parseInt(N[x].slice(1))-1,++z;break;case"Y":for(m=parseInt(N[x].slice(1))-1,P=T.length;P<=m;++P)T[P]=[];break;case"M":I=parseInt(N[x].slice(1))/20;break;case"F":break;case"G":break;case"P":U=O[parseInt(N[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=N[x].slice(1).split(" "),P=parseInt(A[0],10);P<=parseInt(A[1],10);++P)I=parseInt(A[2],10),S[P-1]=I===0?{hidden:!0}:{wch:I},Ym(S[P-1]);break;case"C":y=parseInt(N[x].slice(1))-1,S[y]||(S[y]={});break;case"R":m=parseInt(N[x].slice(1))-1,E[m]||(E[m]={}),I>0?(E[m].hpt=I,E[m].hpx=HT(I)):I===0&&(E[m].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+V)}z<1&&(U=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+V)}}return E.length>0&&(W["!rows"]=E),S.length>0&&(W["!cols"]=S),g&&g.sheetRows&&(T=T.slice(0,g.sheetRows)),[T,W]}function a(d,g){var _=i(d,g),m=_[0],y=_[1],w=Ao(m,g);return or(y).forEach(function(x){w[x]=y[x]}),w}function o(d,g){return na(a(d,g),g)}function l(d,g,_,m){var y="C;Y"+(_+1)+";X"+(m+1)+";K";switch(d.t){case"n":y+=d.v||0,d.f&&!d.F&&(y+=";E"+Zm(d.f,{r:_,c:m}));break;case"b":y+=d.v?"TRUE":"FALSE";break;case"e":y+=d.w||d.v;break;case"d":y+='"'+(d.w||d.v)+'"';break;case"s":y+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(d,g){g.forEach(function(_,m){var y="F;W"+(m+1)+" "+(m+1)+" ";_.hidden?y+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Ff(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Df(_.wpx)),typeof _.wch=="number"&&(y+=Math.round(_.wch))),y.charAt(y.length-1)!=" "&&d.push(y)})}function f(d,g){g.forEach(function(_,m){var y="F;";_.hidden?y+="M0;":_.hpt?y+="M"+20*_.hpt+";":_.hpx&&(y+="M"+20*Of(_.hpx)+";"),y.length>2&&d.push(y+"R"+(m+1))})}function h(d,g){var _=["ID;PWXL;N;E"],m=[],y=ft(d["!ref"]),w,x=Array.isArray(d),T=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),d["!cols"]&&u(_,d["!cols"]),d["!rows"]&&f(_,d["!rows"]),_.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var O=y.s.r;O<=y.e.r;++O)for(var U=y.s.c;U<=y.e.c;++U){var W=Ye({r:O,c:U});w=x?(d[O]||[])[U]:d[W],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,d,O,U))}return _.join(T)+T+m.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),jO=function(){function t(s,a){switch(a.type){case"base64":return e(hi(s),a);case"binary":return e(s,a);case"buffer":return e(He&&Buffer.isBuffer(s)?s.toString("binary"):Eu(s),a);case"array":return e(Th(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var d=o[f].trim().split(","),g=d[0],_=d[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+g){case-1:if(m==="BOT"){h[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][u]=!0:m==="FALSE"?h[l][u]=!1:isNaN(ri(_))?isNaN(nu(_).getDate())?h[l][u]=_:h[l][u]=Tr(_):h[l][u]=ri(_),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Ao(t(s,a),a)}function n(s,a){return na(r(s,a),a)}var i=function(){var s=function(l,u,f,h,d){l.push(u),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,u,f,h){l.push(u+","+f),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],f=ft(l["!ref"]),h,d=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var g=f.s.r;g<=f.e.r;++g){a(u,-1,0,"BOT");for(var _=f.s.c;_<=f.e.c;++_){var m=Ye({r:g,c:_});if(h=d?(l[g]||[])[_]:l[m],!h){a(u,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,y,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=as(h.z||wt[14],Or(Tr(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var w=`\r
`,x=u.join(w);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),UT=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var g=h.split(`
`),_=-1,m=-1,y=0,w=[];y!==g.length;++y){var x=g[y].trim().split(":");if(x[0]==="cell"){var T=Wt(x[1]);if(w.length<=T.r)for(_=w.length;_<=T.r;++_)w[_]||(w[_]=[]);switch(_=T.r,m=T.c,x[2]){case"t":w[_][m]=t(x[3]);break;case"v":w[_][m]=+x[3];break;case"vtf":var O=x[x.length-1];case"vtc":switch(x[3]){case"nl":w[_][m]=!!+x[4];break;default:w[_][m]=+x[4];break}x[2]=="vtf"&&(w[_][m]=[w[_][m],O])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return Ao(r(h,d),d)}function i(h,d){return na(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var d=[],g=[],_,m="",y=Gr(h["!ref"]),w=Array.isArray(h),x=y.s.r;x<=y.e.r;++x)for(var T=y.s.c;T<=y.e.c;++T)if(m=Ye({r:x,c:T}),_=w?(h[x]||[])[T]:h[m],!(!_||_.v==null||_.t==="z")){switch(g=["cell",m,"t"],_.t){case"s":case"str":g.push(e(_.v));break;case"n":_.f?(g[2]="vtf",g[3]="n",g[4]=_.v,g[5]=e(_.f)):(g[2]="v",g[3]=_.v);break;case"b":g[2]="vt"+(_.f?"f":"c"),g[3]="nl",g[4]=_.v?"1":"0",g[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var O=Or(Tr(_.v));g[2]="vtc",g[3]="nd",g[4]=""+O,g[5]=_.w||as(_.z||wt[14],O);break;case"e":continue}d.push(g.join(":"))}return d.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),zO=function(){function t(f,h,d,g,_){_.raw?h[d][g]=f:f===""||(f==="TRUE"?h[d][g]=!0:f==="FALSE"?h[d][g]=!1:isNaN(ri(f))?isNaN(nu(f).getDate())?h[d][g]=f:h[d][g]=Tr(f):h[d][g]=ri(f))}function e(f,h){var d=h||{},g=[];if(!f||f.length===0)return g;for(var _=f.split(/[\r\n]/),m=_.length-1;m>=0&&_[m].length===0;)--m;for(var y=10,w=0,x=0;x<=m;++x)w=_[x].indexOf(" "),w==-1?w=_[x].length:w++,y=Math.max(y,w);for(x=0;x<=m;++x){g[x]=[];var T=0;for(t(_[x].slice(0,y).trim(),g,x,T,d),T=1;T<=(_[x].length-y)/10+1;++T)t(_[x].slice(y+(T-1)*10,y+T*10).trim(),g,x,T,d)}return d.sheetRows&&(g=g.slice(0,d.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,g=0,_=0;g<f.length;++g)(_=f.charCodeAt(g))==34?d=!d:!d&&_ in r&&(h[_]=(h[_]||0)+1);_=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&_.push([h[g],g]);if(!_.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&_.push([h[g],g])}return _.sort(function(m,y){return m[0]-y[0]||n[m[1]]-n[y[1]]}),r[_.pop()[1]]||44}function s(f,h){var d=h||{},g="",_=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=i(f.slice(0,1024)):d&&d.FS?g=d.FS:g=i(f.slice(0,1024));var y=0,w=0,x=0,T=0,O=0,U=g.charCodeAt(0),W=!1,E=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=d.dateNF!=null?iD(d.dateNF):null;function I(){var P=f.slice(T,O),V={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)V.t="z";else if(d.raw)V.t="s",V.v=P;else if(P.trim().length===0)V.t="s",V.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(V.t="s",V.v=P.slice(2,-1).replace(/""/g,'"')):U5(P)?(V.t="n",V.f=P.slice(1)):(V.t="s",V.v=P);else if(P=="TRUE")V.t="b",V.v=!0;else if(P=="FALSE")V.t="b",V.v=!1;else if(!isNaN(x=ri(P)))V.t="n",d.cellText!==!1&&(V.w=P),V.v=x;else if(!isNaN(nu(P).getDate())||A&&P.match(A)){V.z=d.dateNF||wt[14];var N=0;A&&P.match(A)&&(P=sD(P,d.dateNF,P.match(A)||[]),N=1),d.cellDates?(V.t="d",V.v=Tr(P,N)):(V.t="n",V.v=Or(Tr(P,N))),d.cellText!==!1&&(V.w=as(V.z,V.v instanceof Date?Or(V.v):V.v)),d.cellNF||delete V.z}else V.t="s",V.v=P;if(V.t=="z"||(d.dense?(_[y]||(_[y]=[]),_[y][w]=V):_[Ye({c:w,r:y})]=V),T=O+1,S=f.charCodeAt(T),m.e.c<w&&(m.e.c=w),m.e.r<y&&(m.e.r=y),E==U)++w;else if(w=0,++y,d.sheetRows&&d.sheetRows<=y)return!0}e:for(;O<f.length;++O)switch(E=f.charCodeAt(O)){case 34:S===34&&(W=!W);break;case U:case 10:case 13:if(!W&&I())break e;break}return O-T>0&&I(),_["!ref"]=Pt(m),_}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):Ao(e(f,h),h)}function o(f,h){var d="",g=h.type=="string"?[0,0,0,0]:eb(f,h);switch(h.type){case"base64":d=hi(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Tf<"u"||(d=He&&Buffer.isBuffer(f)?f.toString("binary"):Eu(f));break;case"array":d=Th(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?d=Tl(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Tl(d):h.type=="binary"&&typeof Tf<"u",d.slice(0,19)=="socialcalc:version:"?UT.to_sheet(h.type=="string"?d:Tl(d),h):a(d,h)}function l(f,h){return na(o(f,h),h)}function u(f){for(var h=[],d=ft(f["!ref"]),g,_=Array.isArray(f),m=d.s.r;m<=d.e.r;++m){for(var y=[],w=d.s.c;w<=d.e.c;++w){var x=Ye({r:m,c:w});if(g=_?(f[m]||[])[w]:f[x],!g||g.v==null){y.push("          ");continue}for(var T=(g.w||(di(g),g.w)||"").slice(0,10);T.length<10;)T+=" ";y.push(T+(w===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),H_=function(){function t(B,Q,z){if(B){Br(B,B.l||0);for(var j=z.Enum||Se;B.l<B.length;){var ee=B.read_shift(2),ge=j[ee]||j[65535],Te=B.read_shift(2),Ee=B.l+Te,de=ge.f&&ge.f(B,Te,z);if(B.l=Ee,Q(de,ge,ee))return}}}function e(B,Q){switch(Q.type){case"base64":return r(_n(hi(B)),Q);case"binary":return r(_n(B),Q);case"buffer":case"array":return r(B,Q)}throw"Unsupported type "+Q.type}function r(B,Q){if(!B)return B;var z=Q||{},j=z.dense?[]:{},ee="Sheet1",ge="",Te=0,Ee={},de=[],Ge=[],Me={s:{r:0,c:0},e:{r:0,c:0}},Ft=z.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)z.Enum=Se,t(B,function(_e,_r,rt){switch(rt){case 0:z.vers=_e,_e>=4096&&(z.qpro=!0);break;case 6:Me=_e;break;case 204:_e&&(ge=_e);break;case 222:ge=_e;break;case 15:case 51:z.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:rt==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=z.dateNF||wt[14],z.cellDates&&(_e[1].t="d",_e[1].v=nT(_e[1].v))),z.qpro&&_e[3]>Te&&(j["!ref"]=Pt(Me),Ee[ee]=j,de.push(ee),j=z.dense?[]:{},Me={s:{r:0,c:0},e:{r:0,c:0}},Te=_e[3],ee=ge||"Sheet"+(Te+1),ge="");var pt=z.dense?(j[_e[0].r]||[])[_e[0].c]:j[Ye(_e[0])];if(pt){pt.t=_e[1].t,pt.v=_e[1].v,_e[1].z!=null&&(pt.z=_e[1].z),_e[1].f!=null&&(pt.f=_e[1].f);break}z.dense?(j[_e[0].r]||(j[_e[0].r]=[]),j[_e[0].r][_e[0].c]=_e[1]):j[Ye(_e[0])]=_e[1];break}},z);else if(B[2]==26||B[2]==14)z.Enum=Oe,B[2]==14&&(z.qpro=!0,B.l=0),t(B,function(_e,_r,rt){switch(rt){case 204:ee=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>Te&&(j["!ref"]=Pt(Me),Ee[ee]=j,de.push(ee),j=z.dense?[]:{},Me={s:{r:0,c:0},e:{r:0,c:0}},Te=_e[3],ee="Sheet"+(Te+1)),Ft>0&&_e[0].r>=Ft)break;z.dense?(j[_e[0].r]||(j[_e[0].r]=[]),j[_e[0].r][_e[0].c]=_e[1]):j[Ye(_e[0])]=_e[1],Me.e.c<_e[0].c&&(Me.e.c=_e[0].c),Me.e.r<_e[0].r&&(Me.e.r=_e[0].r);break;case 27:_e[14e3]&&(Ge[_e[14e3][0]]=_e[14e3][1]);break;case 1537:Ge[_e[0]]=_e[1],_e[0]==Te&&(ee=_e[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(j["!ref"]=Pt(Me),Ee[ge||ee]=j,de.push(ge||ee),!Ge.length)return{SheetNames:de,Sheets:Ee};for(var je={},ln=[],tt=0;tt<Ge.length;++tt)Ee[de[tt]]?(ln.push(Ge[tt]||de[tt]),je[Ge[tt]]=Ee[Ge[tt]]||Ee[de[tt]]):(ln.push(Ge[tt]),je[Ge[tt]]={"!ref":"A1"});return{SheetNames:ln,Sheets:je}}function n(B,Q){var z=Q||{};if(+z.codepage>=0&&tu(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var j=Dr(),ee=ft(B["!ref"]),ge=Array.isArray(B),Te=[];ue(j,0,s(1030)),ue(j,6,l(ee));for(var Ee=Math.min(ee.e.r,8191),de=ee.s.r;de<=Ee;++de)for(var Ge=ir(de),Me=ee.s.c;Me<=ee.e.c;++Me){de===ee.s.r&&(Te[Me]=mr(Me));var Ft=Te[Me]+Ge,je=ge?(B[de]||[])[Me]:B[Ft];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?ue(j,13,g(de,Me,je.v)):ue(j,14,m(de,Me,je.v));else{var ln=di(je);ue(j,15,h(de,Me,ln.slice(0,239)))}}return ue(j,1),j.end()}function i(B,Q){var z=Q||{};if(+z.codepage>=0&&tu(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var j=Dr();ue(j,0,a(B));for(var ee=0,ge=0;ee<B.SheetNames.length;++ee)(B.Sheets[B.SheetNames[ee]]||{})["!ref"]&&ue(j,27,ye(B.SheetNames[ee],ge++));var Te=0;for(ee=0;ee<B.SheetNames.length;++ee){var Ee=B.Sheets[B.SheetNames[ee]];if(!(!Ee||!Ee["!ref"])){for(var de=ft(Ee["!ref"]),Ge=Array.isArray(Ee),Me=[],Ft=Math.min(de.e.r,8191),je=de.s.r;je<=Ft;++je)for(var ln=ir(je),tt=de.s.c;tt<=de.e.c;++tt){je===de.s.r&&(Me[tt]=mr(tt));var _e=Me[tt]+ln,_r=Ge?(Ee[je]||[])[tt]:Ee[_e];if(!(!_r||_r.t=="z"))if(_r.t=="n")ue(j,23,I(je,tt,Te,_r.v));else{var rt=di(_r);ue(j,22,E(je,tt,Te,rt.slice(0,239)))}}++Te}}return ue(j,1),j.end()}function s(B){var Q=J(2);return Q.write_shift(2,B),Q}function a(B){var Q=J(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var z=0,j=0,ee=0,ge=0;ge<B.SheetNames.length;++ge){var Te=B.SheetNames[ge],Ee=B.Sheets[Te];if(!(!Ee||!Ee["!ref"])){++ee;var de=Gr(Ee["!ref"]);z<de.e.r&&(z=de.e.r),j<de.e.c&&(j=de.e.c)}}return z>8191&&(z=8191),Q.write_shift(2,z),Q.write_shift(1,ee),Q.write_shift(1,j),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function o(B,Q,z){var j={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&z.qpro?(j.s.c=B.read_shift(1),B.l++,j.s.r=B.read_shift(2),j.e.c=B.read_shift(1),B.l++,j.e.r=B.read_shift(2),j):(j.s.c=B.read_shift(2),j.s.r=B.read_shift(2),Q==12&&z.qpro&&(B.l+=2),j.e.c=B.read_shift(2),j.e.r=B.read_shift(2),Q==12&&z.qpro&&(B.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function l(B){var Q=J(8);return Q.write_shift(2,B.s.c),Q.write_shift(2,B.s.r),Q.write_shift(2,B.e.c),Q.write_shift(2,B.e.r),Q}function u(B,Q,z){var j=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(j[0].c=B.read_shift(1),j[3]=B.read_shift(1),j[0].r=B.read_shift(2),B.l+=2):(j[2]=B.read_shift(1),j[0].c=B.read_shift(2),j[0].r=B.read_shift(2)),j}function f(B,Q,z){var j=B.l+Q,ee=u(B,Q,z);if(ee[1].t="s",z.vers==20768){B.l++;var ge=B.read_shift(1);return ee[1].v=B.read_shift(ge,"utf8"),ee}return z.qpro&&B.l++,ee[1].v=B.read_shift(j-B.l,"cstr"),ee}function h(B,Q,z){var j=J(7+z.length);j.write_shift(1,255),j.write_shift(2,Q),j.write_shift(2,B),j.write_shift(1,39);for(var ee=0;ee<j.length;++ee){var ge=z.charCodeAt(ee);j.write_shift(1,ge>=128?95:ge)}return j.write_shift(1,0),j}function d(B,Q,z){var j=u(B,Q,z);return j[1].v=B.read_shift(2,"i"),j}function g(B,Q,z){var j=J(7);return j.write_shift(1,255),j.write_shift(2,Q),j.write_shift(2,B),j.write_shift(2,z,"i"),j}function _(B,Q,z){var j=u(B,Q,z);return j[1].v=B.read_shift(8,"f"),j}function m(B,Q,z){var j=J(13);return j.write_shift(1,255),j.write_shift(2,Q),j.write_shift(2,B),j.write_shift(8,z,"f"),j}function y(B,Q,z){var j=B.l+Q,ee=u(B,Q,z);if(ee[1].v=B.read_shift(8,"f"),z.qpro)B.l=j;else{var ge=B.read_shift(2);O(B.slice(B.l,B.l+ge),ee),B.l+=ge}return ee}function w(B,Q,z){var j=Q&32768;return Q&=-32769,Q=(j?B:0)+(Q>=8192?Q-16384:Q),(j?"":"$")+(z?mr(Q):ir(Q))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(B,Q){Br(B,0);for(var z=[],j=0,ee="",ge="",Te="",Ee="";B.l<B.length;){var de=B[B.l++];switch(de){case 0:z.push(B.read_shift(8,"f"));break;case 1:ge=w(Q[0].c,B.read_shift(2),!0),ee=w(Q[0].r,B.read_shift(2),!1),z.push(ge+ee);break;case 2:{var Ge=w(Q[0].c,B.read_shift(2),!0),Me=w(Q[0].r,B.read_shift(2),!1);ge=w(Q[0].c,B.read_shift(2),!0),ee=w(Q[0].r,B.read_shift(2),!1),z.push(Ge+Me+":"+ge+ee)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(B.read_shift(2));break;case 6:{for(var Ft="";de=B[B.l++];)Ft+=String.fromCharCode(de);z.push('"'+Ft.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Ee=z.pop(),Te=z.pop(),z.push(["AND","OR"][de-20]+"("+Te+","+Ee+")");break;default:if(de<32&&T[de])Ee=z.pop(),Te=z.pop(),z.push(Te+T[de]+Ee);else if(x[de]){if(j=x[de][1],j==69&&(j=B[B.l++]),j>z.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+z.join("|")+"|");return}var je=z.slice(-j);z.length-=j,z.push(x[de][0]+"("+je.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}z.length==1?Q[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function U(B){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=B.read_shift(2),Q[3]=B[B.l++],Q[0].c=B[B.l++],Q}function W(B,Q){var z=U(B);return z[1].t="s",z[1].v=B.read_shift(Q-4,"cstr"),z}function E(B,Q,z,j){var ee=J(6+j.length);ee.write_shift(2,B),ee.write_shift(1,z),ee.write_shift(1,Q),ee.write_shift(1,39);for(var ge=0;ge<j.length;++ge){var Te=j.charCodeAt(ge);ee.write_shift(1,Te>=128?95:Te)}return ee.write_shift(1,0),ee}function S(B,Q){var z=U(B);z[1].v=B.read_shift(2);var j=z[1].v>>1;if(z[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return z[1].v=j,z}function A(B,Q){var z=U(B),j=B.read_shift(4),ee=B.read_shift(4),ge=B.read_shift(2);if(ge==65535)return j===0&&ee===3221225472?(z[1].t="e",z[1].v=15):j===0&&ee===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Te=ge&32768;return ge=(ge&32767)-16446,z[1].v=(1-Te*2)*(ee*Math.pow(2,ge+32)+j*Math.pow(2,ge)),z}function I(B,Q,z,j){var ee=J(14);if(ee.write_shift(2,B),ee.write_shift(1,z),ee.write_shift(1,Q),j==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var ge=0,Te=0,Ee=0,de=0;return j<0&&(ge=1,j=-j),Te=Math.log2(j)|0,j/=Math.pow(2,Te-31),de=j>>>0,de&2147483648||(j/=2,++Te,de=j>>>0),j-=de,de|=2147483648,de>>>=0,j*=Math.pow(2,32),Ee=j>>>0,ee.write_shift(4,Ee),ee.write_shift(4,de),Te+=16383+(ge?32768:0),ee.write_shift(2,Te),ee}function P(B,Q){var z=A(B);return B.l+=Q-14,z}function V(B,Q){var z=U(B),j=B.read_shift(4);return z[1].v=j>>6,z}function N(B,Q){var z=U(B),j=B.read_shift(8,"f");return z[1].v=j,z}function Ce(B,Q){var z=N(B);return B.l+=Q-10,z}function ke(B,Q){return B[B.l+Q-1]==0?B.read_shift(Q,"cstr"):""}function dt(B,Q){var z=B[B.l++];z>Q-1&&(z=Q-1);for(var j="";j.length<z;)j+=String.fromCharCode(B[B.l++]);return j}function Ze(B,Q,z){if(!(!z.qpro||Q<21)){var j=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ee=B.read_shift(Q-21,"cstr");return[j,ee]}}function fe(B,Q){for(var z={},j=B.l+Q;B.l<j;){var ee=B.read_shift(2);if(ee==14e3){for(z[ee]=[0,""],z[ee][0]=B.read_shift(2);B[B.l];)z[ee][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return z}function ye(B,Q){var z=J(5+B.length);z.write_shift(2,14e3),z.write_shift(2,Q);for(var j=0;j<B.length;++j){var ee=B.charCodeAt(j);z[z.l++]=ee>127?95:ee}return z[z.l++]=0,z}var Se={0:{n:"BOF",f:LT},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:_},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:dt},65535:{n:""}},Oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ze},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),$O=/^\s|\s$|[\t\n\r]/;function jT(t,e){if(!e.bookSST)return"";var r=[Nt];r[r.length]=le("sst",null,{xmlns:So[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match($O)&&(s+=' xml:space="preserve"'),s+=">"+Xe(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function HO(t){return[t.read_shift(4),t.read_shift(4)]}function WO(t,e){return e||(e=J(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var GO=MD;function KO(t){var e=Dr();re(e,159,WO(t));for(var r=0;r<t.length;++r)re(e,19,GO(t[r]));return re(e,160),e.end()}function qO(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function zT(t){var e=0,r,n=qO(t),i=n.length+1,s,a,o,l,u;for(r=qs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var XO=function(){function t(i,s){switch(s.type){case"base64":return e(hi(i),s);case"binary":return e(i,s);case"buffer":return e(He&&Buffer.isBuffer(i)?i.toString("binary"):Eu(i),s);case"array":return e(Th(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,g=0,_,m=-1;_=d.exec(f);){switch(_[0]){case"\\cell":var y=f.slice(g,d.lastIndex-_[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var w={v:y,t:"s"};Array.isArray(o)?o[h][m]=w:o[Ye({r:h,c:m})]=w}break}g=d.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=Pt(u),o}function r(i,s){return na(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ft(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Ye({r:u,c:f});o=l?(i[u]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(di(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function W_(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var QO=6,ni=QO;function Ff(t){return Math.floor((t+Math.round(128/ni)/256)*ni)}function Df(t){return Math.floor((t-5)/ni*100+.5)/100}function ep(t){return Math.round((t*ni+5)/ni*256)/256}function Ym(t){t.width?(t.wpx=Ff(t.width),t.wch=Df(t.wpx),t.MDW=ni):t.wpx?(t.wch=Df(t.wpx),t.width=ep(t.wch),t.MDW=ni):typeof t.wch=="number"&&(t.width=ep(t.wch),t.wpx=Ff(t.width),t.MDW=ni),t.customWidth&&delete t.customWidth}var YO=96,$T=YO;function Of(t){return t*96/$T}function HT(t){return t*$T/96}function JO(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=le("numFmt",null,{numFmtId:n,formatCode:Xe(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=le("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function ZO(t){var e=[];return e[e.length]=le("cellXfs",null),t.forEach(function(r){e[e.length]=le("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=le("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function WT(t,e){var r=[Nt,le("styleSheet",null,{xmlns:So[0],"xmlns:vt":Ht.vt})],n;return t.SSF&&(n=JO(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=ZO(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function e5(t,e){var r=t.read_shift(2),n=gr(t);return[r,n]}function t5(t,e,r){r||(r=J(6+4*e.length)),r.write_shift(2,t),Gt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function r5(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=$D(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=zD(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gr(t),n}function n5(t,e){e||(e=J(25+4*32)),e.write_shift(2,t.sz*20),HD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Pf(t.color,e);var n=0;return n=2,e.write_shift(1,n),Gt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var i5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],R0,s5=Hn;function G_(t,e){e||(e=J(4*3+8*7+16*1)),R0||(R0=Bm(i5));var r=R0[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Pf({auto:1},e),Pf({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function a5(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function GT(t,e,r){r||(r=J(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Qo(t,e){return e||(e=J(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var o5=Hn;function l5(t,e){return e||(e=J(51)),e.write_shift(1,0),Qo(null,e),Qo(null,e),Qo(null,e),Qo(null,e),Qo(null,e),e.length>e.l?e.slice(0,e.l):e}function u5(t,e){return e||(e=J(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Rf(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function c5(t,e,r){var n=J(2052);return n.write_shift(4,t),Rf(e,n),Rf(r,n),n.length>n.l?n.slice(0,n.l):n}function f5(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(re(t,615,Tn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&re(t,44,t5(i,e[i]))}),re(t,616))}}function h5(t){var e=1;re(t,611,Tn(e)),re(t,43,n5({sz:12,color:{theme:1},name:"Calibri",family:2})),re(t,612)}function d5(t){var e=2;re(t,603,Tn(e)),re(t,45,G_({patternType:"none"})),re(t,45,G_({patternType:"gray125"})),re(t,604)}function p5(t){var e=1;re(t,613,Tn(e)),re(t,46,l5()),re(t,614)}function m5(t){var e=1;re(t,626,Tn(e)),re(t,47,GT({numFmtId:0},65535)),re(t,627)}function g5(t,e){re(t,617,Tn(e.length)),e.forEach(function(r){re(t,47,GT(r,0))}),re(t,618)}function v5(t){var e=1;re(t,619,Tn(e)),re(t,48,u5({xfId:0,name:"Normal"})),re(t,620)}function _5(t){var e=0;re(t,505,Tn(e)),re(t,506)}function x5(t){var e=0;re(t,508,c5(e,"TableStyleMedium9","PivotStyleMedium4")),re(t,509)}function y5(t,e){var r=Dr();return re(r,278),f5(r,t.SSF),h5(r),d5(r),p5(r),m5(r),g5(r,e.cellXfs),v5(r),_5(r),x5(r),re(r,279),r.end()}function KT(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Nt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function E5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:gr(t)}}function w5(t){var e=J(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Gt(t.name,e),e.slice(0,e.l)}function T5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function S5(t){var e=J(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function A5(t,e){var r=J(8+2*e.length);return r.write_shift(4,t),Gt(e,r),r.slice(0,r.l)}function k5(t){return t.l+=4,t.read_shift(4)!=0}function I5(t,e){var r=J(8);return r.write_shift(4,t),r.write_shift(4,1),r}function C5(){var t=Dr();return re(t,332),re(t,334,Tn(1)),re(t,335,w5({name:"XLDAPR",version:12e4,flags:3496657072})),re(t,336),re(t,339,A5(1,"XLDAPR")),re(t,52),re(t,35,Tn(514)),re(t,4096,Tn(0)),re(t,4097,Yr(1)),re(t,36),re(t,53),re(t,340),re(t,337,I5(1)),re(t,51,S5([[1,0]])),re(t,338),re(t,333),t.end()}function qT(){var t=[Nt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function R5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ye(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var ja=1024;function XT(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[le("xml",null,{"xmlns:v":Ur.v,"xmlns:o":Ur.o,"xmlns:x":Ur.x,"xmlns:mv":Ur.mv}).replace(/\/>/,">"),le("o:shapelayout",le("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),le("v:shapetype",[le("v:stroke",null,{joinstyle:"miter"}),le("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ja<t*1e3;)ja+=1e3;return e.forEach(function(s){var a=Wt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?le("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=le("v:fill",l,o),f={on:"t",obscured:"t"};++ja,i=i.concat(["<v:shape"+su({id:"_x0000_s"+ja,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,le("v:shadow",null,f),le("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",rr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),rr("x:AutoFill","False"),rr("x:Row",String(a.r)),rr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function QT(t){var e=[Nt,le("comments",null,{xmlns:So[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Xe(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Xe(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(rr("t",Xe(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(rr("t",Xe(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function P5(t,e,r){var n=[Nt,le("ThreadedComments",null,{xmlns:Ht.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(le("threadedComment",rr("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function N5(t){var e=[Nt,le("personList",null,{xmlns:Ht.TCMNT,"xmlns:x":So[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(le("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function F5(t){var e={};e.iauthor=t.read_shift(4);var r=oa(t);return e.rfx=r.s,e.ref=Ye(r.s),t.l+=16,e}function D5(t,e){return e==null&&(e=J(36)),e.write_shift(4,t[1].iauthor),ko(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var O5=gr;function L5(t){return Gt(t.slice(0,54))}function M5(t){var e=Dr(),r=[];return re(e,628),re(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),re(e,632,L5(i.a)))})}),re(e,631),re(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Wt(n[0]),e:Wt(n[0])};re(e,635,D5([s,i])),i.t&&i.t.length>0&&re(e,637,VD(i)),re(e,636),delete i.iauthor})}),re(e,634),re(e,629),e.end()}function b5(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Je.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var YT=["xlsb","xlsm","xlam","biff8","xla"],V5=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?u+=e.r:--u,i+(o?"":"$")+mr(f)+(l?"":"$")+ir(u)}return function(i,s){return e=s,i.replace(t,r)}}(),Jm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Zm=function(){return function(e,r){return e.replace(Jm,function(n,i,s,a,o,l){var u=Gm(a)-(s?0:r.c),f=Wm(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+d})}}();function B5(t,e){return t.replace(Jm,function(r,n,i,s,a,o){return n+(i=="$"?i+s:mr(Gm(s)+e.c))+(a=="$"?a+o:ir(Wm(o)+e.r))})}function U5(t){return t.length!=1}function kt(t){t.l+=1}function os(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function JT(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ZT(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=os(t),o=os(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ZT(t){var e=os(t),r=os(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function j5(t,e,r){if(r.biff<8)return ZT(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=os(t),a=os(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function eS(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return z5(t);var n=t.read_shift(r&&r.biff==12?4:2),i=os(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function z5(t){var e=os(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function $5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function H5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return W5(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function W5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function G5(t,e,r){var n=(t[t.l++]&96)>>5,i=JT(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function K5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=JT(t,s,r);return[n,i,a]}function q5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function X5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function Q5(t,e,r){var n=(t[t.l++]&96)>>5,i=j5(t,e-1,r);return[n,i]}function Y5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function K_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function J5(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Z5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function e8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function t8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function r8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function tS(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function n8(t){return t.read_shift(2),tS(t)}function i8(t){return t.read_shift(2),tS(t)}function s8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=eS(t,0,r);return[n,i]}function a8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=H5(t,0,r);return[n,i]}function o8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=eS(t,0,r);return[n,i,s]}function l8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[lL[i],iS[i],n]}function u8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:c8(t);return[i,(s[0]===0?iS:oL)[s[1]]]}function c8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function f8(t,e,r){t.l+=r&&r.biff==2?3:4}function h8(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function d8(t){return t.l++,Su[t.read_shift(1)]}function p8(t){return t.l++,t.read_shift(2)}function m8(t){return t.l++,t.read_shift(1)!==0}function g8(t){return t.l++,Io(t)}function v8(t,e,r){return t.l++,bT(t,e-1,r)}function _8(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=oO(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Su[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Io(t);break;case 2:r[1]=fO(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function x8(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?oa:pO)(t));return i}function y8(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=_8(t,r.biff);return a}function E8(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function w8(t,e,r){if(r.biff==5)return T8(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function T8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function S8(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function A8(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function k8(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function I8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var C8=Hn,R8=Hn,P8=Hn;function Au(t,e,r){return t.l+=2,[$5(t)]}function eg(t){return t.l+=6,[]}var N8=Au,F8=eg,D8=eg,O8=Au;function rS(t){return t.l+=2,[LT(t),t.read_shift(2)&1]}var L8=Au,M8=rS,b8=eg,V8=Au,B8=Au,U8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function j8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=U8[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function z8(t){return t.l+=2,[t.read_shift(4)]}function $8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function H8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function W8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function G8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function K8(t){return t.l+=4,[0,0]}var q_={1:{n:"PtgExp",f:h8},2:{n:"PtgTbl",f:P8},3:{n:"PtgAdd",f:kt},4:{n:"PtgSub",f:kt},5:{n:"PtgMul",f:kt},6:{n:"PtgDiv",f:kt},7:{n:"PtgPower",f:kt},8:{n:"PtgConcat",f:kt},9:{n:"PtgLt",f:kt},10:{n:"PtgLe",f:kt},11:{n:"PtgEq",f:kt},12:{n:"PtgGe",f:kt},13:{n:"PtgGt",f:kt},14:{n:"PtgNe",f:kt},15:{n:"PtgIsect",f:kt},16:{n:"PtgUnion",f:kt},17:{n:"PtgRange",f:kt},18:{n:"PtgUplus",f:kt},19:{n:"PtgUminus",f:kt},20:{n:"PtgPercent",f:kt},21:{n:"PtgParen",f:kt},22:{n:"PtgMissArg",f:kt},23:{n:"PtgStr",f:v8},26:{n:"PtgSheet",f:$8},27:{n:"PtgEndSheet",f:H8},28:{n:"PtgErr",f:d8},29:{n:"PtgBool",f:m8},30:{n:"PtgInt",f:p8},31:{n:"PtgNum",f:g8},32:{n:"PtgArray",f:Y5},33:{n:"PtgFunc",f:l8},34:{n:"PtgFuncVar",f:u8},35:{n:"PtgName",f:E8},36:{n:"PtgRef",f:s8},37:{n:"PtgArea",f:G5},38:{n:"PtgMemArea",f:S8},39:{n:"PtgMemErr",f:C8},40:{n:"PtgMemNoMem",f:R8},41:{n:"PtgMemFunc",f:A8},42:{n:"PtgRefErr",f:k8},43:{n:"PtgAreaErr",f:q5},44:{n:"PtgRefN",f:a8},45:{n:"PtgAreaN",f:Q5},46:{n:"PtgMemAreaN",f:W8},47:{n:"PtgMemNoMemN",f:G8},57:{n:"PtgNameX",f:w8},58:{n:"PtgRef3d",f:o8},59:{n:"PtgArea3d",f:K5},60:{n:"PtgRefErr3d",f:I8},61:{n:"PtgAreaErr3d",f:X5},255:{}},q8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X8={1:{n:"PtgElfLel",f:rS},2:{n:"PtgElfRw",f:V8},3:{n:"PtgElfCol",f:N8},6:{n:"PtgElfRwV",f:B8},7:{n:"PtgElfColV",f:O8},10:{n:"PtgElfRadical",f:L8},11:{n:"PtgElfRadicalS",f:b8},13:{n:"PtgElfColS",f:F8},15:{n:"PtgElfColSV",f:D8},16:{n:"PtgElfRadicalLel",f:M8},25:{n:"PtgList",f:j8},29:{n:"PtgSxName",f:z8},255:{}},Q8={0:{n:"PtgAttrNoop",f:K8},1:{n:"PtgAttrSemi",f:r8},2:{n:"PtgAttrIf",f:e8},4:{n:"PtgAttrChoose",f:J5},8:{n:"PtgAttrGoto",f:Z5},16:{n:"PtgAttrSum",f:f8},32:{n:"PtgAttrBaxcel",f:K_},33:{n:"PtgAttrBaxcel",f:K_},64:{n:"PtgAttrSpace",f:n8},65:{n:"PtgAttrSpaceSemi",f:i8},128:{n:"PtgAttrIfError",f:t8},255:{}};function Y8(t,e,r,n){if(n.biff<8)return Hn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=y8(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=x8(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Hn(t,e)),s}function J8(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=q_[s]||q_[q8[s]],(s===24||s===25)&&(i=(s===24?X8:Q8)[t[t.l+1]]),!i||!i.f?Hn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function Z8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var eL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tL(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function nS(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function X_(t,e,r){var n=nS(t,e,r);return n=="#REF"?n:tL(n,r)}function po(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,f,h=0,d=0,g,_="";if(!t[0]||!t[0][0])return"";for(var m=-1,y="",w=0,x=t[0].length;w<x;++w){var T=t[0][w];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:y=Et(" ",t[0][m][1][1]);break;case 1:y=Et("\r",t[0][m][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}u=u+y,m=-1}o.push(u+eL[T[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Al(T[1][1],a,i),o.push(kl(f,s));break;case"PtgRefN":f=r?Al(T[1][1],r,i):T[1][1],o.push(kl(f,s));break;case"PtgRef3d":h=T[1][1],f=Al(T[1][2],a,i),_=X_(n,h,i),o.push(_+"!"+kl(f,s));break;case"PtgFunc":case"PtgFuncVar":var O=T[1][0],U=T[1][1];O||(O=0),O&=127;var W=O==0?[]:o.slice(-O);o.length-=O,U==="User"&&(U=W.shift()),o.push(U+"("+W.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":g=D_(T[1][1],r?{s:r}:a,i),o.push(I0(g,i));break;case"PtgArea":g=D_(T[1][1],a,i),o.push(I0(g,i));break;case"PtgArea3d":h=T[1][1],g=T[1][2],_=X_(n,h,i),o.push(_+"!"+I0(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=T[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],S=E?E.Name:"SH33TJSNAME"+String(d);S&&S.slice(0,6)=="_xlfn."&&!i.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var A=T[1][1];d=T[1][2];var I;if(i.biff<=5)A<0&&(A=-A),n[A]&&(I=n[A][d]);else{var P="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][d]&&n[A][d].itab>0&&(P=n.SheetNames[n[A][d].itab-1]+"!"):P=n.SheetNames[d-1]+"!"),n[A]&&n[A][d])P+=n[A][d].Name;else if(n[0]&&n[0][d])P+=n[0][d].Name;else{var V=(nS(n,A,i)||"").split(";;");V[d-1]?P=V[d-1]:P+="SH33TJSERRX"}o.push(P);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var N="(",Ce=")";if(m>=0){switch(y="",t[0][m][1][0]){case 2:N=Et(" ",t[0][m][1][1])+N;break;case 3:N=Et("\r",t[0][m][1][1])+N;break;case 4:Ce=Et(" ",t[0][m][1][1])+Ce;break;case 5:Ce=Et("\r",t[0][m][1][1])+Ce;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(N+o.pop()+Ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:T[1][1],r:T[1][0]};var ke={c:r.c,r:r.r};if(n.sharedf[Ye(f)]){var dt=n.sharedf[Ye(f)];o.push(po(dt,a,ke,n,i))}else{var Ze=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(po(u[1],a,ke,n,i)),Ze=!0;break}Ze||o.push(T[1])}break;case"PtgArray":o.push("{"+Z8(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&fe.indexOf(t[0][w][0])==-1){T=t[0][m];var ye=!0;switch(T[1][0]){case 4:ye=!1;case 0:y=Et(" ",T[1][1]);break;case 5:ye=!1;case 1:y=Et("\r",T[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((ye?y:"")+o.pop()+(ye?"":y)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function rL(t){if(t==null){var e=J(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Xs(t);return Xs(0)}function nL(t,e,r,n,i){var s=Qs(e,r,i),a=rL(t.v),o=J(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=J(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var h=tr([s,a,o,u]);return h}function Sh(t,e,r){var n=t.read_shift(4),i=J8(t,n,r),s=t.read_shift(4),a=s>0?Y8(t,s,i,r):null;return[i,a]}var iL=Sh,Ah=Sh,sL=Sh,aL=Sh,oL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uL(t){var e="of:="+t.replace(Jm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function cL(t){return t.replace(/\./,"!")}var Il=typeof Map<"u";function tg(t,e,r){var n=0,i=t.length;if(r){if(Il?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Il?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Il?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function kh(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(ni=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Df(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ep(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function sS(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ps(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){eT(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fL(t,e,r){if(t&&t["!ref"]){var n=ft(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function hL(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Pt(t[r])+'"/>';return e+"</mergeCells>"}function dL(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=iu(Xe(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+le("outlinePr",null,u)}!s&&!o||(i[i.length]=le("sheetPr",o,a))}var pL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],mL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gL(t){var e={sheet:1};return pL.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),mL.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=zT(t.password).toString(16).toUpperCase()),le("sheetProtection",null,e)}function vL(t){return sS(t),le("pageMargins",null,t)}function _L(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=le("col",null,kh(i,n)));return r[r.length]="</cols>",r.join("")}function xL(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Pt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Gr(i);a.s.r==a.e.r&&(a.e.r=Gr(e["!ref"]).e.r,i=Pt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),le("autoFilter",null,{ref:i})}function yL(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),le("sheetViews",le("sheetView",null,i),{})}function EL(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Su[t.v];break;case"d":n&&n.cellDates?i=Tr(t.v,-1).toISOString():(t=Lr(t),t.t="n",i=""+(t.v=Or(Tr(t.v)))),typeof t.z>"u"&&(t.z=wt[14]);break;default:i=t.v;break}var o=rr("v",Xe(i)),l={r:e},u=ps(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=rr("v",""+tg(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=le("f",Xe(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),le("c",o,l)}function wL(t,e,r,n){var i=[],s=[],a=ft(t["!ref"]),o="",l,u="",f=[],h=0,d=0,g=t["!rows"],_=Array.isArray(t),m={r:u},y,w=-1;for(d=a.s.c;d<=a.e.c;++d)f[d]=mr(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],u=ir(h),d=a.s.c;d<=a.e.c;++d){l=f[d]+u;var x=_?(t[h]||[])[d]:t[l];x!==void 0&&(o=EL(x,l,t,e))!=null&&s.push(o)}(s.length>0||g&&g[h])&&(m={r:u},g&&g[h]&&(y=g[h],y.hidden&&(m.hidden=1),w=-1,y.hpx?w=Of(y.hpx):y.hpt&&(w=y.hpt),w>-1&&(m.ht=w,m.customHeight=1),y.level&&(m.outlineLevel=y.level)),i[i.length]=le("row",s.join(""),m))}if(g)for(;h<g.length;++h)g&&g[h]&&(m={r:h+1},y=g[h],y.hidden&&(m.hidden=1),w=-1,y.hpx?w=Of(y.hpx):y.hpt&&(w=y.hpt),w>-1&&(m.ht=w,m.customHeight=1),y.level&&(m.outlineLevel=y.level),i[i.length]=le("row","",m));return i.join("")}function aS(t,e,r,n){var i=[Nt,le("worksheet",null,{xmlns:So[0],"xmlns:r":Ht.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=ft(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Pt(f)}n||(n={}),l["!comments"]=[];var h=[];dL(l,r,t,e,i),i[i.length]=le("dimension",null,{ref:u}),i[i.length]=yL(l,e,t,r),e.sheetFormat&&(i[i.length]=le("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=_L(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=wL(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=gL(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=xL(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=hL(l["!merges"]));var d=-1,g,_=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(g={ref:m[0]},m[1].Target.charAt(0)!="#"&&(_=qe(n,-1,Xe(m[1].Target).replace(/#.*$/,""),$e.HLINK),g["r:id"]="rId"+_),(d=m[1].Target.indexOf("#"))>-1&&(g.location=Xe(m[1].Target.slice(d+1))),m[1].Tooltip&&(g.tooltip=Xe(m[1].Tooltip)),i[i.length]=le("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=vL(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=rr("ignoredErrors",le("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(_=qe(n,-1,"../drawings/drawing"+(t+1)+".xml",$e.DRAW),i[i.length]=le("drawing",null,{"r:id":"rId"+_}),l["!drawing"]=h),l["!comments"].length>0&&(_=qe(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$e.VML),i[i.length]=le("legacyDrawing",null,{"r:id":"rId"+_}),l["!legacy"]=_),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function TL(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function SL(t,e,r){var n=J(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Of(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var h=-1,d=-1,g=f<<10;g<f+1<<10;++g){u.c=g;var _=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ye(u)];_&&(h<0&&(h=g),d=g)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function AL(t,e,r,n){var i=SL(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&re(t,0,i)}var kL=oa,IL=ko;function CL(){}function RL(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=BD(t),r}function PL(t,e,r){r==null&&(r=J(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Pf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ET(t,r),r.slice(0,r.l)}function NL(t){var e=on(t);return[e]}function FL(t,e,r){return r==null&&(r=J(8)),ia(e,r)}function DL(t){var e=sa(t);return[e]}function OL(t,e,r){return r==null&&(r=J(4)),aa(e,r)}function LL(t){var e=on(t),r=t.read_shift(1);return[e,r,"b"]}function ML(t,e,r){return r==null&&(r=J(9)),ia(e,r),r.write_shift(1,t.v?1:0),r}function bL(t){var e=sa(t),r=t.read_shift(1);return[e,r,"b"]}function VL(t,e,r){return r==null&&(r=J(5)),aa(e,r),r.write_shift(1,t.v?1:0),r}function BL(t){var e=on(t),r=t.read_shift(1);return[e,r,"e"]}function UL(t,e,r){return r==null&&(r=J(9)),ia(e,r),r.write_shift(1,t.v),r}function jL(t){var e=sa(t),r=t.read_shift(1);return[e,r,"e"]}function zL(t,e,r){return r==null&&(r=J(8)),aa(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function $L(t){var e=on(t),r=t.read_shift(4);return[e,r,"s"]}function HL(t,e,r){return r==null&&(r=J(12)),ia(e,r),r.write_shift(4,e.v),r}function WL(t){var e=sa(t),r=t.read_shift(4);return[e,r,"s"]}function GL(t,e,r){return r==null&&(r=J(8)),aa(e,r),r.write_shift(4,e.v),r}function KL(t){var e=on(t),r=Io(t);return[e,r,"n"]}function qL(t,e,r){return r==null&&(r=J(16)),ia(e,r),Xs(t.v,r),r}function XL(t){var e=sa(t),r=Io(t);return[e,r,"n"]}function QL(t,e,r){return r==null&&(r=J(12)),aa(e,r),Xs(t.v,r),r}function YL(t){var e=on(t),r=wT(t);return[e,r,"n"]}function JL(t,e,r){return r==null&&(r=J(12)),ia(e,r),TT(t.v,r),r}function ZL(t){var e=sa(t),r=wT(t);return[e,r,"n"]}function e9(t,e,r){return r==null&&(r=J(8)),aa(e,r),TT(t.v,r),r}function t9(t){var e=on(t),r=Km(t);return[e,r,"is"]}function r9(t){var e=on(t),r=gr(t);return[e,r,"str"]}function n9(t,e,r){return r==null&&(r=J(12+4*t.v.length)),ia(e,r),Gt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function i9(t){var e=sa(t),r=gr(t);return[e,r,"str"]}function s9(t,e,r){return r==null&&(r=J(8+4*t.v.length)),aa(e,r),Gt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function a9(t,e,r){var n=t.l+e,i=on(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Ah(t,n-t.l,r);a[3]=po(o,null,i,r.supbooks,r)}else t.l=n;return a}function o9(t,e,r){var n=t.l+e,i=on(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Ah(t,n-t.l,r);a[3]=po(o,null,i,r.supbooks,r)}else t.l=n;return a}function l9(t,e,r){var n=t.l+e,i=on(t);i.r=r["!row"];var s=Io(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Ah(t,n-t.l,r);a[3]=po(o,null,i,r.supbooks,r)}else t.l=n;return a}function u9(t,e,r){var n=t.l+e,i=on(t);i.r=r["!row"];var s=gr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Ah(t,n-t.l,r);a[3]=po(o,null,i,r.supbooks,r)}else t.l=n;return a}var c9=oa,f9=ko;function h9(t,e){return e==null&&(e=J(4)),e.write_shift(4,t),e}function d9(t,e){var r=t.l+e,n=oa(t),i=qm(t),s=gr(t),a=gr(t),o=gr(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function p9(t,e){var r=J(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ko({s:Wt(t[0]),e:Wt(t[0])},r),Xm("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Gt(i||"",r),Gt(t[1].Tooltip||"",r),Gt("",r),r.slice(0,r.l)}function m9(){}function g9(t,e,r){var n=t.l+e,i=ST(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=iL(t,n-t.l,r);a[1]=o}else t.l=n;return a}function v9(t,e,r){var n=t.l+e,i=oa(t),s=[i];if(r.cellFormula){var a=aL(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function _9(t,e,r){r==null&&(r=J(18));var n=kh(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var oS=["left","right","top","bottom","header","footer"];function x9(t){var e={};return oS.forEach(function(r){e[r]=Io(t)}),e}function y9(t,e){return e==null&&(e=J(6*8)),sS(t),oS.forEach(function(r){Xs(t[r],e)}),e}function E9(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function w9(t,e,r){r==null&&(r=J(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function T9(t){var e=J(24);return e.write_shift(4,4),e.write_shift(4,1),ko(t,e),e}function S9(t,e){return e==null&&(e=J(16*4+2)),e.write_shift(2,t.password?zT(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function A9(){}function k9(){}function I9(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Lr(e),e.z=e.z||wt[14],e.v=Or(Tr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=ps(i.cellXfs,e,i),e.l&&s["!links"].push([Ye(l),e.l]),e.c&&s["!comments"].push([Ye(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=tg(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?re(t,18,GL(e,l)):re(t,7,HL(e,l))):(l.t="str",a?re(t,17,s9(e,l)):re(t,6,n9(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?re(t,13,e9(e,l)):re(t,2,JL(e,l)):a?re(t,16,QL(e,l)):re(t,5,qL(e,l)),!0;case"b":return l.t="b",a?re(t,15,VL(e,l)):re(t,4,ML(e,l)),!0;case"e":return l.t="e",a?re(t,14,zL(e,l)):re(t,3,UL(e,l)),!0}return a?re(t,12,OL(e,l)):re(t,1,FL(e,l)),!0}function C9(t,e,r,n){var i=ft(e["!ref"]||"A1"),s,a="",o=[];re(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){a=ir(f),AL(t,e,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=mr(d)),s=o[d]+a;var g=l?(e[f]||[])[d]:e[s];if(!g){h=!1;continue}h=I9(t,g,f,d,n,e,h)}}re(t,146)}function R9(t,e){!e||!e["!merges"]||(re(t,177,h9(e["!merges"].length)),e["!merges"].forEach(function(r){re(t,176,f9(r))}),re(t,178))}function P9(t,e){!e||!e["!cols"]||(re(t,390),e["!cols"].forEach(function(r,n){r&&re(t,60,_9(n,r))}),re(t,391))}function N9(t,e){!e||!e["!ref"]||(re(t,648),re(t,649,T9(ft(e["!ref"]))),re(t,650))}function F9(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=qe(r,-1,n[1].Target.replace(/#.*$/,""),$e.HLINK);re(t,494,p9(n,i))}}),delete e["!links"]}function D9(t,e,r,n){if(e["!comments"].length>0){var i=qe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$e.VML);re(t,551,Xm("rId"+i)),e["!legacy"]=i}}function O9(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Pt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Gr(s);o.s.r==o.e.r&&(o.e.r=Gr(e["!ref"]).e.r,s=Pt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),re(t,161,ko(ft(s))),re(t,162)}}function L9(t,e,r){re(t,133),re(t,137,w9(e,r)),re(t,138),re(t,134)}function M9(t,e){e["!protect"]&&re(t,535,S9(e["!protect"]))}function b9(t,e,r,n){var i=Dr(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=ft(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],re(i,129),(r.vbaraw||a["!outline"])&&re(i,147,PL(o,a["!outline"])),re(i,148,IL(l)),L9(i,a,r.Workbook),P9(i,a),C9(i,a,t,e),M9(i,a),O9(i,a,r,t),R9(i,a),F9(i,a,n),a["!margins"]&&re(i,476,y9(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&N9(i,a),D9(i,a,t,n),re(i,130),i.end()}function V9(t,e){t.l+=10;var r=gr(t);return{name:r}}var B9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function U9(t){return!t.Workbook||!t.Workbook.WBProps?"false":vD(t.Workbook.WBProps.date1904)?"true":"false"}var j9="][*?/\\".split("");function lS(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return j9.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function z9(t,e,r){t.forEach(function(n,i){lS(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function $9(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];z9(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)fL(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function uS(t){var e=[Nt];e[e.length]=le("workbook",null,{xmlns:So[0],"xmlns:r":Ht.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(B9.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=le("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Xe(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=le("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=le("definedName",Xe(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function H9(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Zd(t),r.name=gr(t),r}function W9(t,e){return e||(e=J(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Xm(t.strRelID,e),Gt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function G9(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?gr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function K9(t,e){e||(e=J(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),ET(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function q9(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=UD(t),a=sL(t,0,r),o=qm(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function X9(t,e){re(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};re(t,156,W9(i))}re(t,144)}function Q9(t,e){e||(e=J(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Gt("SheetJS",e),Gt(wf.version,e),Gt(wf.version,e),Gt("7262",e),e.length>e.l?e.slice(0,e.l):e}function Y9(t,e){e||(e=J(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function J9(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(re(t,135),re(t,158,Y9(i)),re(t,136))}}function Z9(t,e){var r=Dr();return re(r,131),re(r,128,Q9()),re(r,153,K9(t.Workbook&&t.Workbook.WBProps||null)),J9(r,t),X9(r,t),re(r,132),r.end()}function eM(t,e,r){return(e.slice(-4)===".bin"?Z9:uS)(t)}function tM(t,e,r,n,i){return(e.slice(-4)===".bin"?b9:aS)(t,r,n,i)}function rM(t,e,r){return(e.slice(-4)===".bin"?y5:WT)(t,r)}function nM(t,e,r){return(e.slice(-4)===".bin"?KO:jT)(t,r)}function iM(t,e,r){return(e.slice(-4)===".bin"?M5:QT)(t)}function sM(t){return(t.slice(-4)===".bin"?C5:qT)()}function aM(t,e){var r=[];return t.Props&&r.push(rO(t.Props,e)),t.Custprops&&r.push(nO(t.Props,t.Custprops)),r.join("")}function oM(){return""}function lM(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(le("NumberFormat",null,{"ss:Format":Xe(wt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(le("Style",s.join(""),a))}),le("Styles",r.join(""))}function cS(t){return le("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Zm(t.Ref,{r:0,c:0})})}function uM(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(cS(i)))}return le("Names",r.join(""))}function cM(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(cS(o)))}return s.join("")}function fM(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(le("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(le("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(le("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(le("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(rr("ProtectContents","True")),t["!protect"].objects&&i.push(rr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(rr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(rr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(rr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":le("WorksheetOptions",i.join(""),{xmlns:Ur.x})}function hM(t){return t.map(function(e){var r=gD(e.t||""),n=le("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return le("Comment",n,{"ss:Author":e.a})}).join("")}function dM(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Xe(Zm(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Wt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Xe(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Xe(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=a.c||u[f].s.r!=a.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=Su[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||wt[14]);break;case"s":h="String",d=mD(t.v||"");break}var g=ps(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=a.c+1;var _=t.v!=null?d:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+_+"</Data>";return(t.c||[]).length>0&&(m+=hM(t.c)),le("Cell",m,o)}function pM(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=HT(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function mM(t,e,r,n){if(!t["!ref"])return"";var i=ft(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(y,w){Ym(y);var x=!!y.width,T=kh(w,y),O={"ss:Index":w+1};x&&(O["ss:Width"]=Ff(T.width)),y.hidden&&(O["ss:Hidden"]="1"),o.push(le("Column",null,O))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[pM(u,(t["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>u)&&!(s[a].e.c<h)&&!(s[a].e.r<u)){(s[a].s.c!=h||s[a].s.r!=u)&&(d=!0);break}if(!d){var g={r:u,c:h},_=Ye(g),m=l?(t[u]||[])[h]:t[_];f.push(dM(m,_,t,e,r,n,g))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function gM(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?cM(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?mM(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(fM(s,e,t,r)),n.join("")}function vM(t,e){e||(e={}),t.SSF||(t.SSF=Lr(wt)),t.SSF&&(Eh(),yh(t.SSF),e.revssf=wh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ps(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(aM(t,e)),r.push(oM()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(le("Worksheet",gM(n,e,t),{"ss:Name":Xe(t.SheetNames[n])}));return r[2]=lM(t,e),r[3]=uM(t),Nt+le("Workbook",r.join(""),{xmlns:Ur.ss,"xmlns:o":Ur.o,"xmlns:x":Ur.x,"xmlns:ss":Ur.ss,"xmlns:dt":Ur.dt,"xmlns:html":Ur.html})}var P0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _M(t,e){var r=[],n=[],i=[],s=0,a,o=w_(L_,"n"),l=w_(M_,"n");if(t.Props)for(a=or(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=or(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)OT.indexOf(i[s][0])>-1||NT.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Je.utils.cfb_add(e,"/SummaryInformation",j_(n,P0.SI,l,M_)),(r.length||u.length)&&Je.utils.cfb_add(e,"/DocumentSummaryInformation",j_(r,P0.DSI,o,L_,u.length?u:null,P0.UDI))}function xM(t,e){var r=e||{},n=Je.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Je.utils.cfb_add(n,i,fS(t,r)),r.biff==8&&(t.Props||t.Custprops)&&_M(t,n),r.biff==8&&t.vbaraw&&b5(n,Je.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var yM={0:{f:TL},1:{f:NL},2:{f:YL},3:{f:BL},4:{f:LL},5:{f:KL},6:{f:r9},7:{f:$L},8:{f:u9},9:{f:l9},10:{f:a9},11:{f:o9},12:{f:DL},13:{f:ZL},14:{f:jL},15:{f:bL},16:{f:XL},17:{f:i9},18:{f:WL},19:{f:Km},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:q9},40:{},42:{},43:{f:r5},44:{f:e5},45:{f:s5},46:{f:o5},47:{f:a5},48:{},49:{f:DD},50:{},51:{f:T5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OO},62:{f:t9},63:{f:R5},64:{f:A9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:E9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RL},148:{f:kL,p:16},151:{f:m9},152:{},153:{f:G9},154:{},155:{},156:{f:H9},157:{},158:{},159:{T:1,f:HO},160:{T:-1},161:{T:1,f:oa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:c9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:E5},336:{T:-1},337:{f:k5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:CO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:g9},427:{f:v9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:x9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:d9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:O5},633:{T:1},634:{T:-1},635:{T:1,f:F5},636:{T:-1},637:{f:bD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:k9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ue(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Hm(r)&&t.push(r)}}function EM(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return ue(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function ku(t,e,r){return t||(t=J(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function wM(t,e,r,n){var i=J(9);return ku(i,t,e),MT(r,n||"b",i),i}function TM(t,e,r){var n=J(8+2*r.length);return ku(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function SM(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Or(Tr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ue(t,2,VO(r,n,i)):ue(t,3,bO(r,n,i));return;case"b":case"e":ue(t,5,wM(r,n,e.v,e.t));return;case"s":case"str":ue(t,4,TM(r,n,(e.v||"").slice(0,255)));return}ue(t,1,ku(null,r,n))}function AM(t,e,r,n){var i=Array.isArray(e),s=ft(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Pt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=ir(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=mr(f)),a=l[f]+o;var h=i?(e[u]||[])[f]:e[a];h&&SM(t,h,u,f)}}}function kM(t,e){for(var r=e||{},n=Dr(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ue(n,r.biff==4?1033:r.biff==3?521:9,Qm(t,16,r)),AM(n,t.Sheets[t.SheetNames[i]],i,r),ue(n,10),n.end()}function IM(t,e,r){ue(t,49,yO({sz:12,name:"Arial"},r))}function CM(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ue(t,1054,TO(i,e[i],r))})}function RM(t,e){var r=J(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ue(t,2151,r),r=J(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),BT(ft(e["!ref"]||"A1"),r),r.write_shift(4,4),ue(t,2152,r)}function PM(t,e){for(var r=0;r<16;++r)ue(t,224,$_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ue(t,224,$_(n,0,e))})}function NM(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ue(t,440,NO(n)),n[1].Tooltip&&ue(t,2048,FO(n))}delete e["!links"]}function FM(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&ue(t,125,LO(kh(i,n),i))})}}function DM(t,e,r,n,i){var s=16+ps(i.cellXfs,e,i);if(e.v==null&&!e.bf){ue(t,513,Qs(r,n,s));return}if(e.bf)ue(t,6,nL(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Or(Tr(e.v)):e.v;ue(t,515,IO(r,n,a,s));break;case"b":case"e":ue(t,517,kO(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=tg(i.Strings,e.v,i.revStrings);ue(t,253,EO(r,n,o,s))}else ue(t,516,wO(r,n,(e.v||"").slice(0,255),s,i));break;default:ue(t,513,Qs(r,n,s))}}function OM(t,e,r){var n=Dr(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,h="",d=[],g=ft(s["!ref"]||"A1"),_=u?65536:16384;if(g.e.c>255||g.e.r>=_){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,_-1)}ue(n,2057,Qm(r,16,e)),ue(n,13,Yr(1)),ue(n,12,Yr(100)),ue(n,15,Er(!0)),ue(n,17,Er(!1)),ue(n,16,Xs(.001)),ue(n,95,Er(!0)),ue(n,42,Er(!1)),ue(n,43,Er(!1)),ue(n,130,Yr(1)),ue(n,128,AO()),ue(n,131,Er(!1)),ue(n,132,Er(!1)),u&&FM(n,s["!cols"]),ue(n,512,SO(g,e)),u&&(s["!links"]=[]);for(var m=g.s.r;m<=g.e.r;++m){h=ir(m);for(var y=g.s.c;y<=g.e.c;++y){m===g.s.r&&(d[y]=mr(y)),f=d[y]+h;var w=l?(s[m]||[])[y]:s[f];w&&(DM(n,w,m,y,e),u&&w.l&&s["!links"].push([f,w.l]))}}var x=o.CodeName||o.name||i;return u&&ue(n,574,xO((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&ue(n,229,PO(s["!merges"])),u&&NM(n,s),ue(n,442,VT(x)),u&&RM(n,s),ue(n,10),n.end()}function LM(t,e,r){var n=Dr(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ue(n,2057,Qm(t,5,r)),r.bookType=="xla"&&ue(n,135),ue(n,225,o?Yr(1200):null),ue(n,193,aO(2)),l&&ue(n,191),l&&ue(n,192),ue(n,226),ue(n,92,mO("SheetJS",r)),ue(n,66,Yr(o?1200:1252)),o&&ue(n,353,Yr(0)),o&&ue(n,448),ue(n,317,MO(t.SheetNames.length)),o&&t.vbaraw&&ue(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";ue(n,442,VT(u))}ue(n,156,Yr(17)),ue(n,25,Er(!1)),ue(n,18,Er(!1)),ue(n,19,Yr(0)),o&&ue(n,431,Er(!1)),o&&ue(n,444,Yr(0)),ue(n,61,_O()),ue(n,64,Er(!1)),ue(n,141,Yr(0)),ue(n,34,Er(U9(t)=="true")),ue(n,14,Er(!0)),o&&ue(n,439,Er(!1)),ue(n,218,Yr(0)),IM(n,t,r),CM(n,t.SSF,r),PM(n,r),o&&ue(n,352,Er(!1));var f=n.end(),h=Dr();o&&ue(h,140,DO()),o&&r.Strings&&EM(h,252,vO(r.Strings)),ue(h,10);var d=h.end(),g=Dr(),_=0,m=0;for(m=0;m<t.SheetNames.length;++m)_+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var y=f.length+_+d.length;for(m=0;m<t.SheetNames.length;++m){var w=s[m]||{};ue(g,133,gO({pos:y,hs:w.Hidden||0,dt:0,name:t.SheetNames[m]},r)),y+=e[m].length}var x=g.end();if(_!=x.length)throw new Error("BS8 "+_+" != "+x.length);var T=[];return f.length&&T.push(f),x.length&&T.push(x),d.length&&T.push(d),tr(T)}function MM(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Lr(wt)),t&&t.SSF&&(Eh(),yh(t.SSF),r.revssf=wh(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,rg(r),r.cellXfs=[],ps(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=OM(i,r,t);return n.unshift(LM(t,n,r)),tr(n)}function fS(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Gr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return MM(t,e);case 4:case 3:case 2:return kM(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function bM(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=Ye({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||pD(h.w||(di(h),h.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),g.id=(n.id||"sjs")+"-"+f,s.push(le("td",d,g))}}var _="<tr>";return _+s.join("")+"</tr>"}var VM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',BM="</body></html>";function UM(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function hS(t,e){var r=e||{},n=r.header!=null?r.header:VM,i=r.footer!=null?r.footer:BM,s=[n],a=Gr(t["!ref"]);r.dense=Array.isArray(t),s.push(UM(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(bM(t,a,o,r));return s.push("</table>"+i),s.join("")}function dS(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Wt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Gr(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var h=[],d=0,g=t["!rows"]||(t["!rows"]=[]),_=0,m=0,y=0,w=0,x=0,T=0;for(t["!cols"]||(t["!cols"]=[]);_<o.length&&m<l;++_){var O=o[_];if(Q_(O)){if(n.display)continue;g[m]={hidden:!0}}var U=O.children;for(y=w=0;y<U.length;++y){var W=U[y];if(!(n.display&&Q_(W))){var E=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):_D(W.innerHTML),S=W.getAttribute("data-z")||W.getAttribute("z");for(d=0;d<h.length;++d){var A=h[d];A.s.c==w+s&&A.s.r<m+i&&m+i<=A.e.r&&(w=A.e.c+1-s,d=-1)}T=+W.getAttribute("colspan")||1,((x=+W.getAttribute("rowspan")||1)>1||T>1)&&h.push({s:{r:m+i,c:w+s},e:{r:m+i+(x||1)-1,c:w+s+(T||1)-1}});var I={t:"s",v:E},P=W.getAttribute("data-t")||W.getAttribute("t")||"";E!=null&&(E.length==0?I.t=P||"z":n.raw||E.trim().length==0||P=="s"||(E==="TRUE"?I={t:"b",v:!0}:E==="FALSE"?I={t:"b",v:!1}:isNaN(ri(E))?isNaN(nu(E).getDate())||(I={t:"d",v:Tr(E)},n.cellDates||(I={t:"n",v:Or(I.v)}),I.z=n.dateNF||wt[14]):I={t:"n",v:ri(E)})),I.z===void 0&&S!=null&&(I.z=S);var V="",N=W.getElementsByTagName("A");if(N&&N.length)for(var Ce=0;Ce<N.length&&!(N[Ce].hasAttribute("href")&&(V=N[Ce].getAttribute("href"),V.charAt(0)!="#"));++Ce);V&&V.charAt(0)!="#"&&(I.l={Target:V}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][w+s]=I):t[Ye({c:w+s,r:m+i})]=I,u.e.c<w+s&&(u.e.c=w+s),w+=T}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,m-1+i),t["!ref"]=Pt(u),m>=l&&(t["!fullref"]=Pt((u.e.r=o.length-_+m-1+i,u))),t}function pS(t,e){var r=e||{},n=r.dense?[]:{};return dS(n,t,e)}function jM(t,e){return na(pS(t,e),e)}function Q_(t){var e="",r=zM(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function zM(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var $M=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Nt+e}}(),Y_=function(){var t=function(s){return Xe(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Xe(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,h=Gr(s["!ref"]||"A1"),d=s["!merges"]||[],g=0,_=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",y=s["!rows"]||[];for(u=0;u<h.s.r;++u)m=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=h.e.r;++u){for(m=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<h.s.c;++f)l.push(e);for(;f<=h.e.c;++f){var w=!1,x={},T="";for(g=0;g!=d.length;++g)if(!(d[g].s.c>f)&&!(d[g].s.r>u)&&!(d[g].e.c<f)&&!(d[g].e.r<u)){(d[g].s.c!=f||d[g].s.r!=u)&&(w=!0),x["table:number-columns-spanned"]=d[g].e.c-d[g].s.c+1,x["table:number-rows-spanned"]=d[g].e.r-d[g].s.r+1;break}if(w){l.push(r);continue}var O=Ye({r:u,c:f}),U=_?(s[u]||[])[f]:s[O];if(U&&U.f&&(x["table:formula"]=Xe(uL(U.f)),U.F&&U.F.slice(0,O.length)==O)){var W=Gr(U.F);x["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,x["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!U){l.push(e);continue}switch(U.t){case"b":T=U.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=U.v?"true":"false";break;case"n":T=U.w||String(U.v||0),x["office:value-type"]="float",x["office:value"]=U.v||0;break;case"s":case"str":T=U.v==null?"":U.v,x["office:value-type"]="string";break;case"d":T=U.w||Tr(U.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Tr(U.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(e);continue}var E=t(T);if(U.l&&U.l.Target){var S=U.l.Target;S=S.charAt(0)=="#"?"#"+cL(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),E=le("text:a",E,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+le("table:table-cell",le("text:p",E,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var h=u["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ym(h),h.ods=o;var d=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var h=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[Nt],u=su({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=su({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(RT().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function mS(t,e){if(e.bookType=="fods")return Y_(t,e);var r=Um(),n="",i=[],s=[];return n="mimetype",De(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",De(r,n,Y_(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",De(r,n,$M(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",De(r,n,Nt+RT()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",De(r,n,tO(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",De(r,n,ZD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Lf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function HM(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):_n(iu(t))}function WM(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function ls(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function GM(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function au(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Ke(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Za(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Lt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=au(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=au(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function Qt(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Ke(n*8+i.type)),i.type==2&&e.push(Ke(i.data.length)),e.push(i.data))})}),ls(e)}function dn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=au(t,n),s=Lt(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Za(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Lt(o.data),u=Za(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=Za(s[3][0].data)>>>0>0),r.push(a)}return r}function ya(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Ke(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ke(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ke(a.data.length)}],n[2].push({data:Qt(a.meta),type:2})});var s=Qt(n);e.push(Ke(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),ls(e)}function KM(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=au(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ls(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=ls(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function pn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(KM(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return ls(e)}function Ea(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ke(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return ls(e)}function N0(t,e){var r=new Uint8Array(32),n=Lf(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,GM(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function F0(t,e){var r=new Uint8Array(32),n=Lf(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Ii(t){var e=Lt(t);return au(e[1][0].data)}function qM(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Za(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Lf(t[7][0].data),f=0,h=[],d=Lf(t[4][0].data),g=0,_=[],m=0;m<e.length;++m){if(e[m]==null){u.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),d.setUint16(m*2,g,!0);var y,w;switch(typeof e[m]){case"string":y=N0({t:"s",v:e[m]},r),w=F0({t:"s",v:e[m]},r);break;case"number":y=N0({t:"n",v:e[m]},r),w=F0({t:"n",v:e[m]},r);break;case"boolean":y=N0({t:"b",v:e[m]},r),w=F0({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(y),f+=y.length,_.push(w),g+=w.length,++l}for(t[2][0].data=Ke(l);m<t[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return t[6][0].data=ls(h),t[3][0].data=ls(_),l}function XM(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Gr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Pt(n)));var s=Mf(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Q){return Q.forEach(function(z){typeof z=="string"&&a.push(z)})});var o={},l=[],u=Je.read(e.numbers,{type:"base64"});u.FileIndex.map(function(Q,z){return[Q,u.FullPaths[z]]}).forEach(function(Q){var z=Q[0],j=Q[1];if(z.type==2&&z.name.match(/\.iwa/)){var ee=z.content,ge=pn(ee),Te=dn(ge);Te.forEach(function(Ee){l.push(Ee.id),o[Ee.id]={deps:[],location:j,type:Za(Ee.messages[0].meta[1][0].data)}})}}),l.sort(function(Q,z){return Q-z});var f=l.filter(function(Q){return Q>1}).map(function(Q){return[Q,Ke(Q)]});u.FileIndex.map(function(Q,z){return[Q,u.FullPaths[z]]}).forEach(function(Q){var z=Q[0];if(Q[1],!!z.name.match(/\.iwa/)){var j=dn(pn(z.content));j.forEach(function(ee){ee.messages.forEach(function(ge){f.forEach(function(Te){ee.messages.some(function(Ee){return Za(Ee.meta[1][0].data)!=11006&&WM(Ee.data,Te[1])})&&o[Te[0]].deps.push(ee.id)})})})}});for(var h=Je.find(u,o[1].location),d=dn(pn(h.content)),g,_=0;_<d.length;++_){var m=d[_];m.id==1&&(g=m)}var y=Ii(Lt(g.messages[0].data)[1][0].data);for(h=Je.find(u,o[y].location),d=dn(pn(h.content)),_=0;_<d.length;++_)m=d[_],m.id==y&&(g=m);for(y=Ii(Lt(g.messages[0].data)[2][0].data),h=Je.find(u,o[y].location),d=dn(pn(h.content)),_=0;_<d.length;++_)m=d[_],m.id==y&&(g=m);for(y=Ii(Lt(g.messages[0].data)[2][0].data),h=Je.find(u,o[y].location),d=dn(pn(h.content)),_=0;_<d.length;++_)m=d[_],m.id==y&&(g=m);var w=Lt(g.messages[0].data);{w[6][0].data=Ke(n.e.r+1),w[7][0].data=Ke(n.e.c+1);var x=Ii(w[46][0].data),T=Je.find(u,o[x].location),O=dn(pn(T.content));{for(var U=0;U<O.length&&O[U].id!=x;++U);if(O[U].id!=x)throw"Bad ColumnRowUIDMapArchive";var W=Lt(O[U].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var E=0;E<=n.e.c;++E){var S=[];S[1]=S[2]=[{type:0,data:Ke(E+420690)}],W[1].push({type:2,data:Qt(S)}),W[2].push({type:0,data:Ke(E)}),W[3].push({type:0,data:Ke(E)})}W[4]=[],W[5]=[],W[6]=[];for(var A=0;A<=n.e.r;++A)S=[],S[1]=S[2]=[{type:0,data:Ke(A+726270)}],W[4].push({type:2,data:Qt(S)}),W[5].push({type:0,data:Ke(A)}),W[6].push({type:0,data:Ke(A)});O[U].messages[0].data=Qt(W)}T.content=Ea(ya(O)),T.size=T.content.length,delete w[46];var I=Lt(w[4][0].data);{I[7][0].data=Ke(n.e.r+1);var P=Lt(I[1][0].data),V=Ii(P[2][0].data);T=Je.find(u,o[V].location),O=dn(pn(T.content));{if(O[0].id!=V)throw"Bad HeaderStorageBucket";var N=Lt(O[0].messages[0].data);for(A=0;A<s.length;++A){var Ce=Lt(N[2][0].data);Ce[1][0].data=Ke(A),Ce[4][0].data=Ke(s[A].length),N[2][A]={type:N[2][0].type,data:Qt(Ce)}}O[0].messages[0].data=Qt(N)}T.content=Ea(ya(O)),T.size=T.content.length;var ke=Ii(I[2][0].data);T=Je.find(u,o[ke].location),O=dn(pn(T.content));{if(O[0].id!=ke)throw"Bad HeaderStorageBucket";for(N=Lt(O[0].messages[0].data),E=0;E<=n.e.c;++E)Ce=Lt(N[2][0].data),Ce[1][0].data=Ke(E),Ce[4][0].data=Ke(n.e.r+1),N[2][E]={type:N[2][0].type,data:Qt(Ce)};O[0].messages[0].data=Qt(N)}T.content=Ea(ya(O)),T.size=T.content.length;var dt=Ii(I[4][0].data);(function(){for(var Q=Je.find(u,o[dt].location),z=dn(pn(Q.content)),j,ee=0;ee<z.length;++ee){var ge=z[ee];ge.id==dt&&(j=ge)}var Te=Lt(j.messages[0].data);{Te[3]=[];var Ee=[];a.forEach(function(Me,Ft){Ee[1]=[{type:0,data:Ke(Ft)}],Ee[2]=[{type:0,data:Ke(1)}],Ee[3]=[{type:2,data:HM(Me)}],Te[3].push({type:2,data:Qt(Ee)})})}j.messages[0].data=Qt(Te);var de=ya(z),Ge=Ea(de);Q.content=Ge,Q.size=Q.content.length})();var Ze=Lt(I[3][0].data);{var fe=Ze[1][0];delete Ze[2];var ye=Lt(fe.data);{var Se=Ii(ye[2][0].data);(function(){for(var Q=Je.find(u,o[Se].location),z=dn(pn(Q.content)),j,ee=0;ee<z.length;++ee){var ge=z[ee];ge.id==Se&&(j=ge)}var Te=Lt(j.messages[0].data);{delete Te[6],delete Ze[7];var Ee=new Uint8Array(Te[5][0].data);Te[5]=[];for(var de=0,Ge=0;Ge<=n.e.r;++Ge){var Me=Lt(Ee);de+=qM(Me,s[Ge],a),Me[1][0].data=Ke(Ge),Te[5].push({data:Qt(Me),type:2})}Te[1]=[{type:0,data:Ke(n.e.c+1)}],Te[2]=[{type:0,data:Ke(n.e.r+1)}],Te[3]=[{type:0,data:Ke(de)}],Te[4]=[{type:0,data:Ke(n.e.r+1)}]}j.messages[0].data=Qt(Te);var Ft=ya(z),je=Ea(Ft);Q.content=je,Q.size=Q.content.length})()}fe.data=Qt(ye)}I[3][0].data=Qt(Ze)}w[4][0].data=Qt(I)}g.messages[0].data=Qt(w);var Oe=ya(d),B=Ea(Oe);return h.content=B,h.size=h.content.length,u}function QM(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function rg(t){QM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function YM(t,e){return e.bookType=="ods"?mS(t,e):e.bookType=="numbers"?XM(t,e):e.bookType=="xlsb"?JM(t,e):ZM(t,e)}function JM(t,e){ja=1024,t&&!t.SSF&&(t.SSF=Lr(wt)),t&&t.SSF&&(Eh(),yh(t.SSF),e.revssf=wh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Il?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=YT.indexOf(e.bookType)>-1,i=kT();rg(e=e||{});var s=Um(),a="",o=0;if(e.cellXfs=[],ps(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",De(s,a,PT(t.Props,e)),i.coreprops.push(a),qe(e.rels,2,a,$e.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,De(s,a,FT(t.Props)),i.extprops.push(a),qe(e.rels,3,a,$e.EXT_PROPS),t.Custprops!==t.Props&&or(t.Custprops||{}).length>0&&(a="docProps/custom.xml",De(s,a,DT(t.Custprops)),i.custprops.push(a),qe(e.rels,4,a,$e.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,De(s,a,tM(o-1,a,e,t,f)),i.sheets.push(a),qe(e.wbrels,-1,"worksheets/sheet"+o+"."+r,$e.WS[0])}if(h){var g=h["!comments"],_=!1,m="";g&&g.length>0&&(m="xl/comments"+o+"."+r,De(s,m,iM(g,m)),i.comments.push(m),qe(f,-1,"../comments"+o+"."+r,$e.CMNT),_=!0),h["!legacy"]&&_&&De(s,"xl/drawings/vmlDrawing"+o+".vml",XT(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&De(s,CT(a),Ya(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,De(s,a,nM(e.Strings,a,e)),i.strs.push(a),qe(e.wbrels,-1,"sharedStrings."+r,$e.SST)),a="xl/workbook."+r,De(s,a,eM(t,a)),i.workbooks.push(a),qe(e.rels,1,a,$e.WB),a="xl/theme/theme1.xml",De(s,a,KT(t.Themes,e)),i.themes.push(a),qe(e.wbrels,-1,"theme/theme1.xml",$e.THEME),a="xl/styles."+r,De(s,a,rM(t,a,e)),i.styles.push(a),qe(e.wbrels,-1,"styles."+r,$e.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",De(s,a,t.vbaraw),i.vba.push(a),qe(e.wbrels,-1,"vbaProject.bin",$e.VBA)),a="xl/metadata."+r,De(s,a,sM(a)),i.metadata.push(a),qe(e.wbrels,-1,"metadata."+r,$e.XLMETA),De(s,"[Content_Types].xml",IT(i,e)),De(s,"_rels/.rels",Ya(e.rels)),De(s,"xl/_rels/workbook."+r+".rels",Ya(e.wbrels)),delete e.revssf,delete e.ssf,s}function ZM(t,e){ja=1024,t&&!t.SSF&&(t.SSF=Lr(wt)),t&&t.SSF&&(Eh(),yh(t.SSF),e.revssf=wh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Il?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=YT.indexOf(e.bookType)>-1,i=kT();rg(e=e||{});var s=Um(),a="",o=0;if(e.cellXfs=[],ps(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",De(s,a,PT(t.Props,e)),i.coreprops.push(a),qe(e.rels,2,a,$e.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,De(s,a,FT(t.Props)),i.extprops.push(a),qe(e.rels,3,a,$e.EXT_PROPS),t.Custprops!==t.Props&&or(t.Custprops||{}).length>0&&(a="docProps/custom.xml",De(s,a,DT(t.Custprops)),i.custprops.push(a),qe(e.rels,4,a,$e.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],g=(d||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,De(s,a,aS(o-1,e,t,h)),i.sheets.push(a),qe(e.wbrels,-1,"worksheets/sheet"+o+"."+r,$e.WS[0])}if(d){var _=d["!comments"],m=!1,y="";if(_&&_.length>0){var w=!1;_.forEach(function(x){x[1].forEach(function(T){T.T==!0&&(w=!0)})}),w&&(y="xl/threadedComments/threadedComment"+o+"."+r,De(s,y,P5(_,f,e)),i.threadedcomments.push(y),qe(h,-1,"../threadedComments/threadedComment"+o+"."+r,$e.TCMNT)),y="xl/comments"+o+"."+r,De(s,y,QT(_)),i.comments.push(y),qe(h,-1,"../comments"+o+"."+r,$e.CMNT),m=!0}d["!legacy"]&&m&&De(s,"xl/drawings/vmlDrawing"+o+".vml",XT(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&De(s,CT(a),Ya(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,De(s,a,jT(e.Strings,e)),i.strs.push(a),qe(e.wbrels,-1,"sharedStrings."+r,$e.SST)),a="xl/workbook."+r,De(s,a,uS(t)),i.workbooks.push(a),qe(e.rels,1,a,$e.WB),a="xl/theme/theme1.xml",De(s,a,KT(t.Themes,e)),i.themes.push(a),qe(e.wbrels,-1,"theme/theme1.xml",$e.THEME),a="xl/styles."+r,De(s,a,WT(t,e)),i.styles.push(a),qe(e.wbrels,-1,"styles."+r,$e.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",De(s,a,t.vbaraw),i.vba.push(a),qe(e.wbrels,-1,"vbaProject.bin",$e.VBA)),a="xl/metadata."+r,De(s,a,qT()),i.metadata.push(a),qe(e.wbrels,-1,"metadata."+r,$e.XLMETA),f.length>1&&(a="xl/persons/person.xml",De(s,a,N5(f)),i.people.push(a),qe(e.wbrels,-1,"persons/person.xml",$e.PEOPLE)),De(s,"[Content_Types].xml",IT(i,e)),De(s,"_rels/.rels",Ya(e.rels)),De(s,"xl/_rels/workbook."+r+".rels",Ya(e.wbrels)),delete e.revssf,delete e.ssf,s}function eb(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=hi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gS(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return wu(e.file,Je.write(t,{type:He?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Je.write(t,e)}function tb(t,e){var r=Lr(e||{}),n=YM(t,r);return rb(n,r)}function rb(t,e){var r={},n=He?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Je.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(xh(i))}return e.password&&typeof encrypt_agile<"u"?gS(encrypt_agile(i,e.password),e):e.type==="file"?wu(e.file,i):e.type=="string"?Tl(i):i}function nb(t,e){var r=e||{},n=xM(t,r);return gS(n,r)}function Nn(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return ru(iu(n));case"binary":return iu(n);case"string":return t;case"file":return wu(e.file,n,"utf8");case"buffer":return He?gi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Nn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ib(t,e){switch(e.type){case"base64":return ru(t);case"binary":return t;case"string":return t;case"file":return wu(e.file,t,"binary");case"buffer":return He?gi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function mc(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?ru(r):e.type=="string"?Tl(r):r;case"file":return wu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function vS(t,e){FF(),$9(t);var r=Lr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=vS(t,r);return r.type="array",xh(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Nn(vM(t,r),r);case"slk":case"sylk":return Nn(UO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Nn(hS(t.Sheets[t.SheetNames[i]],r),r);case"txt":return ib(_S(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Nn(ng(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Nn(jO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return mc(BO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Nn(zO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Nn(XO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Nn(UT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Nn(mS(t,r),r);case"wk1":return mc(H_.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return mc(H_.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),mc(fS(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),nb(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return tb(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function sb(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function ab(t,e,r){var n={};return n.type="file",n.file=e,sb(n),vS(t,n)}function ob(t,e,r,n,i,s,a,o){var l=ir(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var _=a?t[r][g]:t[n[g]+l];if(_===void 0||_.t===void 0){if(u===void 0)continue;s[g]!=null&&(d[s[g]]=u);continue}var m=_.v;switch(_.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(s[g]!=null){if(m==null)if(_.t=="e"&&m===null)d[s[g]]=null;else if(u!==void 0)d[s[g]]=u;else if(f&&m===null)d[s[g]]=null;else continue;else d[s[g]]=f&&(_.t!=="n"||_.t==="n"&&o.rawNumbers!==!1)?m:di(_,m,o);m!=null&&(h=!1)}}return{row:d,isempty:h}}function Mf(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=ft(f);break;case"number":l=ft(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var h=ir(l.s.r),d=[],g=[],_=0,m=0,y=Array.isArray(t),w=l.s.r,x=0,T={};y&&!t[w]&&(t[w]=[]);var O=u.skipHidden&&t["!cols"]||[],U=u.skipHidden&&t["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(O[x]||{}).hidden)switch(d[x]=mr(x),r=y?t[w][x]:t[d[x]+h],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=d[x];break;case 3:s[x]=u.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=di(r,null,u),m=T[a]||0,!m)T[a]=1;else{do o=a+"_"+m++;while(T[o]);T[a]=m,T[o]=1}s[x]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(U[w]||{}).hidden){var W=ob(t,l,w,d,n,s,y,u);(W.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[_++]=W.row)}return g.length=_,g}var J_=/"/g;function lb(t,e,r,n,i,s,a,o){for(var l=!0,u=[],f="",h=ir(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var g=o.dense?(t[r]||[])[d]:t[n[d]+h];if(g==null)f="";else if(g.v!=null){l=!1,f=""+(o.rawNumbers&&g.t=="n"?g.v:di(g,null,o));for(var _=0,m=0;_!==f.length;++_)if((m=f.charCodeAt(_))===i||m===s||m===34||o.forceQuotes){f='"'+f.replace(J_,'""')+'"';break}f=="ID"&&(f='"ID"')}else g.f!=null&&!g.F?(l=!1,f="="+g.f,f.indexOf(",")>=0&&(f='"'+f.replace(J_,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(a)}function ng(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ft(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],_=i.s.c;_<=i.e.c;++_)(d[_]||{}).hidden||(h[_]=mr(_));for(var m=0,y=i.s.r;y<=i.e.r;++y)(g[y]||{}).hidden||(f=lb(t,i,y,h,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function _S(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=ng(t,e);return r}function ub(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ft(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=mr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=ir(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function xS(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Wt(n.origin):n.origin;a=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=ft(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],g=0;e.forEach(function(m,y){or(m).forEach(function(w){(g=d.indexOf(w))==-1&&(d[g=d.length]=w);var x=m[w],T="z",O="",U=Ye({c:o+g,r:a+y+i});u=ou(s,U),x&&typeof x=="object"&&!(x instanceof Date)?s[U]=x:(typeof x=="number"?T="n":typeof x=="boolean"?T="b":typeof x=="string"?T="s":x instanceof Date?(T="d",n.cellDates||(T="n",x=Or(x)),O=n.dateNF||wt[14]):x===null&&n.nullError&&(T="e",x=0),u?(u.t=T,u.v=x,delete u.w,delete u.R,O&&(u.z=O)):s[U]=u={t:T,v:x},O&&(u.z=O))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var _=ir(a);if(i)for(g=0;g<d.length;++g)s[mr(g+o)+_]={t:"s",v:d[g]};return s["!ref"]=Pt(f),s}function cb(t,e){return xS(null,t,e)}function ou(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Wt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?ou(t,Ye(e)):ou(t,Ye({r:e,c:r||0}))}function fb(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function hb(){return{SheetNames:[],Sheets:{}}}function db(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(lS(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function pb(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=fb(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function mb(t,e){return t.z=e,t}function yS(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function gb(t,e,r){return yS(t,"#"+e,r)}function vb(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function _b(t,e,r,n){for(var i=typeof e!="string"?e:ft(e),s=typeof e=="string"?e:Pt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=ou(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Yo={encode_col:mr,encode_row:ir,encode_cell:Ye,encode_range:Pt,decode_col:Gm,decode_row:Wm,split_cell:FD,decode_cell:Wt,decode_range:Gr,format_cell:di,sheet_add_aoa:yT,sheet_add_json:xS,sheet_add_dom:dS,aoa_to_sheet:Ao,json_to_sheet:cb,table_to_sheet:pS,table_to_book:jM,sheet_to_csv:ng,sheet_to_txt:_S,sheet_to_json:Mf,sheet_to_html:hS,sheet_to_formulae:ub,sheet_to_row_object_array:Mf,sheet_get_cell:ou,book_new:hb,book_append_sheet:db,book_set_sheet_visibility:pb,cell_set_number_format:mb,cell_set_hyperlink:yS,cell_set_internal_link:gb,cell_add_comment:vb,sheet_set_array_formula:_b,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const xb=()=>{const[t,e]=oe.useState([]),[r,n]=oe.useState(!0),[i,s]=oe.useState(!1),[a,o]=oe.useState(!1),{user:l,resetProgress:u}=_h(),f=pu();oe.useEffect(()=>{(async()=>{try{n(!0);const T=m6(Qd,"users"),O=await F6(T),U=[];O.forEach(W=>{const E=W.data();E.isRegistered&&U.push({name:E.name,className:E.className,totalScore:E.totalScore})}),U.sort((W,E)=>E.totalScore-W.totalScore),e(U)}catch(T){console.error("Error fetching leaderboard:",T)}finally{n(!1)}})()},[]);const h=()=>{const x=t.findIndex(T=>T.name===l.name&&T.className===l.className);return x>=0?x+1:"-"},d=()=>{u(),f("/register")},g=x=>{const T=new Date,O=T.toLocaleDateString("id-ID").replace(/\//g,"-"),U=T.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}).replace(":","");return`leaderboard-adiwiyata-${O}-${U}.${x}`},y=[{label:"Excel (.xlsx)",icon:oF,action:()=>{s(!0),o(!1);try{const x=[["Peringkat","Nama","Kelas","Skor Total"],...t.map((W,E)=>[E+1,W.name,W.className,W.totalScore])],T=Yo.book_new(),O=Yo.aoa_to_sheet(x);O["!cols"]=[{wch:10},{wch:25},{wch:15},{wch:12}];const U=Yo.decode_range(O["!ref"]||"A1");for(let W=U.s.c;W<=U.e.c;W++){const E=Yo.encode_cell({r:0,c:W});O[E]&&(O[E].s={font:{bold:!0},fill:{fgColor:{rgb:"E5F3E5"}}})}Yo.book_append_sheet(T,O,"Leaderboard Adiwiyata"),ab(T,g("xlsx"))}catch(x){console.error("Error exporting Excel:",x),alert("Terjadi kesalahan saat mengekspor Excel. Silakan coba lagi.")}finally{s(!1)}}},{label:"PDF Document",icon:uF,action:()=>{s(!0),o(!1);try{const x=window.open("","_blank");if(!x){alert("Popup diblokir. Silakan izinkan popup untuk mengekspor PDF."),s(!1);return}const T=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Leaderboard Adiwiyata</title>
          <style>
            body { 
              font-family: Arial, sans-serif; 
              margin: 20px; 
              color: #333;
            }
            .header { 
              text-align: center; 
              margin-bottom: 30px;
              border-bottom: 2px solid #16a34a;
              padding-bottom: 20px;
            }
            .header h1 { 
              color: #16a34a; 
              margin-bottom: 5px;
              font-size: 24px;
            }
            .header p { 
              color: #666; 
              margin-bottom: 10px;
            }
            .export-info {
              font-size: 12px;
              color: #888;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-top: 20px;
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 12px 8px; 
              text-align: left;
            }
            th { 
              background-color: #f8f9fa; 
              font-weight: bold;
              color: #16a34a;
            }
            .rank-medal { 
              font-size: 18px; 
              margin-right: 5px;
            }
            tr:nth-child(even) { 
              background-color: #f9f9f9; 
            }
            tr:hover { 
              background-color: #f5f5f5; 
            }
            .total-count {
              margin-top: 20px;
              text-align: center;
              font-size: 14px;
              color: #666;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1> Para Juara Adiwiyata</h1>
            <p>Leaderboard Program Adiwiyata</p>
            <div class="export-info">
              Diekspor pada: ${new Date().toLocaleDateString("id-ID")} ${new Date().toLocaleTimeString("id-ID")}
            </div>
          </div>
          <table>
            <thead>
              <tr>
                <th style="width: 15%">Peringkat</th>
                <th style="width: 35%">Nama</th>
                <th style="width: 25%">Kelas</th>
                <th style="width: 25%">Skor Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.map((O,U)=>`
                <tr>
                  <td>
                    ${U===0?'<span class="rank-medal"></span>':""}
                    ${U===1?'<span class="rank-medal"></span>':""}
                    ${U===2?'<span class="rank-medal"></span>':""}
                    ${U+1}
                  </td>
                  <td>${O.name}</td>
                  <td>${O.className}</td>
                  <td><strong>${O.totalScore}</strong></td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          <div class="total-count">
            Total Peserta: ${t.length}
          </div>
        </body>
        </html>
      `;x.document.write(T),x.document.close(),setTimeout(()=>{x.print(),x.close(),s(!1)},500)}catch(x){console.error("Error exporting PDF:",x),alert("Terjadi kesalahan saat mengekspor PDF. Silakan coba lagi."),s(!1)}}}],w=l.scores.filter(x=>x>0).length;return M.jsx("div",{className:"min-h-screen bg-green-50 py-8 px-4",children:M.jsxs("div",{className:"max-w-3xl mx-auto",children:[M.jsxs("div",{className:"flex justify-between items-center mb-6",children:[M.jsxs("button",{onClick:()=>{u(),f("/")},className:"flex items-center text-green-700 hover:text-green-900",children:[M.jsx(Uw,{className:"w-5 h-5 mr-1"}),M.jsx("span",{children:"Halaman Awal"})]}),M.jsx("div",{className:"text-sm text-green-700",children:l.isRegistered&&M.jsxs(M.Fragment,{children:[M.jsx("span",{className:"font-semibold",children:l.name})," | Kelas:"," ",l.className]})})]}),M.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[M.jsxs("div",{className:"bg-green-600 p-6 text-white text-center",children:[M.jsx("div",{className:"flex justify-center mb-4",children:M.jsx("div",{className:"bg-white rounded-full p-3",children:M.jsx(TF,{className:"w-8 h-8 text-yellow-500"})})}),M.jsx("h1",{className:"text-2xl font-bold",children:"Para Juara Adiwiyata"}),M.jsx("p",{className:"text-green-100",children:"Lihat peringkat para Juara Adiwiyata!"})]}),l.isRegistered&&M.jsx("div",{className:"bg-green-50 border-b border-green-100 p-4",children:M.jsxs("div",{className:"max-w-md mx-auto",children:[M.jsx("h2",{className:"text-lg font-semibold text-green-800 mb-2",children:"Hasilmu"}),M.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:M.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[M.jsxs("div",{children:[M.jsx("p",{className:"text-sm text-gray-500",children:"Skor Total"}),M.jsx("p",{className:"text-2xl font-bold text-green-700",children:l.totalScore})]}),M.jsxs("div",{children:[M.jsx("p",{className:"text-sm text-gray-500",children:"Peringkat"}),M.jsx("p",{className:"text-2xl font-bold text-green-700",children:h()})]}),M.jsxs("div",{children:[M.jsx("p",{className:"text-sm text-gray-500",children:"Stage Selesai"}),M.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[w,"/",l.scores.length]})]})]})})]})}),M.jsxs("div",{className:"p-4 md:p-6",children:[M.jsxs("div",{className:"flex justify-between items-center mb-4",children:[M.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Leaderboard"}),t.length>0&&M.jsxs("div",{className:"relative",children:[M.jsxs("button",{onClick:()=>o(!a),disabled:i,className:"flex items-center bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white text-sm font-medium py-2 px-4 rounded-lg transition-colors duration-300",children:[M.jsx(nF,{className:"w-4 h-4 mr-2"}),i?"Mengekspor...":"Ekspor",M.jsx(Y6,{className:"w-4 h-4 ml-1"})]}),a&&M.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border border-gray-200",children:M.jsx("div",{className:"py-1",children:y.map((x,T)=>M.jsxs("button",{onClick:x.action,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[M.jsx(x.icon,{className:"w-4 h-4 mr-3 text-gray-500"}),x.label]},T))})})]})]}),r?M.jsxs("div",{className:"text-center py-6 text-gray-500 flex items-center justify-center",children:[M.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[M.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),M.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Memuat..."]}):t.length>0?M.jsx("div",{className:"overflow-x-auto",children:M.jsxs("table",{className:"w-full",children:[M.jsx("thead",{children:M.jsxs("tr",{className:"bg-gray-50 text-left",children:[M.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-600",children:"Peringkat"}),M.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-600",children:"Nama"}),M.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-600",children:"Kelas"}),M.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-600",children:"Skor"})]})}),M.jsx("tbody",{children:t.map((x,T)=>{const O=l.isRegistered&&x.name===l.name&&x.className===l.className;return M.jsxs("tr",{className:`border-t border-gray-200 ${O?"bg-green-50":""}`,children:[M.jsxs("td",{className:"px-4 py-3",children:[T===0&&M.jsx("span",{className:"text-yellow-500 font-bold",children:""}),T===1&&M.jsx("span",{className:"text-gray-400 font-bold",children:""}),T===2&&M.jsx("span",{className:"text-amber-700 font-bold",children:""}),T>2&&M.jsx("span",{className:"font-medium",children:T+1})]}),M.jsxs("td",{className:`px-4 py-3 ${O?"font-semibold":""}`,children:[x.name,O&&M.jsx("span",{className:"ml-2 text-green-600 text-xs",children:"(Kamu)"})]}),M.jsx("td",{className:"px-4 py-3",children:x.className}),M.jsx("td",{className:"px-4 py-3 font-medium",children:x.totalScore})]},T)})})]})}):M.jsx("div",{className:"text-center py-6 text-gray-500",children:"Belum ada juara. Jadilah yang pertama menyelesaikan semua tahapan!"}),M.jsx("div",{className:"mt-8 flex justify-center",children:M.jsxs("button",{onClick:d,className:"flex items-center bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-300",children:[M.jsx(vF,{className:"w-4 h-4 mr-2"}),"Jelajahi Lagi"]})})]})]})]})})},yb=({children:t})=>{const{user:e}=_h();return e.isRegistered?M.jsx(M.Fragment,{children:t}):M.jsx(E2,{to:"/register",replace:!0})};function Eb(){return M.jsx(z6,{children:M.jsx(lI,{basename:"/adiwiyata-adventure",children:M.jsx("div",{className:"bg-top bg-gradient-to-b from-green-50 to-green-100 min-h-screen w-full",children:M.jsxs(tI,{children:[M.jsx(wa,{path:"/",element:M.jsx(SF,{})}),M.jsx(wa,{path:"/register",element:M.jsx(AF,{})}),M.jsx(wa,{path:"/stage/:stageId",element:M.jsx(yb,{children:M.jsx(RF,{})})}),M.jsx(wa,{path:"/leaderboard",element:M.jsx(xb,{})}),M.jsx(wa,{path:"*",element:M.jsx(E2,{to:"/",replace:!0})})]})})})})}uk.render(M.jsx(Eb,{}),document.getElementById("root"));
